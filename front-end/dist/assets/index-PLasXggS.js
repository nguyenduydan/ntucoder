const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Stats-BBObiJi9.js","assets/vendor-BGniOJC6.js","assets/charts-vendor-CYURHQdq.js","assets/lodash-vendor-CS6reBND.js","assets/vendor-C89sB56A.css","assets/Count-Cfm-1s7z.js","assets/axios-vendor-xsH4HHeE.js","assets/moment-vendor-CTDujYFw.js","assets/Course-0n4qKfvb.js","assets/Blogs-Fdk5o3RJ.js","assets/CodersRanking-Deh3EolD.js","assets/Problems-BrCtCrc0.js","assets/index-anuv8OI6.js","assets/CourseGrid-CHr_Ezaj.js","assets/InfoBlog-CsMpZi6p.js","assets/BlogTopViews-BDuwb0OA.js","assets/index-DcZm7eUU.css","assets/index-DvKFbiQm.js","assets/CourseDetail-CEYADAKp.js","assets/index-BxiIq11d.js","assets/index-B89RBN5M.js","assets/index-D_jns5O0.js","assets/ListBlogs-1aDKiTu4.js","assets/BlogDetail-BaOyJfr2.js","assets/index-PVDGRr9X.js","assets/NotFound-Ba0RH7_S.js","assets/UpdateInfo-DLNV6fHS.js","assets/UpdatePassword-CjUPV97N.js","assets/CourseLearning-DQnGqFC6.js","assets/BlogBox-BUF6VZiE.js","assets/ActionBox-zalO8Ji3.js","assets/HistorySubmission--q_FzdXx.js"])))=>i.map(i=>d[i]);
import{b as r,j as e,c as ts,u as G,d as ce,F as L,T as I,I as it,e as yn,f as $,S as Cn,g as oe,h as pt,B as E,i as gt,k as Te,l as vn,t as Sn,C as ns,H as ft,m as H,n as U,o as Ie,M as ss,p as rs,q as os,s as as,v as Be,D as ue,w as Le,x as is,y as ls,z as xt,A as wn,L as ht,E as Ct,G as cs,J as ds,N as Xe,K as hs,O as us,P as jt,Q as ps,R as gs,U as wt,V as Je,W as xs,X as ms,Y as bs,Z as js,_ as Q,$ as je,a0 as de,a1 as fe,a2 as ve,a3 as ye,a4 as he,a5 as xe,a6 as ne,a7 as M,a8 as B,a9 as q,aa as vt,ab as St,ac as De,ad as Ce,ae as ut,af as Xt,ag as Ut,ah as yt,ai as we,aj as ie,ak as fs,al as ys,am as Z,an as Ke,ao as We,ap as pe,aq as le,ar as kn,as as lt,at as mt,au as Cs,av as ee,aw as vs,ax as Ss,ay as Ae,az as ct,aA as ws,aB as In,aC as Ye,aD as Jt,aE as Ze,aF as ks,aG as Is,aH as Ts,aI as et,aJ as Ds,aK as Tn,aL as Mt,aM as Dn,aN as Es,aO as be,aP as Zt,aQ as Ls,aR as en,aS as zs,aT as Ns,aU as tn,aV as Fs,aW as nn,aX as Rs,aY as ot,aZ as _s,a_ as En,a$ as Bt,b0 as Ps,b1 as Ln,b2 as zn,b3 as Ft,b4 as Rt,b5 as As,b6 as _t,b7 as rt,b8 as Hs,b9 as Ms,ba as Bs,bb as kt,bc as It,bd as Ks,be as Kt,bf as Se,bg as Ws,bh as Wt,bi as Os,bj as Vs,bk as Gs,bl as $s,bm as qs,bn as sn,bo as Qs,bp as Ys,bq as Xs,br as Us,bs as Js,bt as Zs,bu as er,bv as tr,bw as nr,bx as rn,by as sr,bz as rr,bA as or,bB as Tt,bC as Dt,bD as ar,bE as ir,bF as lr,bG as cr,bH as dr,bI as hr,bJ as ur,bK as K,bL as pr,bM as gr,bN as xr,bO as mr,bP as br,bQ as jr,bR as fr,bS as yr}from"./vendor-BGniOJC6.js";import{a as Cr}from"./axios-vendor-xsH4HHeE.js";import"./moment-vendor-CTDujYFw.js";import"./charts-vendor-CYURHQdq.js";import"./lodash-vendor-CS6reBND.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const p of l.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function o(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(s){if(s.ep)return;s.ep=!0;const l=o(s);fetch(s.href,l)}})();const Nn=r.createContext(),vr=({children:t})=>{const[n,o]=r.useState("NTU-LMS");return r.useEffect(()=>{document.title=n},[n]),e.jsx(Nn.Provider,{value:{title:n,setTitle:o},children:t})},_e=t=>{const{setTitle:n}=r.useContext(Nn);r.useEffect(()=>{t&&n(`${t} | NTU-LMS`)},[t,n])},Sr="https://localhost:7015/api",J=Cr.create({baseURL:Sr,withCredentials:!0}),Fn=r.createContext(),wr=({children:t})=>{const[n,o]=r.useState(null),[a,s]=r.useState(!0),l=async()=>{var d;s(!0);try{const m=await J.get("/Auth/me");m.status===200&&o(m.data)}catch(m){((d=m.response)==null?void 0:d.status)===401&&(ts.remove("token"),o(null),window.location.pathname!=="/"&&(window.location.href="/"))}finally{s(!1)}};r.useEffect(()=>{l()},[]);const p=()=>{l()},i=async()=>{try{await J.post("/Auth/logout",{},{withCredentials:!0})}catch(d){console.log("Lỗi khi đăng xuất:",d)}finally{o(null),window.location.reload()}},g=!!n;return e.jsx(Fn.Provider,{value:{coder:n,setCoder:o,logout:i,isLoading:a,isAuthenticated:g,loginSuccessHandler:p},children:t})},tt=()=>r.useContext(Fn),kr="modulepreload",Ir=function(t){return"/"+t},on={},re=function(n,o,a){let s=Promise.resolve();if(o&&o.length>0){let p=function(d){return Promise.all(d.map(m=>Promise.resolve(m).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),g=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=p(o.map(d=>{if(d=Ir(d),d in on)return;on[d]=!0;const m=d.endsWith(".css"),h=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const f=document.createElement("link");if(f.rel=m?"stylesheet":kr,m||(f.as="script"),f.crossOrigin="",f.href=d,g&&f.setAttribute("nonce",g),document.head.appendChild(f),m)return new Promise((c,v)=>{f.addEventListener("load",c),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${d}`)))})}))}function l(p){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=p,window.dispatchEvent(i),!i.defaultPrevented)throw p}return s.then(p=>{for(const i of p||[])i.status==="rejected"&&l(i.reason);return n().catch(l)})};function Tr(){const t=G("gray.400","white"),{toggleColorMode:n}=ce();return e.jsxs(L,{zIndex:"3",flexDirection:{base:"column",xl:"row"},alignItems:{base:"center",xl:"start"},justifyContent:"space-between",px:{base:"30px",md:"50px"},pb:"10px",children:[e.jsxs(I,{color:t,textAlign:{base:"center",xl:"start"},mb:{base:"20px",xl:"0px"},children:[" ","© ",1900+new Date().getYear(),e.jsx(I,{as:"span",fontWeight:"500",ms:"4px",children:"Horizon UI. All Rights Reserved."})]}),e.jsx(I,{color:t,textAlign:{base:"center",xl:"start"},mb:{base:"20px",xl:"0px"},children:"Designed by FogVN"})]})}function Dr({onOpen:t,...n}){const o=G("gray.700","white"),a=G("secondaryGray.300","navy.900"),s=G("gray.700","gray.100");return e.jsxs(it,{w:{base:"100%",md:"200px"},...n,children:[e.jsx(yn,{children:e.jsx($,{bg:"inherit",borderRadius:"inherit",_hover:{background:"transparent"},_active:{bg:"inherit",transform:"none",borderColor:"transparent"},_focus:{boxShadow:"none"},icon:e.jsx(Cn,{color:o,w:"15px",h:"15px"}),onClick:t})}),e.jsx(oe,{variant:"search",fontSize:"sm",bg:a,color:s,fontWeight:"500",_placeholder:{color:"gray.400",fontSize:"14px"},borderRadius:"30px",placeholder:"Search pages...",onClick:t,readOnly:!0})]})}function me({children:t}){const n=pt();return r.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[n.pathname]),e.jsx(E,{children:t})}function Rn(t,n={}){const[o]=gt.useTypewriter({words:t,loop:!0,delaySpeed:1e3,...n});return o}Te.extend(vn);Te.extend(Sn);const Er=t=>t?Te(t).tz("Asia/Ho_Chi_Minh").format("DD/MM/YYYY HH:mm:ss"):"N/A",Lr=()=>{const[t,n]=r.useState(new Date),o=Rn(["Bạn nguyễn","bạn một ngày tốt lành","bạn học tốt","bạn vui vẻ","bạn thành công","bạn sức khỏe","bạn hạnh phúc"],5e3);return r.useEffect(()=>{const a=setInterval(()=>{n(new Date)},1e3);return()=>clearInterval(a)},[]),e.jsx(L,{justify:"space-between",align:"center",mb:8,display:{base:"none",md:"flex"},children:e.jsxs(I,{fontSize:"md",color:"gray.600",fontWeight:"bold",children:["Chào ",o,e.jsx(gt.Cursor,{cursorColor:"black"})," , hôm nay là ngày ",Er(t)]})})},zr=r.lazy(()=>re(()=>import("./Stats-BBObiJi9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Nr=r.lazy(()=>re(()=>import("./Course-0n4qKfvb.js"),__vite__mapDeps([8,1,2,3,4,6,7]))),Fr=r.lazy(()=>re(()=>import("./Blogs-Fdk5o3RJ.js"),__vite__mapDeps([9,1,2,3,4,6,7]))),Rr=r.lazy(()=>re(()=>import("./CodersRanking-Deh3EolD.js"),__vite__mapDeps([10,1,2,3,4,6,7]))),_r=r.lazy(()=>re(()=>import("./Problems-BrCtCrc0.js"),__vite__mapDeps([11,1,2,3,4,6,7]))),_n={stats:"blue",courses:"green",coders:"orange",problems:"red",blogs:"purple"},an=Object.keys(_n),Et={stats:"Tổng quan",courses:"Khóa học",blogs:"Bài viết",coders:"Xếp hạng",problems:"Bài tập"},Pr=()=>{const t=["stats","courses","coders"],[n,o]=r.useState(t),[a,s]=r.useState(!1),[l,p]=r.useState(Date.now()),i=()=>{s(!0),p(Date.now())},g=x=>{const y=x.target.value;y==="all"?o(an):y&&!n.includes(y)&&o([...n,y]),x.target.value=""},d=x=>{o(n.filter(y=>y!==x))},m=()=>{o([])},h=[{id:1,title:"React cơ bản",enrolls:1200},{id:2,title:"NodeJS nâng cao",enrolls:950},{id:3,title:"Chakra UI từ A-Z",enrolls:800}],f=[{id:1,title:"Tính tổng dãy số",difficulty:"Dễ"},{id:2,title:"Tìm chuỗi con dài nhất",difficulty:"Trung bình"},{id:3,title:"Thuật toán Dijkstra",difficulty:"Khó"}],c=({title:x,children:y})=>e.jsxs(E,{transition:"all 0.3s ease",mb:5,height:"100%",display:"flex",flexDirection:"column",children:[e.jsx(ft,{fontSize:"xl",color:"gray.700",mb:2,children:x}),e.jsx(ue,{mb:4,mt:2,w:"60px",h:"5px",borderRadius:"full",bg:"blue"}),e.jsx(E,{flex:"1",overflow:"auto",children:y})]}),v=x=>{switch(x){case"courses":return e.jsx(Nr,{courses:h,refreshKey:l,onFinishRefresh:()=>s(!1),height:"400px"});case"blogs":return e.jsx(Fr,{height:"400px",refreshKey:l,onFinishRefresh:()=>s(!1)});case"coders":return e.jsx(Rr,{refreshKey:l,onFinishRefresh:()=>s(!1),height:"400px"});case"problems":return e.jsx(_r,{problems:f,height:"400px"});default:return null}},b=n.filter(x=>x!=="stats");return e.jsx(me,{children:e.jsxs(ns,{maxW:"container.xl",mt:{base:40,md:20},pb:10,children:[e.jsx(Lr,{}),e.jsxs(E,{mb:10,p:5,shadow:"md",borderRadius:"lg",bgGradient:"linear(to-r, blue.200, purple.300)",children:[e.jsxs(L,{justify:"space-between",align:"center",direction:{base:"column",md:"row"},alignItems:"center",mb:4,children:[e.jsx(ft,{fontSize:"lg",mb:4,color:"black",children:"🎛️ Tùy chọn hiển thị"}),e.jsx(H,{size:"md",w:["100%","150px"],boxShadow:"md",colorScheme:"green",isLoading:a,borderRadius:"full",_hover:{transform:"scale(1.05)",boxShadow:"2px 5px 10px rgb(15, 245, 69)"},_active:{transform:"scale(0.95)"},onClick:i,children:"Refresh"})]}),e.jsxs(L,{direction:{base:"column",md:"row"},gap:4,align:"center",flexWrap:"wrap",children:[e.jsxs(U,{placeholder:"📂 Chọn hiển thị",onChange:g,maxW:"220px",bg:"white",borderColor:"gray.300",color:"black",sx:{option:{color:"black",bg:"white"}},children:[e.jsx("option",{value:"all",children:"🟢 Chọn tất cả"}),an.map(x=>e.jsxs("option",{value:x,children:["📌 ",Et[x]]},x))]}),n.length>0&&e.jsx(Ie,{label:"Xóa toàn bộ phần hiển thị",placement:"top",bg:" red.500",color:"white",hasArrow:!0,children:e.jsx($,{icon:e.jsx(ss,{}),onClick:m,variant:"ghost",colorScheme:"red",size:"sm",fontSize:20,"aria-label":"Clear"})}),e.jsx(L,{wrap:"wrap",gap:2,mt:{base:3,md:0},children:n.map(x=>e.jsxs(rs,{size:"md",borderRadius:"full",variant:"solid",colorScheme:_n[x]||"gray",children:[e.jsx(os,{color:"white",children:Et[x]}),e.jsx(as,{onClick:()=>d(x)})]},x))})]})]}),e.jsxs(r.Suspense,{fallback:e.jsx(L,{justify:"center",py:10,children:e.jsx(Be,{size:"xl"})}),children:[n.includes("stats")&&e.jsx(E,{height:"100%",mb:10,children:e.jsx(c,{title:"Thống kê tổng quan",children:e.jsx(zr,{refreshKey:l,onFinishRefresh:()=>s(!1),height:"100%"})})}),e.jsx(L,{wrap:"wrap",gap:6,mb:10,children:b.map((x,y,D)=>{const u=y===D.length-1,S=D.length%2!==0&&u?"100%":{base:"100%",md:"calc(50% - 12px)"};return e.jsx(E,{w:S,minH:"300px",children:e.jsx(c,{title:Et[x],children:v(x)})},x)})})]})]})})};function Oe({currentPage:t,totalPages:n,pageSize:o,totalRows:a,onPageChange:s,onPageSizeChange:l}){const{colorMode:p}=ce(),i=p==="light"?"black":"white",d=(()=>{const m=[];let f,c;n<=3?(f=1,c=n):t<=Math.ceil(3/2)?(f=1,c=3):t+Math.floor(3/2)>=n?(f=n-3+1,c=n):(f=t-Math.floor(3/2),c=t+Math.floor(3/2));for(let v=f;v<=c;v++)m.push(v);return m})();return e.jsxs(L,{direction:["column","row"],align:"center",justify:"center",mt:4,mr:4,wrap:"wrap",children:[e.jsxs(L,{mb:2,alignItems:"center",w:["100%","auto"],justify:"center",mr:["0","auto"],children:[e.jsx(I,{mr:2,children:"Số dòng hiển thị:"}),e.jsxs(U,{value:o,onChange:m=>l(parseInt(m.target.value,10)),width:["100%","auto"],ml:0,variant:"outline",colorScheme:"blue",sx:{option:{color:i,bg:p==="dark"?"gray.700":"white"}},children:[e.jsx("option",{value:5,children:"5 dòng"}),e.jsx("option",{value:10,children:"10 dòng"}),e.jsx("option",{value:20,children:"20 dòng"}),e.jsx("option",{value:50,children:"50 dòng"}),e.jsx("option",{value:100,children:"100 dòng"})]}),e.jsxs(I,{ml:5,children:["Tổng số dòng:",e.jsx(I,{as:"span",fontWeight:"bold",ml:"5px",children:a})]})]}),e.jsxs(L,{alignItems:"center",flexWrap:"wrap",justify:"center",w:"100%",children:[e.jsx(H,{onClick:()=>s(t-1),isDisabled:t===1,mr:2,colorScheme:"blue",variant:"outline",p:0,_hover:{bg:"blue.500",border:"blue.500",textColor:"white"},_active:{transform:"scale(0.90)"},size:["xs","sm"],borderRadius:"xl",children:e.jsx(Le,{as:is,w:5,h:5})}),d[0]>1&&e.jsxs(e.Fragment,{children:[e.jsx(H,{onClick:()=>s(1),colorScheme:"blue",_hover:{bg:"blue.100",border:"blue.100"},variant:"outline",size:["xs","sm"],borderRadius:"xl",children:"1"}),d[0]>2&&e.jsx(I,{mx:1,children:"..."})]}),d.map(m=>e.jsx(H,{onClick:()=>s(m),colorScheme:"blue",variant:m===t?"solid":"outline",mx:1,_hover:{bg:"blue.100",border:"blue.100"},size:["xs","sm"],borderRadius:"xl",children:m},m)),d[d.length-1]<n&&e.jsxs(e.Fragment,{children:[d[d.length-1]<n-1&&e.jsx(I,{mx:1,children:"..."}),e.jsx(H,{onClick:()=>s(n),colorScheme:"blue",variant:"outline",_hover:{bg:"blue.100",border:"blue.100"},size:["xs","sm"],borderRadius:"xl",children:n})]}),e.jsx(H,{onClick:()=>s(t+1),isDisabled:t===n,ml:2,colorScheme:"blue",variant:"outline",_hover:{bg:"blue.500",border:"blue.500",textColor:"white"},_active:{transform:"scale(0.90)"},p:0,size:["xs","sm"],borderRadius:"xl",children:e.jsx(Le,{as:ls,w:5,h:5})})]})]})}const Pt=({value:t,onChange:n=()=>{},onSearch:o,suggestions:a=[],...s})=>{const{colorMode:l}=ce(),p=l==="light"?"black":"whiteAlpha.700",i=r.useRef(),g=r.useMemo(()=>t?a.filter(f=>f.toLowerCase().includes(t.toLowerCase())):[],[t,a]),d=f=>{f.key==="Enter"&&o&&o(t)},m=()=>{n({target:{value:""}}),o&&o("")},h=f=>{n({target:{value:f}}),o&&o(f)};return r.useEffect(()=>{const f=c=>{var v;(c.metaKey||c.ctrlKey)&&c.key.toLowerCase()==="k"&&(c.preventDefault(),(v=i.current)==null||v.focus())};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[]),e.jsxs(E,{position:"relative",...s,children:[e.jsxs(it,{children:[e.jsx(yn,{pointerEvents:"none",children:e.jsx(Cn,{})}),e.jsx(oe,{ref:i,value:t,onChange:n,onKeyPress:d,width:"100%",...s}),t&&e.jsx(xt,{children:e.jsx($,{size:"sm","aria-label":"Clear input",icon:e.jsx(wn,{}),onClick:m,variant:"ghost",color:p,fontSize:10,fontWeight:600,transition:"all 0.1s ease-in-out",_hover:{bg:"transparent",color:"red",fontSize:"14px"}})})]}),g.length>0&&e.jsx(ht,{position:"absolute",bg:l==="light"?"gray.100":"black",mt:2,width:"100%",borderRadius:"md",boxShadow:"md",zIndex:1e3,maxHeight:"200px",overflowY:"auto",children:g.map((f,c)=>e.jsx(Ct,{padding:2,cursor:"pointer",_hover:{bg:"gray.200"},onClick:()=>h(f),children:f},c))})]})},Ve=({onSearch:t,onFilterChange:n,onAdd:o,valueSearch:a,title:s})=>{const{colorMode:l}=ce(),p=l==="light"?"black":"white",i=l==="light"?"white":"gray.600",[g,d]=r.useState([]),m=v=>{t&&t(v.target.value)},f=["Nhập từ khóa...","Phím tắt Ctrl + K",...(Array.isArray(s)?s.slice(1).map(v=>v==null?void 0:v.Header).filter(Boolean):[]).map(v=>`Tìm kiếm ${v}...`)],[c]=gt.useTypewriter({words:f,loop:!0,delaySpeed:1e3});return e.jsx(E,{w:"100%",children:e.jsx(L,{w:"100%",flexDirection:{base:"column",md:"row"},align:"center",alignItems:"center",justifyContent:"space-between",mb:"8px",px:{base:"15px",md:"25px"},gap:{base:4,md:0,lg:5},children:e.jsxs(E,{display:"flex",flexDirection:{base:"column",md:"row"},gap:5,w:"100%",justifyContent:"flex-end",alignItems:"center",children:[e.jsx(Pt,{type:"text",placeholder:c,color:p,value:a,onChange:m,bg:i,borderRadius:"full",boxShadow:"md",w:{base:"100%",md:"300px",lg:"400px"}}),e.jsxs(H,{variant:"solid",size:"lg",colorScheme:"blackAlpha",bgGradient:"linear(to-l, green.500, green.300)",borderRadius:"xl",boxShadow:"lg",transition:"all 0.3s ease-in-out",_hover:{bgGradient:"linear(to-r, green.500, green.300)",color:"white"},_active:{transform:"scale(0.90)"},onClick:o,children:["Thêm ",e.jsx(cs,{size:"25"})]})]})})})};function Ar(t){const{variant:n,children:o,...a}=t,s=ds("Card",{variant:n});return e.jsx(E,{__css:s,...a,children:o})}const Hr="/assets/nodata-BeiOp5YK.png";function Ge({columnsData:t,tableData:n=[],loading:o,onSort:a,sortField:s,ascending:l,fetchData:p}){const{colorMode:i}=ce(),g=i==="light"?"black":"white",d=i==="light"?"gray.200":"whiteAlpha.300",m=100,h=c=>s!==c?e.jsx(xs,{size:"20px"}):l?e.jsx(E,{as:"span",fontWeight:"bold",children:e.jsx(ms,{size:"20px"})}):e.jsx(E,{as:"span",fontWeight:"bold",children:e.jsx(bs,{size:"20px"})});r.useEffect(()=>(o?Xe.start():Xe.done(),()=>{Xe.done()}),[o]);const f=({column:c,row:v,index:b,fetchData:x})=>c.Cell?c.Cell({value:v[c.accessor],rowIndex:b,row:v,fetchData:x}):v[c.accessor]||"N/A";return e.jsx(Ar,{flexDirection:"column",w:"100%",px:"0px",boxShadow:"lg",overflowX:"hidden",overflowY:"hidden",position:"relative",children:e.jsxs(E,{maxH:"45vh",maxW:"100%",overflowY:"auto",borderColor:d,borderRadius:"md",mt:"10px",mx:"15px",position:"relative",children:[e.jsxs(hs,{variant:"simple",borderRadius:"full",color:"gray.500",colorScheme:"facebook",mb:"12px",mt:"5px",children:[e.jsx(us,{children:e.jsx(jt,{children:t.map(c=>e.jsx(ps,{position:"sticky",top:"0",borderColor:d,width:c.width||"fixed",bg:i==="dark"?"navy.800":"white",zIndex:1,children:e.jsxs(L,{children:[e.jsx(I,{fontSize:{sm:"10px",lg:"12px"},textAlign:"left",fontWeight:"bold",color:g,children:c.Header}),c.sortable&&a&&e.jsx(E,{onClick:()=>a(c.accessor),cursor:"pointer",children:h(c.accessor)})]})},c.Header))})}),e.jsx(gs,{children:n.length>0?n.map((c,v)=>e.jsx(jt,{_hover:{bg:i==="dark"?"gray.500":"gray.200"},children:t.map(b=>{const x=c[b.accessor]||"N/A",y=typeof x=="string"&&x.length>m?x.slice(0,m)+"...":x;return e.jsx(wt,{fontSize:"clamp(12px, 2vw, 16px)",width:b.width||"auto",borderColor:"transparent",padding:"12px 20px",children:b.Cell?e.jsx(f,{column:b,row:c,index:v,fetchData:p}):e.jsx(I,{color:g,maxW:"200px",children:y})},b.Header)})},c.id||v)):o?e.jsx(jt,{children:e.jsx(wt,{colSpan:t.length,children:e.jsx(L,{justify:"center",align:"center",height:"200px",children:e.jsx(Be,{size:"lg"})})})}):e.jsx(jt,{children:e.jsx(wt,{h:"40vh",colSpan:t.length,textAlign:"center",children:e.jsx(L,{justify:"center",align:"center",height:"100%",children:e.jsx(Je,{src:Hr,alt:"Không có dữ liệu",h:"50%",objectFit:"contain",backgroundColor:"transparent"})})})})})]}),o&&n.length>0&&e.jsx(E,{position:"absolute",top:"10px",right:"20px",zIndex:10})]})})}function te(t){const{id:n,label:o,extra:a,placeholder:s,type:l,mb:p,value:i,onChange:g,boxColor:d,textColor:m,...h}=t,f=G("secondaryGray.900","white");return e.jsxs(E,{position:"relative",w:"100%",role:"group",children:[e.jsx(oe,{...h,type:l,id:n,variant:"flushed",paddingLeft:2,placeholder:s,onChange:g,value:i,textColor:f,borderBottomWidth:2,borderColor:"gray.300",_focus:{borderColor:"transparent",boxShadow:"none"}}),e.jsx(E,{position:"absolute",bottom:0,left:"50%",height:"2px",width:"0",bg:"#3965FF",transition:"width 0.3s ease, left 0.3s ease",_groupFocusWithin:{width:"100%",left:0}})]})}const X=async({controller:t,page:n=1,pageSize:o=10,ascending:a=!0,params:s={}})=>{if(!t)throw new Error("Controller không được xác định.");try{const p=(await J.get(`/${t}`,{params:{Page:n,PageSize:o,ascending:a,...s}})).data;if(!p||p.error||p.success===!1)throw new Error(p.message||"Lỗi từ phía server");return{data:(p==null?void 0:p.data)||[],totalPages:(p==null?void 0:p.totalPages)||0,totalCount:(p==null?void 0:p.totalCount)||0}}catch(l){console.error("Lỗi Axios:",l);let p="Đã xảy ra lỗi.";throw l.response?p=`Lỗi API: ${l.response.status} - ${l.response.statusText}`:l.request?p="Không thể kết nối tới server.":l.message&&(p=l.message),new Error(p)}},Da=async({problemId:t,page:n=1,pageSize:o=10,ascending:a=!0,sortField:s="id"})=>await X({controller:"TestCase",page:n,pageSize:o,ascending:a,params:{ProblemID:t}}),nt=async({controller:t,id:n})=>{if(!n||!t)throw new Error("ID và controller là bắt buộc.");try{return(await J.get(`/${t}/${n}`)).data}catch(o){throw console.error("❌ Error fetching detail:",o),o}},st=async({controller:t,data:n})=>{try{return(await J.post(`/${t}`,n)).data}catch(o){throw console.error("❌ Error creating item:",o),o}},He=async({controller:t,id:n,data:o})=>{if(!n){console.error("LỖI: ID không hợp lệ!",n);return}try{return(await J.put(`/${t}/${n}`,o,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(a){throw console.error("❌ Error updating item:",a),a}},Ot=async({controller:t,id:n,newStatus:o})=>{if(!n){console.error("LỖI: ID không hợp lệ!",n);return}try{const l={...(await J.get(`/${t}/${n}`)).data,status:o};return(await J.put(`/${t}/${n}`,l,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(a){throw console.error("❌ Error updating status:",a),a}},$e=async({controller:t,id:n})=>{if(!n){console.error("LỖI: ID không hợp lệ!",n);return}try{return(await J.delete(`/${t}/${n}`)).data}catch(o){throw console.error("❌ Error deleting item:",o),o}},Ea=async({controller:t,problemid:n})=>{if(!n)throw new Error("ID và controller là bắt buộc.");try{return(await J.get(`/${t}`,{params:{problemID:n}})).data}catch(o){throw console.error("❌ Error fetching detail:",o),o}},Mr=async t=>{try{return await J.post("/Auth/login",t)}catch(n){throw n}},Br=async t=>{try{return await J.post("/Coder",{...t,role:2})}catch(n){throw n}};async function ge({controller:t,keyword:n="",page:o=1,pageSize:a=10}){if(!t)throw new Error("Controller và keyword là bắt buộc.");return(await J.get(`/${t}/search`,{params:{keyword:n,page:o,pageSize:a}})).data}Te.extend(js);Te.extend(vn);Te.extend(Sn);Te.locale("vi");const Pn=t=>t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-"),La=t=>{t=t.replace(/^#/,""),t.length===3&&(t=t.split("").map(s=>s+s).join(""));const n=parseInt(t.substring(0,2),16)/255,o=parseInt(t.substring(2,4),16)/255,a=parseInt(t.substring(4,6),16)/255;return .2126*n+.7152*o+.0722*a},Vt=t=>t?new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t):"0 VND",ze=t=>t?Te(t).tz("Asia/Ho_Chi_Minh").format("DD/MM/YYYY HH:mm:ss"):"N/A",Kr=t=>t?Te(t).tz("Asia/Ho_Chi_Minh").format("DD/MM/YYYY"):"N/A",za=t=>t?Te(t).fromNow():"N/A",Na=t=>new Intl.NumberFormat("vi-VN").format(t);function Wr(t,n){const o=t.slice(0,n);return t.length>n?o+" ...":t}function Or(t){return typeof t!="number"?t:t>=1e6?(t/1e6).toFixed(t>=1e7?0:1)+" M":t>=1e3?(t/1e3).toFixed(t>=1e4?0:1)+" K":t.toString()}function An(t){return t?t.length<6?"Mật khẩu phải có ít nhất 6 ký tự.":/[A-Z]/.test(t)?/[a-z]/.test(t)?/[0-9]/.test(t)?/[!@#$%^&*(),.?":{}|<>]/.test(t)?"":"Mật khẩu phải có ít nhất một ký tự đặc biệt.":"Mật khẩu phải có ít nhất một chữ số.":"Mật khẩu phải có ít nhất một chữ cái thường.":"Mật khẩu phải có ít nhất một chữ cái in hoa.":"Mật khẩu không thể bỏ trống."}const Vr=t=>{const n=[];if(t!=null&&t.errors)for(const o in t.errors)t.errors[o].forEach(a=>{n.push(`${o}: ${a}`)});return n},Hn=t=>{if(!t)return"";if(t.startsWith("data:"))return t;const n=t.includes("?")?"&":"?";return`${t}${n}v=${Date.now()}`},ln=t=>{if(!t)return"";const[n,o]=t.split("@");return!n||!o?t:n.length>3?`${n.slice(0,3)}***@${o}`:`***@${o}`},Mn=t=>{switch(t){case".cpp":return"cpp";case".python":case".py":return"python";case".java":return"java";case".js":case".javascript":return"javascript";case".csharp":case".cs":return"csharp";default:return"plaintext"}};function Bn({isOpen:t,onClose:n,fetchData:o}){const[a,s]=r.useState(!1),[l,p]=r.useState(!1),{colorMode:i}=ce(),g=i==="light"?"black":"white",d=i==="light"?"gray.100":"whiteAlpha.100",[m,h]=r.useState(""),[f,c]=r.useState(""),[v,b]=r.useState(""),[x,y]=r.useState(""),[D,u]=r.useState(""),[z,C]=r.useState(""),[S,j]=r.useState({}),F=Q();r.useEffect(()=>{t&&(b(""),c(""),u(""),y(""),h(""),j({}))},[t]);const R=()=>{p(!l)},_=async()=>{var k;j({});const A={userName:m,coderName:f,coderEmail:v,phoneNumber:x,password:D,role:Number(z)},V={};if(Object.keys(A).forEach(T=>{(typeof A[T]=="string"&&!A[T].trim()||A[T]===null||A[T]===void 0)&&(V[T]="Không được bỏ trống.")}),v&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v)&&(V.coderEmail="Email không hợp lệ."),f&&!/^[^\d]+$/.test(f)&&(V.coderName="Họ và tên không được chứa số."),x&&!/^\d{10}$/.test(x)&&(V.phoneNumber="Số điện thoại phải có đúng 10 chữ số."),D&&D.length<6&&(V.password="Mật khẩu phải có ít nhất 6 ký tự."),(!z||isNaN(z))&&(V.roleID="Vui lòng chọn vai trò."),Object.keys(V).length>0){j(V);return}try{await st({controller:"Coder",data:A}),s(!0),o&&await o(),j({}),n(),F({title:"Thêm mới thành công!",status:"success",duration:3e3,isClosable:!0,position:"top",variant:"top-accent"})}catch(T){console.error("Lỗi API:",T.response?T.response.data:T);const w=Vr(((k=T==null?void 0:T.response)==null?void 0:k.data)||{});w.length>0?w.forEach(O=>F({title:O,status:"error",duration:3e3,isClosable:!0,position:"top",variant:"left-accent"})):F({title:"Đã xảy ra lỗi không xác định.",status:"error",duration:3e3,isClosable:!0,position:"top",variant:"left-accent"}),s(!1)}};return e.jsxs(je,{size:"4xl",isOpen:t,onClose:n,children:[e.jsx(de,{}),e.jsxs(fe,{children:[e.jsx(ve,{fontSize:"25px",textAlign:"center",children:" Thêm mới người dùng "}),e.jsx(ye,{}),e.jsx(he,{children:e.jsxs(xe,{templateColumns:"repeat(2, 1fr)",gap:"6",children:[e.jsxs(ne,{children:[e.jsxs(M,{isInvalid:S.coderName,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Họ và tên",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{bg:d,placeholder:"Nhập họ và tên",value:f,onChange:A=>c(A.target.value),textColor:g}),e.jsx(q,{children:S.coderName})]}),e.jsxs(M,{isInvalid:S.userName,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Tên đăng nhập",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{bg:d,placeholder:"Nhập tên đăng nhập",value:m,onChange:A=>h(A.target.value),textColor:g}),e.jsx(q,{children:S.userName})]}),e.jsxs(M,{isInvalid:!!S.password,children:[e.jsxs(B,{fontWeight:"bold",children:["Mật khẩu",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsxs(it,{children:[e.jsx(te,{bg:d,type:l?"text":"password",placeholder:"Nhập mật khẩu",value:D,onChange:A=>u(A.target.value),textColor:g,w:"100%"}),e.jsx(xt,{children:e.jsx($,{variant:"link","aria-label":l?"Ẩn mật khẩu":"Hiển thị mật khẩu",icon:l?e.jsx(vt,{}):e.jsx(St,{}),onClick:R})})]}),e.jsx(q,{children:S.password})]})]}),e.jsxs(ne,{children:[e.jsxs(M,{isInvalid:S.coderEmail,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Email",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{bg:d,type:"email",placeholder:"Nhập email",value:v,onChange:A=>b(A.target.value),textColor:g}),e.jsx(q,{children:S.coderEmail})]}),e.jsxs(M,{isInvalid:S.phoneNumber,mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Số điện thoại"}),e.jsx(te,{bg:d,type:"tel",placeholder:"Nhập số điện thoại",value:x,onChange:A=>y(A.target.value),textColor:g}),e.jsx(q,{children:S.phoneNumber})]}),e.jsxs(M,{isInvalid:S.roleID,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Vai trò",e.jsxs(I,{as:"span",color:"red.500",children:[" ","*"]})]}),e.jsxs(U,{placeholder:"Chọn vai trò",value:z,onChange:A=>C(A.target.value),children:[e.jsx("option",{value:"1",children:"Admin"}),e.jsx("option",{value:"2",children:"User"}),e.jsx("option",{value:"3",children:"Manager"})]}),e.jsx(q,{children:S.roleID})]})]})]})}),e.jsxs(De,{children:[e.jsx(H,{colorScheme:"gray",mr:3,onClick:n,children:"Hủy"}),e.jsx(H,{colorScheme:"green",isLoading:a,loadingText:"Đang lưu...",onClick:_,justifyContent:"center",alignItems:"center",children:"Thêm"})]})]})]})}function Gr({isOpen:t,onClose:n,refetchData:o,testCaseID:a}){const s=Q(),[l,p]=r.useState(!1),[i,g]=r.useState(!0),[d,m]=r.useState({testCaseOrder:"",sampleTest:0,preTest:0,input:"",output:""}),h=r.useCallback(async()=>{try{g(!0);const x=await J.get(`/TestCase/${a}`);if(x.status===200)m(x.data);else throw new Error("Không thể tải dữ liệu TestCase.")}catch(x){s({title:"Lỗi",description:x.message||"Có lỗi khi tải dữ liệu.",status:"error",duration:5e3,isClosable:!0,position:"top-right"})}finally{g(!1)}},[a,s]);r.useEffect(()=>{t&&a&&h()},[t,a,h]);const f=x=>{m({...d,[x.target.name]:x.target.value})},c=x=>{m({...d,[x]:d[x]===1?0:1})},v=(x,y)=>{const D=x.target.files[0];if(D){const u=new FileReader;u.onload=z=>{m({...d,[y]:z.target.result})},u.readAsText(D)}},b=async()=>{if(!d.testCaseOrder||isNaN(d.testCaseOrder)||parseInt(d.testCaseOrder)<=0){s({title:"Lỗi",description:"TestCase Order phải là số nguyên lớn hơn 0.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"});return}if(!d.input||!d.output){s({title:"Lỗi",description:"Không được để trống Input hoặc Output.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"});return}try{if(p(!0),(await J.put(`/TestCase/${a}`,d)).status===200)s({title:"Cập nhật thành công!",description:"TestCase đã được cập nhật.",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),n(),o();else throw new Error("Có lỗi xảy ra khi cập nhật.")}catch(x){s({title:"Lỗi",description:x.message||"Có lỗi xảy ra khi cập nhật.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}finally{p(!1)}};return e.jsxs(je,{size:"2xl",isOpen:t,onClose:n,children:[e.jsx(de,{}),e.jsxs(fe,{children:[e.jsx(ve,{children:"Chỉnh sửa TestCase"}),e.jsx(ye,{}),e.jsx(he,{children:i?e.jsxs(xe,{templateColumns:"4fr 1fr",gap:4,children:[e.jsxs(ne,{children:[e.jsx(Ce,{height:"60px",mb:4}),e.jsx(Ce,{height:"100px",mb:4}),e.jsx(Ce,{height:"30px",width:"120px",mb:4}),e.jsx(Ce,{height:"100px",mb:4}),e.jsx(Ce,{height:"30px",width:"120px",mb:4})]}),e.jsxs(ne,{mt:5,children:[e.jsx(Ce,{height:"20px",mb:4}),e.jsx(Ce,{height:"20px"})]})]}):e.jsxs(xe,{templateColumns:"4fr 1fr",gap:4,children:[e.jsxs(ne,{children:[e.jsxs(M,{mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"TestCase Order"}),e.jsx(oe,{name:"testCaseOrder",placeholder:"Nhập thứ tự TestCase",value:d.testCaseOrder,onChange:f})]}),e.jsxs(M,{mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Input"}),e.jsx(ut,{name:"input",placeholder:"Nhập dữ liệu đầu vào",value:d.input,onChange:f,h:"50px"}),e.jsxs(H,{mt:2,bg:"gray.200",borderRadius:3,leftIcon:e.jsx(Ut,{}),as:"label",cursor:"pointer",children:["Import File",e.jsx(Xt,{type:"file",accept:".txt",onChange:x=>v(x,"input")})]})]}),e.jsxs(M,{mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Output"}),e.jsx(ut,{name:"output",placeholder:"Nhập dữ liệu đầu ra",value:d.output,onChange:f}),e.jsxs(H,{mt:2,bg:"gray.200",borderRadius:3,leftIcon:e.jsx(Ut,{}),as:"label",cursor:"pointer",children:["Import File",e.jsx(Xt,{type:"file",accept:".txt",onChange:x=>v(x,"output")})]})]})]}),e.jsx(ne,{mt:5,children:e.jsxs(M,{mb:4,children:[e.jsx(yt,{isChecked:d.sampleTest===1,onChange:()=>c("sampleTest"),children:"Sample Test"}),e.jsx(yt,{isChecked:d.preTest===1,onChange:()=>c("preTest"),children:"Pre Test"})]})})]})}),e.jsxs(De,{children:[e.jsx(H,{colorScheme:"gray",onClick:n,children:"Hủy"}),e.jsx(H,{colorScheme:"blue",isLoading:l,onClick:b,ml:3,children:"Cập nhật"})]})]})]})}const qe=({row:t,idData:n,controller:o,deleteFunction:a,deleteSuccessToast:s={},deleteErrorToast:l={},detailPath:p,isEdit:i,fetchData:g})=>{var j;const d=we(),m=Q(),{isOpen:h,onOpen:f,onClose:c}=ie(),{isOpen:v,onOpen:b,onClose:x}=ie(),[y,D]=r.useState(!1),u=((j=t==null?void 0:t.original)==null?void 0:j[n])||(t==null?void 0:t[n]),z=()=>{if(u){const R=`${p.startsWith("/admin")?p:`/admin/${p}`}/detail/${u}`;d(R)}else m({title:"Lỗi",description:"Không tìm thấy ID",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})},C=()=>{f()},S=async()=>{var F,R,_,A;D(!0);try{await a({controller:o,id:u}),m({title:"Xóa thành công!",description:"Người dùng đã bị xóa.",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent",...s}),x(),g&&await g()}catch(V){m({title:"Lỗi",description:((R=(F=V.response)==null?void 0:F.data)==null?void 0:R.error)||((A=(_=V.response)==null?void 0:_.data)==null?void 0:A.message)||V.message||"Có lỗi xảy ra khi thực hiện hành động.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent",...l})}finally{D(!1)}};return e.jsxs(L,{gap:4,justify:"left",align:"center",children:[p&&e.jsx(H,{variant:"solid",size:"xs",colorScheme:"blue",borderRadius:"md",minW:"auto",_active:{transform:"scale(0.90)"},onClick:z,children:e.jsx(fs,{size:"13"})}),e.jsx(H,{variant:"solid",size:"xs",colorScheme:"red",borderRadius:"md",minW:"auto",_active:{transform:"scale(0.90)"},onClick:b,children:e.jsx(ys,{size:"13"})}),i&&e.jsx(H,{variant:"solid",size:"xs",colorScheme:"yellow",borderRadius:"md",minW:"auto",_active:{transform:"scale(0.90)"},onClick:C,children:e.jsx(Z,{size:"13"})}),e.jsx(Gr,{isOpen:h,onClose:c,testCaseID:u,refetchData:g}),v&&e.jsxs(je,{isOpen:v,onClose:x,children:[e.jsx(de,{bg:"none",backdropFilter:"auto",backdropBlur:"4px"}),e.jsxs(fe,{children:[e.jsx(ve,{children:"Xác nhận xóa"}),e.jsx(ye,{}),e.jsx(he,{children:e.jsx(I,{children:"Bạn có chắc chắn muốn xóa hay không?"})}),e.jsxs(De,{children:[e.jsx(H,{colorScheme:"gray",mr:3,onClick:x,children:"Hủy"}),e.jsx(H,{colorScheme:"red",isLoading:y,loadingText:"Đang xóa...",onClick:S,children:"Xóa"})]})]})]})]})},cn=[{Header:"STT",accessor:"stt",Cell:({rowIndex:t})=>t+1},{Header:"Tài khoản",accessor:"userName",sortable:!0},{Header:"Tên người dùng",accessor:"coderName",sortable:!0},{Header:"Email",accessor:"coderEmail"},{Header:"SĐT",accessor:"phoneNumber"},{Header:"Quyền",accessor:"role",Cell:({row:t})=>{const n=t==null?void 0:t.role,a={1:{label:"Quản trị viên",color:"blue"},2:{label:"Người dùng",color:"red"},3:{label:"Giáo viên",color:"orange"}}[n]||{label:"Không xác định",color:"yellow"};return e.jsx(Ke,{colorScheme:a.color,boxShadow:"md",px:3,py:1,borderRadius:"md",children:a.label})}},{Header:"Hành động",accessor:"action",Cell:t=>e.jsx(qe,{...t,controller:"Coder",deleteFunction:$e,idData:"coderID",detailPath:"coder",deleteSuccessToast:{title:"Đã xóa!",description:"Người dùng đã được xóa thành công."},deleteErrorToast:{title:"Xóa thất bại!",description:"Vui lòng thử lại sau."},fetchData:t.fetchData})}];function Qe(t,n){const[o,a]=r.useState(t);return r.useEffect(()=>{const s=setTimeout(()=>{a(t)},n);return()=>{clearTimeout(s)}},[t,n]),o}function $r(){_e("Quản lý người dùng");const t=Q(),{isOpen:n,onOpen:o,onClose:a}=ie(),s=We(),[l,p]=r.useState("name"),[i,g]=r.useState(!0),[d,m]=r.useState(1),[h,f]=r.useState(10),[c,v]=r.useState(""),b=Qe(c,600),x=k=>typeof k=="string"&&k.trim()!=="",y=["coders",d,h,i,l],D=["codersSearch",b,d,h],{data:u,isLoading:z}=pe({queryKey:y,queryFn:()=>X({controller:"Coder",page:d,pageSize:h,ascending:i}),enabled:!x(b),keepPreviousData:!0,staleTime:6e4,retry:1,onError:()=>{t({title:"Lỗi khi tải dữ liệu",description:"Không thể tải dữ liệu. Vui lòng thử lại sau.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}}),{data:C,isLoading:S}=pe({queryKey:D,queryFn:()=>ge({controller:"Coder",keyword:b,page:d,pageSize:h}),enabled:x(b),keepPreviousData:!0,staleTime:6e4,retry:1,onError:k=>{t({title:"Lỗi khi tìm kiếm",description:k.message||"Không thể tìm kiếm. Vui lòng thử lại sau.",status:"error",duration:3e3,isClosable:!0,position:"top",variant:"left-accent"})}});r.useEffect(()=>{const k=x(b)?C:u;if(k!=null&&k.totalPages&&d<k.totalPages){const T=d+1;x(b)?s.prefetchQuery({queryKey:["codersSearch",b,T,h],queryFn:()=>ge({controller:"Coder",keyword:b,page:T,pageSize:h}),staleTime:6e4,retry:1}):s.prefetchQuery({queryKey:["coders",T,h,i,l],queryFn:()=>X({controller:"Coder",page:T,pageSize:h,ascending:i}),staleTime:6e4,retry:1})}},[b,C,u,d,h,i,l,s]);const j=k=>{l===k?g(!i):(p(k),g(!0)),m(1)},F=k=>{const T=x(b)?(C==null?void 0:C.totalPages)||0:(u==null?void 0:u.totalPages)||0;k>0&&k<=T&&m(k)},R=k=>{const T=parseInt(k,10);T!==h&&(f(T),m(1))},_=k=>{v(k),m(1)},A=()=>{s.invalidateQueries({queryKey:["coders"]}),s.invalidateQueries({queryKey:["codersSearch"]})},V=x(b)?C==null?void 0:C.data:u==null?void 0:u.data,W=x(b)?(C==null?void 0:C.totalPages)||0:(u==null?void 0:u.totalPages)||0,Y=x(b)?(C==null?void 0:C.totalCount)||0:(u==null?void 0:u.totalCount)||0,N=x(b)?S:z;return e.jsx(me,{children:e.jsxs(E,{pt:{base:"130px",md:"80px",xl:"80px"},children:[e.jsx(Ve,{onAdd:o,onSearch:_,valueSearch:c,title:cn}),e.jsx(Bn,{isOpen:n,onClose:a,fetchData:A}),e.jsx(Ge,{columnsData:cn,tableData:V||[],loading:N,onSort:j,sortField:l,ascending:i,fetchData:A}),e.jsx(Oe,{currentPage:d,totalPages:W,totalRows:Y,onPageChange:F,pageSize:h,onPageSizeChange:R})]})})}const bt=({progress:t})=>e.jsx(le,{children:e.jsx(E,{position:"fixed",top:0,left:0,width:"100%",zIndex:"9999",children:e.jsx(kn,{value:t,size:"sm",colorScheme:"blue",width:"100%",height:"4px"})})}),Kn=({children:t,offsetTop:n=64,...o})=>{const a=r.useRef(null),[s,l]=r.useState(!1),[p,i]=r.useState(0);return r.useEffect(()=>{const g=a.current;if(!g)return;const d=()=>i(g.offsetHeight);d();let m;typeof ResizeObserver<"u"&&(m=new ResizeObserver(()=>d()),m.observe(g));const h=g.getBoundingClientRect().top+window.scrollY,f=()=>{const c=window.scrollY;l(c+n>=h)};return window.addEventListener("scroll",f),()=>{m&&m.disconnect(),window.removeEventListener("scroll",f)}},[n]),e.jsxs(E,{w:"100%",children:[s&&e.jsx(E,{height:`${p}px`}),e.jsx(E,{ref:a,position:s?"fixed":"static",top:s?`${n}px`:"auto",left:0,right:0,zIndex:999,bg:s?"navy.800":"transparent",p:5,...o,children:e.jsx(L,{justifyContent:s?"center":"space-between",alignItems:"center",maxW:"1200px",mx:"auto",px:4,gap:10,children:t})})]})},qr={0:"Nam",1:"Nữ",2:"Khác"},Qr={1:"Người quản trị",2:"Người dùng",3:"Giáo viên"},Yr=()=>{const{id:t}=lt(),[n,o]=r.useState({}),[a,s]=r.useState(null),[l,p]=r.useState({}),[i,g]=r.useState(null),d=we(),m=Q(),[h,f]=r.useState(!1),[c,v]=r.useState(!1),{colorMode:b}=ce(),x=b==="light"?"black":"white",y=b==="light"?"white":"whiteAlpha.300",D=r.useCallback(async()=>{try{const j=await nt({controller:"Coder",id:t});o(j),p(j)}catch{m({title:"Đã xảy ra lỗi.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}},[t,m]);r.useEffect(()=>{t&&D()},[t,D]),r.useEffect(()=>{v(!1)},[l==null?void 0:l.avatar,n==null?void 0:n.avatar]);const u=j=>{s(j)},z=(j,F)=>{p(R=>{const _={...R,[j]:F};return o(A=>({...A,[j]:F})),_})},C=async j=>{const F=j.target.files[0];if(F){const R=new FileReader;R.onloadend=async()=>{p(A=>({...A,avatar:R.result}));const _=new FormData;_.append("CoderID",t),_.append("AvatarFile",F),l.role&&_.append("Role",l.role);try{await He({controller:"Coder",id:t,data:_}),m({title:"Cập nhật avatar thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),await D()}catch(A){console.error("Đã xảy ra lỗi khi cập nhật avatar",A),m({title:"Đã xảy ra lỗi khi cập nhật avatar.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}},R.readAsDataURL(F),g(F)}},S=async()=>{f(!0);try{const j=new FormData;Object.keys(l).forEach(F=>{if(F!=="CoderID"){const R=l[F];F==="birthDay"&&R==null?j.append("BirthDay",""):j.append(F,R)}}),i&&j.append("AvatarFile",i),o(F=>({...F,...l})),await He({controller:"Coder",id:t,data:j}),await D(),s(null),m({title:"Cập nhật thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),f(!1)}catch(j){console.error("Đã xảy ra lỗi khi cập nhật",j),m({title:"Đã xảy ra lỗi khi cập nhật.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),f(!1)}};return n?e.jsx(me,{children:e.jsx(E,{pt:{base:"130px",md:"80px",xl:"80px"},px:"25px",children:e.jsxs(E,{bg:y,p:{base:"4",md:"6"},borderRadius:"lg",boxShadow:"lg",maxW:"1000px",w:"100%",mx:"auto",children:[e.jsx(L,{justifyContent:"end",align:"end",px:{base:"10px",md:"25px"},children:e.jsxs(Kn,{offsetTop:"15",children:[e.jsxs(H,{onClick:()=>d("/admin/coder"),variant:"solid",size:"lg",colorScheme:"teal",borderRadius:"xl",px:5,boxShadow:"lg",bgGradient:"linear(to-l, messenger.500, navy.300)",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},children:[e.jsx(mt,{})," Quay lại"]}),e.jsx(H,{variant:"solid",size:"lg",colorScheme:"teal",borderRadius:"xl",px:10,boxShadow:"lg",bgGradient:"linear(to-l, green.500, green.300)",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},onClick:S,isLoading:h,loadingText:"Đang lưu...",children:"Lưu"})]})}),e.jsxs(le,{spacing:6,align:"stretch",mt:4,children:[e.jsxs(L,{direction:"column",align:"center",children:[e.jsx(Ce,{isLoaded:c,borderRadius:"full",boxSize:"200px",mb:4,children:e.jsx(Je,{src:Hn(l.avatar||n.avatar||"/avatarSimmmple.png"),alt:"Coder Avatar",borderRadius:"full",boxSize:"200px",objectFit:"cover",transition:"all 0.2s ease-in-out",_hover:{transform:"scale(1.05)"},onClick:()=>document.getElementById("avatarInput").click(),onLoad:()=>v(!0),onError:()=>{v(!0)},cursor:"pointer"})}),e.jsx(oe,{id:"avatarInput",type:"file",onChange:C,display:"none"})]}),e.jsx(ue,{}),e.jsxs(xe,{templateColumns:{base:"1fr",md:"repeat(2, 1fr)"},gap:6,children:[e.jsx(ne,{children:e.jsxs(le,{align:"stretch",ps:{base:"0",md:"20px"},spacing:4,children:[e.jsx(L,{align:"center",children:e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Tên đăng nhập:"})," ",n.userName||"Chưa có thông tin"]})}),["coderName","coderEmail","phoneNumber"].map(j=>e.jsxs(L,{align:"center",children:[a===j?e.jsx(oe,{textColor:x,value:l[j]||"",onChange:F=>z(j,F.target.value),placeholder:`Chỉnh sửa ${j}`,onBlur:()=>s(null),autoFocus:!0}):e.jsxs(I,{fontSize:"lg",textColor:x,children:[e.jsxs("strong",{children:[j==="coderName"?"Họ và tên":j==="coderEmail"?"Email":"Số điện thoại",":"]})," ",n[j]||"Chưa có thông tin"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>u(j),cursor:"pointer"})]},j)),e.jsxs(L,{align:"center",children:[a==="gender"?e.jsxs(U,{value:l.gender||"",onBlur:()=>s(null),autoFocus:!0,onChange:j=>z("gender",j.target.value),placeholder:"Chọn giới tính",width:{base:"100%",md:"50%"},children:[e.jsx("option",{value:"0",children:"Nam"}),e.jsx("option",{value:"1",children:"Nữ"}),e.jsx("option",{value:"2",children:"Khác"})]}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Giới tính:"})," ",qr[n.gender]||"Khác"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>u("gender"),cursor:"pointer"})]}),e.jsxs(L,{align:"center",children:[a==="birthDay"?e.jsx(Cs,{selected:l.birthDay?new Date(l.birthDay):null,onChange:j=>z("birthDay",j?j.toISOString():""),dateFormat:"dd/MM/yyyy",showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",placeholderText:"ngày/tháng/năm",className:"custom-datepicker",onBlur:()=>s(null),autoFocus:!0}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Ngày sinh:"})," ",l.birthDay?new Date(l.birthDay).toLocaleDateString("vi-VN"):"Chưa có"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>u("birthDay"),cursor:"pointer"})]}),e.jsxs(L,{align:"center",children:[a==="description"?e.jsx(oe,{value:l.description||"",onChange:j=>z("description",j.target.value),placeholder:"Chỉnh sửa mô tả",onBlur:()=>s(null),autoFocus:!0,textColor:x}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Mô tả:"})," ",n.description||"Chưa có thông tin"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>u("description"),cursor:"pointer"})]})]})}),e.jsx(ne,{children:e.jsxs(le,{align:"stretch",ps:{base:"0",md:"20px"},spacing:4,children:[e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Ngày tạo: "}),ze(n.createdAt)]}),e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Người tạo: "})," ",n.createdBy]}),n.updatedAt&&e.jsxs(e.Fragment,{children:[e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Ngày cập nhật: "}),ze(n.updatedAt)]}),e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Người cập nhật: "})," ",n.updatedBy]})]}),e.jsxs(L,{align:"center",children:[a==="role"?e.jsxs(U,{value:l.role||"",onBlur:()=>s(null),autoFocus:!0,onChange:j=>z("role",j.target.value),placeholder:"Chọn vai trò",width:{base:"100%",md:"50%"},children:[e.jsx("option",{value:"1",children:"Người quản trị"}),e.jsx("option",{value:"2",children:"Người dùng"}),e.jsx("option",{value:"3",children:"Giáo viên"})]}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Vai trò:"})," ",Qr[n.role]||"Khác"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>u("role"),cursor:"pointer"})]}),e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Tổng điểm: "}),n.totalPoint]})]})})]})]}),e.jsx(L,{justifyContent:"flex-end",mt:6,children:e.jsx(H,{variant:"solid",size:"lg",colorScheme:"teal",borderRadius:"xl",px:10,boxShadow:"lg",bgGradient:"linear(to-l, green.500, green.300)",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},onClick:S,isLoading:h,loadingText:"Đang lưu...",children:"Lưu"})})]})})}):e.jsx(bt,{})};function Xr({isOpen:t,onClose:n,fetchData:o}){const[a,s]=r.useState(""),[l,p]=r.useState(""),[i,g]=r.useState(""),[d,m]=r.useState({}),h=Q(),[f,c]=r.useState(!1),{colorMode:v}=ce(),b=v==="light"?"black":"white",x=v==="light"?"gray.100":"whiteAlpha.100";r.useEffect(()=>{t&&(s(""),p(""),g(""),m({}))},[t]);const y=async()=>{c(!0);try{await st({controller:"Badge",data:{name:a,description:l,color:i}}),h({title:"Thêm mới thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),o&&await o(),m({}),n()}catch(D){if(D.response&&D.response.data.errors){const u=D.response.data.errors.reduce((z,C)=>(C.includes("Tên nhãn")&&(z.name=C),C.includes("Mô tả")&&(z.description=C),C.includes("Mã màu")&&(z.color=C),z),{});m(u)}else h({title:"Đã xảy ra lỗi.",description:D.message||"Có lỗi xảy ra khi tạo nhãn.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}finally{c(!1)}};return e.jsxs(je,{size:"2xl",isOpen:t,onClose:n,children:[e.jsx(de,{}),e.jsxs(fe,{children:[e.jsx(ve,{fontSize:"25px",textAlign:"center",children:" Thêm mới nhãn "}),e.jsx(ye,{}),e.jsxs(he,{children:[e.jsxs(M,{isInvalid:d.name,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Tên nhãn",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{bg:x,placeholder:"Nhập tên nhãn",value:a,onChange:D=>s(D.target.value),textColor:b}),e.jsx(q,{children:d.name})]}),e.jsxs(M,{mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Mã màu"}),e.jsxs(xe,{templateColumns:"1fr auto auto",gap:4,alignItems:"center",children:[e.jsx(te,{bg:x,placeholder:"Nhập mã màu (VD: #ff0000)",value:i,onChange:D=>g(D.target.value),textColor:i}),e.jsx(oe,{type:"color",value:i,onChange:D=>g(D.target.value),w:"40px",h:"40px",p:0,border:"none",borderRadius:"md",cursor:"pointer"})]})]}),e.jsxs(M,{mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Mô tả"}),e.jsx(ut,{bg:x,placeholder:"Nhập mô tả",value:l,onChange:D=>p(D.target.value),textColor:b})]})]}),e.jsxs(De,{children:[e.jsx(H,{colorScheme:"gray",mr:3,onClick:n,children:"Hủy"}),e.jsx(H,{colorScheme:"green",isLoading:f,loadingText:"Đang lưu...",onClick:y,justifyContent:"center",alignItems:"center",children:"Thêm"})]})]})]})}const dn=[{Header:"STT",accessor:"stt",Cell:({rowIndex:t})=>t+1},{Header:"Tên nhãn",accessor:"name",sortable:!0},{Header:"Mô tả",accessor:"description"},{Header:"Mã màu",accessor:"color"},{Header:"Review",accessor:"color",Cell:({value:t})=>e.jsx(E,{w:"40px",h:"20px",bg:t,border:"none",borderColor:"gray.300",borderRadius:"md"})},{Header:"Hành động",accessor:"action",Cell:t=>e.jsx(qe,{...t,controller:"Badge",deleteFunction:$e,idData:"badgeID",deleteSuccessToast:{title:"Đã xóa!",description:"Nhãn đã được xóa thành công."},deleteErrorToast:{title:"Xóa thất bại!",description:"Vui lòng thử lại sau."},fetchData:t.fetchData})}];function Ur(){_e("Quản lý nhãn");const t=Q(),{isOpen:n,onOpen:o,onClose:a}=ie(),s=We(),[l,p]=r.useState("name"),[i,g]=r.useState(!0),[d,m]=r.useState(1),[h,f]=r.useState(10),[c,v]=r.useState(""),b=Qe(c,600),x=k=>typeof k=="string"&&k.trim()!=="",y=["badges",d,h,i,l],D=["badgesSearch",b,d,h],{data:u,isLoading:z}=pe({queryKey:y,queryFn:()=>X({controller:"Badge",page:d,pageSize:h,ascending:i}),enabled:!x(b),keepPreviousData:!0,staleTime:6e4,retry:1,onError:()=>{t({title:"Lỗi khi tải dữ liệu",description:"Không thể tải dữ liệu. Vui lòng thử lại sau.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}}),{data:C,isLoading:S}=pe({queryKey:D,queryFn:()=>ge({controller:"Badge",keyword:b,page:d,pageSize:h}),enabled:x(b),keepPreviousData:!0,staleTime:6e4,retry:1,onError:k=>{t({title:"Lỗi khi tìm kiếm",description:k.message||"Không thể tìm kiếm. Vui lòng thử lại sau.",status:"error",duration:3e3,isClosable:!0,position:"top",variant:"left-accent"})}});r.useEffect(()=>{const k=x(b)?C:u;if(k!=null&&k.totalPages&&d<k.totalPages){const T=d+1;x(b)?s.prefetchQuery({queryKey:["badgesSearch",b,T,h],queryFn:()=>ge({controller:"Badge",keyword:b,page:T,pageSize:h}),staleTime:6e4,retry:1}):s.prefetchQuery({queryKey:["badges",T,h,i,l],queryFn:()=>X({controller:"Badge",page:T,pageSize:h,ascending:i}),staleTime:6e4,retry:1})}},[b,C,u,d,h,i,l,s]);const j=k=>{l===k?g(!i):(p(k),g(!0)),m(1)},F=k=>{const T=x(b)?(C==null?void 0:C.totalPages)||0:(u==null?void 0:u.totalPages)||0;k>0&&k<=T&&m(k)},R=k=>{const T=parseInt(k,10);T!==h&&(f(T),m(1))},_=k=>{v(k),m(1)},A=()=>{s.invalidateQueries({queryKey:["badges"]}),s.invalidateQueries({queryKey:["badgesSearch"]})},V=x(b)?C==null?void 0:C.data:u==null?void 0:u.data,W=x(b)?(C==null?void 0:C.totalPages)||0:(u==null?void 0:u.totalPages)||0,Y=x(b)?(C==null?void 0:C.totalCount)||0:(u==null?void 0:u.totalCount)||0,N=x(b)?S:z;return e.jsx(me,{children:e.jsxs(E,{pt:{base:"130px",md:"80px",xl:"80px"},children:[e.jsx(Ve,{onAdd:o,onSearch:_,valueSearch:c,title:dn}),e.jsx(Xr,{isOpen:n,onClose:a,fetchData:A}),e.jsx(Ge,{columnsData:dn,tableData:V||[],loading:N,onSort:j,sortField:l,ascending:i,fetchData:A}),e.jsx(Oe,{currentPage:d,totalPages:W,totalRows:Y,onPageChange:F,pageSize:h,onPageSizeChange:R})]})})}function Jr({isOpen:t,onClose:n,fetchData:o}){const[a,s]=r.useState(""),[l,p]=r.useState(""),[i,g]=r.useState({}),d=Q(),[m,h]=r.useState(!1),{colorMode:f}=ce(),c=f==="light"?"black":"white",v=f==="light"?"gray.100":"whiteAlpha.100";r.useEffect(()=>{t&&(s(""),p(""),g({}))},[t]);const b=()=>{const y={};return a.trim()||(y.name="Tên loại khóa học không được để trống."),l||(y.order="Vui lòng chọn thứ tự."),g(y),Object.keys(y).length===0},x=async()=>{if(b()){h(!0);try{const y={name:a,order:Number(l)};await st({controller:"CourseCategory",data:y}),d({title:"Thêm mới thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),o&&await o(),g({}),n()}catch(y){if(y.response&&y.response.data.errors){const D=y.response.data.errors.reduce((u,z)=>(z.includes("Tên loại khóa học")&&(u.name=z),z.includes("Thứ tự")&&(u.order=z),u),{});g(D)}else d({title:"Đã xảy ra lỗi.",description:y.message||"Có lỗi xảy ra khi tạo nhãn.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}finally{h(!1)}}};return e.jsxs(je,{size:"2xl",isOpen:t,onClose:n,children:[e.jsx(de,{}),e.jsxs(fe,{children:[e.jsx(ve,{fontSize:"25px",textAlign:"center",children:"Thêm mới nhãn"}),e.jsx(ye,{}),e.jsxs(he,{children:[e.jsxs(M,{isInvalid:!!i.name,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Tên loại khóa học ",e.jsx(I,{as:"span",color:"red.500",children:"*"})]}),e.jsx(te,{bg:v,placeholder:"Nhập tên nhãn",value:a,onChange:y=>s(y.target.value),textColor:c}),e.jsx(q,{children:i.name})]}),e.jsxs(M,{isInvalid:!!i.order,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Thứ tự ",e.jsx(I,{as:"span",color:"red.500",children:"*"})]}),e.jsxs(U,{bg:v,placeholder:"Chọn thứ tự",value:l,onChange:y=>p(y.target.value),textColor:c,children:[e.jsx("option",{value:"1",children:"1"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"})]}),e.jsx(q,{children:i.order})]})]}),e.jsxs(De,{children:[e.jsx(H,{colorScheme:"gray",mr:3,onClick:n,children:"Hủy"}),e.jsx(H,{colorScheme:"green",isLoading:m,loadingText:"Đang lưu...",onClick:x,children:"Thêm"})]})]})]})}const hn=[{Header:"STT",accessor:"stt",Cell:({rowIndex:t})=>t+1},{Header:"Tên loại khóa học",accessor:"name",sortable:!0},{Header:"Thứ tự",accessor:"order"},{Header:"Hành động",accessor:"action",Cell:t=>e.jsx(qe,{...t,controller:"CourseCategory",deleteFunction:$e,idData:"courseCategoryID",deleteSuccessToast:{title:"Đã xóa!",description:"Loại khóa học đã được xóa thành công."},deleteErrorToast:{title:"Xóa thất bại!",description:"Vui lòng thử lại sau."},fetchData:t.fetchData})}];function Zr(){_e("Quản lý nhãn");const t=Q(),{isOpen:n,onOpen:o,onClose:a}=ie(),s=We(),[l,p]=r.useState("name"),[i,g]=r.useState(!0),[d,m]=r.useState(1),[h,f]=r.useState(10),[c,v]=r.useState(""),b=Qe(c,600),x=w=>typeof w=="string"&&w.trim()!=="",y=["categorycourses",d,h,i,l],D=["categorycoursesSearch",b,d,h],{data:u,isFetching:z,isError:C}=pe({queryKey:y,queryFn:()=>X({controller:"CourseCategory",page:d,pageSize:h,ascending:i}),enabled:!x(b),keepPreviousData:!0,staleTime:9999,retry:1,onError:()=>{t({title:"Lỗi khi tải dữ liệu",description:"Không thể tải dữ liệu. Vui lòng thử lại sau.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}}),{data:S,isFetching:j,isError:F}=pe({queryKey:D,queryFn:()=>ge({controller:"CourseCategory",keyword:b,page:d,pageSize:h}),enabled:x(b),keepPreviousData:!0,staleTime:9999,retry:1,onError:w=>{t({title:"Lỗi khi tìm kiếm",description:w.message||"Không thể tìm kiếm. Vui lòng thử lại sau.",status:"error",duration:3e3,isClosable:!0,position:"top",variant:"left-accent"})}});r.useEffect(()=>{const w=x(b)?S:u;if(w!=null&&w.totalPages&&d<w.totalPages){const O=d+1;x(b)?s.prefetchQuery({queryKey:["categorycoursesSearch",b,O,h],queryFn:()=>ge({controller:"CourseCategory",keyword:b,page:O,pageSize:h})}):s.prefetchQuery({queryKey:["categorycourses",O,h,i,l],queryFn:()=>X({controller:"CourseCategory",page:O,pageSize:h,ascending:i})})}},[b,S,u,d,h,i,l,s]);const R=w=>{l===w?g(!i):(p(w),g(!0)),m(1)},_=w=>{w>0&&w<=N&&m(w)},A=w=>{const O=parseInt(w,10);O!==h&&(f(O),m(1))},V=w=>{v(w),m(1)},W=()=>{s.invalidateQueries({queryKey:["categorycourses"]}),s.invalidateQueries({queryKey:["categorycoursesSearch"]})},Y=x(b)?S==null?void 0:S.data:u==null?void 0:u.data,N=x(b)?(S==null?void 0:S.totalPages)||0:(u==null?void 0:u.totalPages)||0,k=x(b)?(S==null?void 0:S.totalCount)||0:(u==null?void 0:u.totalCount)||0,T=x(b)?j||b!==c:z;return e.jsx(me,{children:e.jsxs(E,{pt:{base:"130px",md:"80px",xl:"80px"},children:[e.jsx(Ve,{onAdd:o,onSearch:V,valueSearch:c,title:hn}),e.jsx(Jr,{isOpen:n,onClose:a,fetchData:W}),e.jsx(Ge,{columnsData:hn,tableData:Y||[],loading:T,onSort:R,sortField:l,ascending:i,fetchData:W}),e.jsx(Oe,{currentPage:d,totalPages:N,totalRows:k,onPageChange:_,pageSize:h,onPageSizeChange:A})]})})}const Wn=({onImageChange:t,previewWidth:n="150px",previewHeight:o="150px",...a})=>{const[s,l]=r.useState(null),p=g=>{const d=g.target.files[0];if(d&&d.type.startsWith("image/")){const m=new FileReader;m.onloadend=()=>{l(m.result),t&&t(d)},m.readAsDataURL(d)}else l(null),t&&t(null)},i=()=>{l(null),t&&t(null)};return e.jsx(le,{align:"center",spacing:2,position:"relative",children:e.jsxs(E,{position:"relative",width:n,height:o,children:[e.jsx(E,{width:"100%",height:"100%",border:s?"none":"2px dashed",borderColor:"gray.300",rounded:"md",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",bg:"gray.50",_hover:{borderColor:s?"none":"blue.400"},children:s?e.jsx(Je,{src:s,alt:"Preview",width:"100%",height:"100%",objectFit:"cover"}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{type:"file",accept:"image/*",onChange:p,opacity:0,position:"absolute",width:"100%",height:"100%",cursor:"pointer",...a}),e.jsx(E,{position:"absolute",textAlign:"center",pointerEvents:"none",color:"gray.500",children:e.jsx(vs,{fontSize:"5vh"})})]})}),s&&e.jsx($,{icon:e.jsx(Ss,{}),size:"sm",colorScheme:"red",position:"absolute",top:"-10px",right:"-10px",borderRadius:"full","aria-label":"Xóa ảnh",onClick:i,boxShadow:"lg",transformOrigin:"center"})]})})};Wn.propTypes={onImageChange:ee.func,inputProps:ee.object,previewWidth:ee.oneOfType([ee.string,ee.number]),previewHeight:ee.oneOfType([ee.string,ee.number])};const Me={buttons:["bold","italic","underline","strikethrough","ul","ol","image","video","link","align","justify","source","clean"],uploader:{insertImageAsBase64URI:!0},video:{url:!0},min_height:350,width:"auto",placeholder:"Nhập nội dung tại đây...",theme:"default"};function eo({isOpen:t,onClose:n,fetchData:o}){const a=r.useRef(null),[s,l]=r.useState({coderID:"",courseName:"",courseCategoryID:"",fee:"",originalFee:"",isCombo:!1,badgeID:"",status:0,description:"",overview:"",imageFile:null}),[p,i]=r.useState([]),[g,d]=r.useState([]),[m,h]=r.useState({}),f=Q(),[c,v]=r.useState(!1),{colorMode:b}=ce(),x=b==="light"?"black":"white",y=b==="light"?"gray.100":"whiteAlpha.100";r.useEffect(()=>{t&&(l({coderID:"1",courseName:"",courseCategoryID:"",fee:0,originalFee:0,isCombo:!1,badgeID:"",status:0,description:"",overview:"",imageFile:null}),h({}),D())},[t]);const D=async()=>{try{const j=await X({controller:"CourseCategory",page:1,pageSize:10}),F=await X({controller:"Badge",page:1,pageSize:10});i(j.data),d(F.data)}catch(j){console.error("Lỗi khi lấy danh mục khóa học:",j),i([])}},u=j=>{const{name:F,value:R}=j.target;l(_=>({..._,[F]:F==="status"?parseInt(R,10):R}))},z=()=>{let j={};return s.courseName||(j.courseName="Tên khóa học không được bỏ trống"),s.courseCategoryID||(j.courseCategoryID="Vui lòng chọn danh mục khóa học"),s.fee<0&&(j.fee="Học phí phải là số dương"),s.originalFee<0&&(j.originalFee="Học phí gốc phải là số dương"),h(j),Object.keys(j).length===0},C=(j,F)=>{l(R=>({...R,[j]:F}))},S=async()=>{if(!z())return;v(!0);const j=new FormData;j.append("coderID",s.coderID),j.append("courseName",s.courseName),j.append("courseCategoryID",s.courseCategoryID),j.append("fee",s.fee),j.append("originalFee",s.originalFee),j.append("isCombo",s.isCombo),j.append("badgeID",s.badgeID),j.append("status",s.status),j.append("description",s.description),j.append("overview",s.overview),s.imageFile&&j.append("imageFile",s.imageFile);try{await st({controller:"Course",data:j}),f({title:"Thêm mới khóa học thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),o&&await o(),n()}catch(F){let R="Đã xảy ra lỗi. Vui lòng thử lại.";F.response&&F.response.data?R=F.response.data.message||"Lỗi không xác định từ server.":F.message&&(R=F.message),f({title:"Đã xảy ra lỗi.",description:R,status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}finally{v(!1)}};return e.jsxs(je,{size:"4xl",isOpen:t,onClose:n,scrollBehavior:"inside",isCentered:!0,children:[e.jsx(de,{}),e.jsxs(fe,{children:[e.jsx(ve,{fontSize:"25px",textAlign:"center",children:"Thêm mới khóa học"}),e.jsx(ye,{}),e.jsxs(he,{children:[e.jsxs(M,{mb:6,children:[e.jsx(B,{textAlign:"center",fontWeight:"bold",children:"Ảnh khóa học"}),e.jsx(Wn,{label:"chọn ảnh đại diện",previewWidth:"40vh",previewHeight:"20vh",onImageChange:j=>l(F=>({...F,imageFile:j}))})]}),e.jsx(ue,{my:3}),e.jsxs(xe,{templateColumns:"repeat(2, 1fr)",gap:"6",children:[e.jsxs(ne,{children:[e.jsxs(M,{isInvalid:m.courseName,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Tên khóa học",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{bg:y,placeholder:"Nhập tên khóa học",name:"courseName",value:s.courseName,onChange:u,textColor:x}),e.jsx(q,{children:m.courseName})]}),e.jsxs(M,{isInvalid:m.fee,mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Học phí hiện tại"}),e.jsx(te,{bg:y,type:"number",placeholder:"Nhập học phí",name:"fee",value:s.fee,onChange:u,textColor:x}),e.jsx(q,{children:m.fee})]}),e.jsxs(M,{isInvalid:m.originalFee,mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Học phí gốc"}),e.jsx(te,{bg:y,type:"number",placeholder:"Nhập học phí",name:"originalFee",value:s.originalFee,onChange:u,textColor:x}),e.jsx(q,{children:m.originalFee})]})]}),e.jsxs(ne,{children:[e.jsxs(M,{isInvalid:m.courseCategoryID,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Loại khóa học",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsxs(U,{bg:y,name:"courseCategoryID",value:s.courseCategoryID,onChange:u,textColor:x,children:[e.jsx("option",{value:"",children:"Chọn loại khóa học"},"0"),p.map(j=>e.jsx("option",{value:j.courseCategoryID,children:j.name},j.courseCategoryID))]}),e.jsx(q,{children:m.courseCategoryID})]}),e.jsxs(M,{isInvalid:m.badgeID,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Loại nhãn",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsxs(U,{bg:y,name:"badgeID",value:s.badgeID,onChange:u,textColor:x,children:[e.jsx("option",{value:"",children:"Chọn loại nhãn"},"0"),g.map(j=>e.jsx("option",{value:j.badgeID,children:j.name},j.badgeID))]}),e.jsx(q,{children:m.badgeID})]}),e.jsxs(M,{isInvalid:m.status,children:[e.jsx(B,{fontWeight:"bold",children:"Trạng thái"}),e.jsxs(U,{bg:y,name:"status",value:s.status,onChange:u,textColor:x,children:[e.jsx("option",{value:"",children:"Chọn trạng thái"},"default"),e.jsx("option",{value:"1",children:"Online"},"online"),e.jsx("option",{value:"0",children:"Offline"},"offline")]})]})]})]}),e.jsx(ue,{my:3}),e.jsxs(M,{isInvalid:m.description,mb:4,children:[e.jsx(B,{fontWeight:"bold",textAlign:"center",children:"Mô tả"}),e.jsx(E,{children:e.jsx(Ae,{ref:a,value:s.description,config:Me,onChange:j=>C("description",j),onBlur:j=>C("description",j)},s.courseId+"-explanation")}),e.jsx(q,{children:m.description})]}),e.jsx(ue,{my:3}),e.jsxs(M,{isInvalid:m.overview,mb:4,children:[e.jsx(B,{fontWeight:"bold",textAlign:"center",children:"Giới thiệu"}),e.jsx(Ae,{ref:a,value:s.overview,config:Me,onChange:j=>C("overview",j),onBlur:j=>C("overview",j)},s.courseId+"-explanation"),e.jsx(q,{children:m.overview})]})]}),e.jsxs(De,{children:[e.jsx(H,{colorScheme:"gray",mr:3,onClick:n,children:"Hủy"}),e.jsx(H,{colorScheme:"green",isLoading:c,loadingText:"Đang lưu...",onClick:S,children:"Thêm"})]})]})]})}const un=[{Header:"STT",accessor:"stt",Cell:({rowIndex:t})=>t+1},{Header:"Tên khóa học",accessor:"courseName",sortable:!0},{Header:"Loại khóa học",accessor:"courseCategoryName",sortable:!0},{Header:"Người tạo",accessor:"creatorName",sortable:!0},{Header:"Nhãn",accessor:"badgeName"},{Header:"Trạng thái",accessor:"status",Cell:({row:t})=>{const[n,o]=r.useState(t==null?void 0:t.status),a=t==null?void 0:t.courseID,s=Q(),l=ct({mutationFn:i=>{if(!a){console.error("Lỗi: Không có courseId");return}return Ot({controller:"Course",id:a,newStatus:i})},onSuccess:()=>{s({title:"Cập nhật thành công",description:"Cập nhật trạng thái thành công",status:"success",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"})},onError:i=>{console.error("Lỗi cập nhật trạng thái:",i),o(n),s({title:"Cập nhật thất bại",description:"Không thể cập nhật trạng thái, vui lòng thử lại.",status:"error",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"})}}),p=()=>{const i=n===0?1:0;o(i),l.mutate(i)};return e.jsx(Ke,{bg:n===1?"green.400":"red.400",fontSize:"sm",textColor:"white",cursor:"pointer",onClick:p,children:n===1?"Online":"Offline"})}},{Header:"Hành động",accessor:"action",Cell:t=>e.jsx(qe,{...t,controller:"Course",deleteFunction:$e,idData:"courseID",detailPath:"course",deleteSuccessToast:{title:"Đã xóa!",description:"Khóa học đã được xóa thành công."},fetchData:t.fetchData})}];function to(){_e("Quản lý khóa học");const t=Q(),{isOpen:n,onOpen:o,onClose:a}=ie(),s=We(),[l,p]=r.useState("name"),[i,g]=r.useState(!0),[d,m]=r.useState(1),[h,f]=r.useState(10),[c,v]=r.useState(""),b=Qe(c,600),x=w=>typeof w=="string"&&w.trim()!=="",y=["courses",d,h,i,l],D=["courseSearch",b,d,h],{data:u,isFetching:z,isError:C}=pe({queryKey:y,queryFn:()=>X({controller:"Course",page:d,pageSize:h,ascending:i}),enabled:!x(b),keepPreviousData:!0,staleTime:9999,retry:1,onError:w=>{t({title:"Lỗi khi tải dữ liệu",description:w.message||"Không thể tải dữ liệu. Vui lòng thử lại sau.",status:"error",duration:3e3,isClosable:!0,position:"top",variant:"left-accent"})}}),{data:S,isFetching:j,isError:F}=pe({queryKey:D,queryFn:()=>ge({controller:"Course",keyword:b,page:d,pageSize:h}),enabled:x(b),keepPreviousData:!0,staleTime:9999,retry:1,onError:w=>{t({title:"Lỗi khi tìm kiếm",description:w.message||"Không thể tìm kiếm. Vui lòng thử lại sau.",status:"error",duration:3e3,isClosable:!0,position:"top",variant:"left-accent"})}});r.useEffect(()=>{const w=x(b)?S:u;if(w!=null&&w.totalPages&&d<w.totalPages){const O=d+1;x(b)?s.prefetchQuery({queryKey:["courseSearch",b,O,h],queryFn:()=>ge({controller:"Course",keyword:b,page:O,pageSize:h})}):s.prefetchQuery({queryKey:["courses",O,h,i,l],queryFn:()=>X({controller:"Course",page:O,pageSize:h,ascending:i})})}},[b,S,u,d,h,i,l,s]);const R=w=>{v(w),m(1)},_=w=>{l===w?g(!i):(p(w),g(!0)),m(1)},A=w=>{if(w>0){const O=x(b)?(S==null?void 0:S.totalPages)||0:(u==null?void 0:u.totalPages)||0;w<=O&&m(w)}},V=w=>{const O=parseInt(w,10);O!==h&&(f(O),m(1))},W=()=>{s.invalidateQueries({queryKey:["courses"]}),s.invalidateQueries({queryKey:["courseSearch"]})},Y=x(b)?S==null?void 0:S.data:u==null?void 0:u.data,N=x(b)?(S==null?void 0:S.totalPages)||0:(u==null?void 0:u.totalPages)||0,k=x(b)?(S==null?void 0:S.totalCount)||0:(u==null?void 0:u.totalCount)||0,T=x(c)?j||b!==c:z;return e.jsx(me,{children:e.jsxs(E,{pt:{base:"130px",md:"80px",xl:"80px"},children:[e.jsx(Ve,{onAdd:o,onSearch:R,valueSearch:c,title:un}),e.jsx(eo,{isOpen:n,onClose:a,fetchData:W}),e.jsx(Ge,{columnsData:un,tableData:Y||[],loading:T,onSort:_,sortField:l,ascending:i,fetchData:W}),e.jsx(Oe,{currentPage:d,totalPages:N,totalRows:k,onPageChange:A,pageSize:h,onPageSizeChange:V})]})})}const at=t=>{const n=["a","abbr","acronym","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","menu","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],o=["href","src","alt","title","style","class","id","width","height","controls","frameborder","allowfullscreen","target","rel","type","name","value","placeholder","maxlength","rows","cols","disabled","checked","readonly","required","pattern","min","max","step","autoplay","loop","muted","poster","download","crossorigin","referrerpolicy","data","srcset","sizes","aria-*","role","tabindex"];return ws.sanitize(t||"Chưa có thông tin",{ALLOWED_TAGS:n,ALLOWED_ATTR:o})},At=({src:t,name:n,onLoad:o,...a})=>{const[s,l]=r.useState("rgb(0, 242, 255)"),p=r.useMemo(()=>Hn(t),[t]),i=r.useCallback(d=>{const m=new Image;m.crossOrigin="Anonymous",m.src=d,m.onload=()=>{const h=document.createElement("canvas"),f=h.getContext("2d");h.width=m.width,h.height=m.height,f.drawImage(m,0,0,m.width,m.height);const c=f.getImageData(m.width/2,m.height/2,1,1).data,v=`rgb(${c[0]}, ${c[1]}, ${c[2]})`;l(v),o==null||o()}},[o]);r.useEffect(()=>{p&&i(p)},[p,i]);const g=`
        0 0 5px ${s},
        0 0 10px ${s}
    `;return e.jsx(In,{name:n,src:p,alt:"Coder Avatar",boxShadow:g,border:"2px solid white",transition:"box-shadow 0.3s ease-in-out",filter:"saturate(1.2)",...a,loading:"lazy"})},Lt=new Map,no=t=>{const[n,o]=r.useState(null);return r.useEffect(()=>{if(!t)return;(async()=>{if(Lt.has(t)){o(Lt.get(t));return}try{const s=await nt({controller:"Coder",id:t});Lt.set(t,s),o(s)}catch(s){console.error(s)}})()},[t]),n},On=({coderID:t,...n})=>{const o=no(t);return o?e.jsx(At,{size:"sm",name:o.coderName,src:o.avatar||"",...n}):e.jsx(At,{size:"sm",name:"Loading...",...n})},so=({courseId:t,isOpen:n,onClose:o})=>{const[a,s]=r.useState([]),[l,p]=r.useState(!0),[i,g]=r.useState([0,0,0,0,0]),d=Q(),[m,h]=r.useState(!1),f=m?a:a.slice(0,5),c=()=>{h(y=>!y)},v=r.useCallback(async()=>{try{const D=(await J.get(`/Review?courseId=${t}`)).data||[];s(D);const u=[0,0,0,0,0];D.forEach(z=>u[z.rating-1]++),g(u.reverse())}catch(y){d({title:"Lỗi",description:y.message,status:"error"})}finally{p(!1)}},[t,d]);r.useEffect(()=>{n&&(p(!0),s([]),v())},[n,v]);const b=a.length,x=b>0?(a.reduce((y,D)=>y+D.rating,0)/b).toFixed(1):0;return e.jsxs(je,{size:"3xl",isOpen:n,onClose:o,isCentered:!0,scrollBehavior:"inside",children:[e.jsx(de,{}),e.jsxs(fe,{children:[e.jsxs(ve,{textAlign:"center",children:[" ",e.jsx(ft,{size:"lg",mb:4,children:"Đánh giá khóa học"})]}),e.jsx(ye,{}),e.jsx(he,{children:e.jsxs(E,{children:[e.jsxs(Ye,{spacing:6,align:"start",mb:6,children:[e.jsxs(E,{minW:"200px",children:[e.jsx(I,{fontSize:"5xl",children:x}),e.jsx(Ye,{children:[...Array(5)].map((y,D)=>e.jsx(Jt,{boxSize:7,color:D<Math.round(x)?"yellow.400":"gray.300"},D))}),e.jsxs(I,{color:"gray.500",mt:3,children:["(",b," đánh giá)"]})]}),e.jsx(le,{align:"start",flex:1,children:[5,4,3,2,1].map((y,D)=>{const u=b?Math.round(i[D]/b*100):0;return e.jsxs(Ye,{w:"100%",children:[e.jsxs(I,{w:"30px",flex:"0.1",children:[y," sao"]}),e.jsx(kn,{value:u,flex:"1",size:"sm",colorScheme:"yellow",bg:"gray.200",rounded:"md",sx:{"& > div":{backgroundColor:"yellow.400"}}}),e.jsxs(I,{w:"40px",textAlign:"right",color:"gray.400",children:[u,"%"]})]},y)})})]}),e.jsx(ue,{mb:6}),e.jsx(ft,{size:"md",mb:4,children:"Đánh giá của người học"}),l?e.jsx(Be,{}):f.length===0?e.jsx(I,{children:"Chưa có đánh giá nào."}):f.map(y=>e.jsxs(E,{mb:2,p:3,borderRadius:"md",children:[e.jsxs(Ye,{mb:1,children:[e.jsx(On,{coderID:y.coderID,size:"sm"}),e.jsxs(E,{children:[e.jsx(Ze,{to:`/profile/${y.coderID}`,children:e.jsx(I,{_hover:{color:"blue"},fontWeight:"bold",children:(y.coderName||"Ẩn danh").replace(/(.{3}).*(@.*)/,"$1******$2")})}),e.jsxs(Ye,{spacing:1,children:[[...Array(5)].map((D,u)=>e.jsx(Le,{as:Jt,color:u<y.rating?"yellow.400":"gray.300"},u)),e.jsx(I,{fontSize:"xs",color:"gray.500",children:ze(y.createdAt)})]})]})]}),e.jsx(I,{mt:2,children:y.content}),e.jsx(ue,{mt:2})]},y.reviewID)),a.length>5&&e.jsx(H,{mt:4,variant:"outline",colorScheme:"black",_hover:{bg:"black",color:"white"},onClick:c,children:m?"Thu gọn":"Xem thêm"})]})}),e.jsx(De,{children:e.jsx(H,{colorScheme:"blue",mr:3,onClick:o,children:"Đóng"})})]})]})},ro=()=>{var Qt,Yt;const{id:t}=lt(),n=r.useRef(null),[o,a]=r.useState(null),{isOpen:s,onOpen:l,onClose:p}=ie(),{isOpen:i,onOpen:g,onClose:d}=ie(),m=r.useRef(),[h,f]=r.useState(!1),[c,v]=r.useState([]),[b,x]=r.useState([]),[y,D]=r.useState(null),[u,z]=r.useState(null),[C,S]=r.useState({}),[j,F]=r.useState(null),R=we(),_=Q(),[A,V]=r.useState(!1),[W,Y]=r.useState(!1),{colorMode:N}=ce(),k=N==="light"?"black":"white",T=N==="light"?"white":"whiteAlpha.300",w=N==="light"?"white":"navy.800",O=N==="light"?"gray.200":"whiteAlpha.300",ae=r.useCallback(async()=>{try{const P=await nt({controller:"Course",id:t});D(P),S(P)}catch{_({title:"Đã xảy ra lỗi.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}},[t,_]),Ne=async()=>{try{const P=await X({controller:"CourseCategory",page:1,pageSize:10}),se=await X({controller:"Badge",page:1,pageSize:10});v(P.data),x(se.data)}catch(P){console.error("Lỗi khi lấy danh mục khóa học:",P),v([]),x([])}};r.useEffect(()=>{t&&(ae(),Ne())},[t,ae]);const ke=P=>{z(P)},Fe=(P,se)=>{S(Pe=>{const Ee={...Pe,[P]:se};return D(dt=>({...dt,[P]:se})),Ee})},Xn=async P=>{const se=P.target.files[0];if(se){const Pe=new FileReader;Pe.onloadend=async()=>{S(dt=>({...dt,avatar:Pe.result}));const Ee=new FormData;Ee.append("CourseID",t),Ee.append("ImageFile",se),C.courseName&&Ee.append("CourseName",C.courseName);try{await He({controller:"Course",id:t,data:Ee}),await ae(),_({title:"Cập nhật avatar thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}catch(dt){console.error("Đã xảy ra lỗi khi cập nhật avatar",dt),_({title:"Đã xảy ra lỗi khi cập nhật avatar.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}},Pe.readAsDataURL(se),F(se)}},Un=async()=>{V(!0);try{const P=new FormData;Object.keys(C).forEach(se=>{se!=="CourseID"&&P.append(se,C[se])}),j&&P.append("ImageFile",j),D(se=>({...se,...C})),await He({controller:"Course",id:t,data:P}),await ae(),z(null),_({title:"Cập nhật thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),V(!1)}catch(P){console.error("Đã xảy ra lỗi khi cập nhật",P),_({title:"Đã xảy ra lỗi khi cập nhật.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),V(!1)}},Jn=P=>{a(P),g()},Zn=async()=>{f(!0);try{await es(o),onClose()}finally{f(!1)}},es=async P=>{var se,Pe;try{(await J.delete("/Enrollment",{data:{courseID:t,coderID:P}})).status===200&&(_({title:"Đã xóa người dùng ra khỏi khóa học",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"}),await ae())}catch(Ee){console.error("Lỗi fetch course detail:",Ee),_({title:"Lỗi xóa",description:((Pe=(se=Ee.response)==null?void 0:se.data)==null?void 0:Pe.message)||"Có lỗi xảy ra",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})}};return y?e.jsx(me,{children:e.jsxs(xe,{templateColumns:{base:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},justify:"center",alignItems:"center",position:"relative",children:[e.jsx(E,{pt:{base:"130px",md:"80px",xl:"80px"},px:"10px",children:e.jsxs(E,{bg:T,p:{base:"4",md:"6"},borderRadius:"lg",boxShadow:"lg",w:{base:"100%",md:"100vh"},minW:"110vh",mx:"auto",children:[e.jsx(L,{justifyContent:"end",align:"end",px:{base:"10px",md:"25px"},children:e.jsxs(Kn,{offsetTop:"15",bg:w,borderRadius:"lg",children:[e.jsxs(H,{onClick:()=>R("/admin/course"),variant:"solid",size:"lg",colorScheme:"teal",borderRadius:"xl",px:5,boxShadow:"lg",bgGradient:"linear(to-l, messenger.500, navy.300)",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},children:[e.jsx(mt,{})," Quay lại"]}),e.jsx(H,{size:"lg",variant:"solid",colorScheme:"blue",px:5,onClick:l,borderRadius:"xl",boxShadow:"lg",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},children:"Xem đánh giá"}),e.jsx(so,{courseId:t,isOpen:s,onClose:p}),e.jsx(H,{variant:"solid",size:"lg",colorScheme:"teal",borderRadius:"xl",px:10,boxShadow:"lg",bgGradient:"linear(to-l, green.500, green.300)",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},onClick:Un,isLoading:A,loadingText:"Đang lưu...",children:"Lưu"})]})}),e.jsxs(le,{spacing:6,align:"stretch",mt:4,children:[e.jsxs(L,{direction:"column",align:"center",children:[e.jsx(Ce,{isLoaded:W,borderRadius:"md",w:"50%",h:"150px",mb:4,children:e.jsx(Je,{src:C.imageUrl||y.imageUrl||"/avatarSimmmple.png",alt:"Course Avatar",w:"100%",h:"150px",borderRadius:"md",objectFit:"cover",transition:"all 0.2s ease-in-out",_hover:{transform:"scale(1.05)"},onClick:()=>document.getElementById("avatarInput").click(),onLoad:()=>Y(!0),cursor:"pointer"})}),e.jsx(oe,{id:"avatarInput",type:"file",onChange:Xn,display:"none"})]}),e.jsx(ue,{}),e.jsxs(xe,{templateColumns:{base:"1fr",md:"repeat(2, 1fr)"},gap:6,children:[e.jsxs(ne,{borderRightWidth:2,children:[e.jsx(I,{align:"center",fontSize:25,mb:5,fontWeight:"bold",children:"Thông tin khóa học"}),e.jsxs(le,{align:"stretch",ps:{base:"0",md:"20px"},spacing:4,children:[["courseName","fee","originalFee"].map(P=>e.jsxs(L,{align:"center",children:[u===P?e.jsx(oe,{textColor:k,value:C[P]||"",onChange:se=>Fe(P,se.target.value),placeholder:`Chỉnh sửa ${P}`,onBlur:()=>z(null),autoFocus:!0}):e.jsxs(I,{fontSize:"lg",textColor:k,children:[e.jsxs("strong",{children:[P==="courseName"?"Tên khóa học":P==="fee"?"Giá tiền":"Giá tiền gốc",":"]})," ",P==="fee"||P==="originalFee"?Vt(y[P]):y[P]||"Chưa có thông tin"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>ke(P),cursor:"pointer"})]},P)),e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Phần trăm giảm: "}),e.jsxs(I,{as:"span",fontWeight:"bold",color:"red",children:[y.discountPercent," %"]})]}),e.jsxs(L,{align:"center",children:[u==="courseCategory"?e.jsx(U,{value:C.courseCategoryID||"",onBlur:()=>z(null),autoFocus:!0,onChange:P=>Fe("courseCategoryID",P.target.value),placeholder:"Chọn loại khóa học",width:{base:"100%",md:"50%"},children:c.map(P=>e.jsx("option",{value:P.courseCategoryID,children:P.name},P.courseCategoryID))}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Loại khóa học:"})," ",((Qt=c.find(P=>P.courseCategoryID===Number(y.courseCategoryID)))==null?void 0:Qt.name)||"Chưa chọn"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>ke("courseCategory"),cursor:"pointer"})]}),e.jsxs(L,{align:"center",children:[u==="badge"?e.jsx(U,{value:C.badgeID||"",onBlur:()=>z(null),autoFocus:!0,onChange:P=>Fe("badgeID",P.target.value),placeholder:"Chọn nhãn",width:{base:"100%",md:"50%"},children:b.map(P=>e.jsx("option",{value:P.badgeID,children:P.name},P.badgeID))}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Nhãn:"})," ",((Yt=b.find(P=>P.badgeID===Number(y.badgeID)))==null?void 0:Yt.name)||"Chưa chọn"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>ke("badge"),cursor:"pointer"})]})]})]}),e.jsxs(ne,{children:[e.jsx(I,{align:"center",fontSize:25,mb:5,fontWeight:"bold",children:"Thông tin khác"}),e.jsxs(le,{align:"stretch",ps:{base:"0",md:"20px"},spacing:4,children:[e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Ngày tạo: "}),ze(y.createdAt)]}),e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Người tạo: "})," ",y.creatorName]}),y.updatedAt&&e.jsxs(e.Fragment,{children:[e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Ngày cập nhật: "}),ze(y.updatedAt)]}),e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Người cập nhật: "})," ",y.creatorName]})]})]})]})]}),e.jsx(ue,{}),e.jsxs(L,{align:"center",justifyContent:"center",children:[u==="description"?e.jsx(E,{width:"100%",overflowY:"auto",children:e.jsx(Ae,{ref:n,value:C.description,config:Me,onChange:P=>Fe("description",P),autoFocus:!0,height:"1000px",style:{width:"100%",minHeight:"1000px"}})}):e.jsxs(E,{width:"max-content",children:[e.jsx(I,{fontSize:"lg",children:e.jsx("strong",{children:"Nội dung bài học:"})}),e.jsx(E,{overflowY:"auto",maxHeight:"300px",sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:at(y==null?void 0:y.description)}})]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>ke("description"),cursor:"pointer"})]}),e.jsxs(L,{align:"center",justifyContent:"center",children:[u==="overview"?e.jsx(E,{width:"100%",overflowY:"auto",children:e.jsx(Ae,{ref:n,value:C.overview,config:Me,onChange:P=>Fe("overview",P),autoFocus:!0,height:"1000px",style:{width:"100%",minHeight:"1000px"}})}):e.jsxs(E,{width:"max-content",children:[e.jsx(I,{fontSize:"lg",textAlign:"center",children:e.jsx("strong",{children:"Nội dung bài học:"})}),e.jsx(E,{overflowY:"auto",maxHeight:"300px",sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:at(y==null?void 0:y.overview)}})]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>ke("overview"),cursor:"pointer"})]})]})]})}),e.jsx(E,{px:"25px",position:"fixed",top:"14vh",right:"2vh",display:{base:"none",md:"none",xl:"block"},children:e.jsxs(E,{bg:T,p:{base:"4",md:"6"},borderRadius:"lg",boxShadow:"lg",w:{base:"100%",md:"50vh"},minH:"40vh",mx:"auto",overflow:"auto",overflowY:"auto",children:[e.jsx(I,{align:"center",fontSize:25,mb:5,fontWeight:"bold",children:"Danh sách chủ đề"}),e.jsx(ht,{spacing:4,children:y.topics.map((P,se)=>e.jsx(Ze,{to:`/admin/topic/detail/${P.topicID}`,children:e.jsxs(Ct,{p:2,bg:O,borderRadius:"md",my:2,_hover:{transform:"translateY(-5px)"},transition:"transform 0.1s ease-in-out",children:[e.jsxs(I,{as:"span",fontWeight:"bold",children:["Chủ đề ",se+1,":"]})," ",P.topicName]},P.topicID)},P.topicID))})]})}),e.jsx(E,{px:"25px",position:"fixed",bottom:"10px",right:"2vh",display:{base:"none",md:"none",xl:"block"},children:e.jsxs(E,{bg:T,p:{base:"4",md:"6"},borderRadius:"lg",boxShadow:"lg",w:{base:"100%",md:"50vh"},minH:"40vh",mx:"auto",overflow:"auto",overflowY:"auto",children:[e.jsx(I,{align:"center",fontSize:25,mb:5,fontWeight:"bold",children:"Danh sách người đăng ký"}),e.jsx(ht,{spacing:4,children:y.enrollments.map((P,se)=>e.jsxs(L,{align:"center",justify:"space-between",bg:"transparent",children:[e.jsx(Ie,{label:`Xem chi tiết ${P.coderName}`,placement:"top",hasArrow:!0,children:e.jsx(Ze,{to:`/admin/coder/detail/${P.coderID}`,style:{flex:1,textDecoration:"none"},children:e.jsx(E,{bg:O,p:2,borderRadius:"md",_hover:{transform:"translateY(-3px)"},transition:"all 0.1s ease-in-out",children:e.jsxs(I,{fontWeight:"bold",whiteSpace:"normal",color:k,children:[se+1,": ",P.coderName]})})})}),e.jsx(Ie,{label:"Xóa người dùng",placement:"top",hasArrow:!0,children:e.jsx($,{icon:e.jsx(ks,{}),colorScheme:"red",size:"sm","aria-label":"Xóa",isRound:!0,ml:2,onClick:()=>Jn(P.coderID)})})]},P.coderID))}),e.jsx(Is,{isOpen:i,leastDestructiveRef:m,onClose:h?()=>{}:d,isCentered:!0,children:e.jsx(de,{children:e.jsxs(Ts,{children:[e.jsx(ve,{fontSize:"lg",fontWeight:"bold",children:"Xác nhận xóa"}),e.jsx(he,{children:"Bạn có chắc muốn xóa người dùng này khỏi khóa học?"}),e.jsxs(De,{children:[e.jsx(H,{ref:m,onClick:d,isDisabled:h,children:"Hủy"}),e.jsx(H,{colorScheme:"red",onClick:Zn,ml:3,isLoading:h,loadingText:"Đang xóa",children:"Xóa"})]})]})})})]})})]})}):e.jsx(bt,{})};function oo({isOpen:t,onClose:n,fetchData:o}){const[a,s]=r.useState({courseID:"",courseName:"",topicName:"",topicDescription:"",status:0}),[l,p]=r.useState([]),[i,g]=r.useState({}),d=Q(),[m,h]=r.useState(!1),{colorMode:f}=ce(),c=f==="light"?"black":"white",v=f==="light"?"gray.100":"whiteAlpha.100";r.useEffect(()=>{t&&(s({courseID:"",courseName:"",topicName:"",topicDescription:"",status:0}),g({}),b())},[t]);const b=async()=>{try{const u=await X({controller:"Course",page:1,pageSize:10});p(u.data)}catch(u){console.error("Lỗi khi lấy danh mục khóa học:",u),p([])}},x=u=>{const{name:z,value:C}=u.target;s(S=>({...S,[z]:z==="status"?parseInt(C,10):C}))},y=()=>{let u={};return a.topicName||(u.topicName="Tên chủ đề không được bỏ trống"),a.courseID||(u.courseID="Vui lòng chọn khóa học"),g(u),Object.keys(u).length===0},D=async()=>{if(y()){h(!0);try{const u=new FormData;u.append("topicName",a.topicName),u.append("courseID",a.courseID),u.append("courseName",a.courseName),u.append("topicDescription",a.topicDescription),u.append("status",a.status),await st({controller:"Topic",data:u}),d({title:"Thêm mới chủ đề thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),o&&await o(),n()}catch(u){d({title:"Đã xảy ra lỗi.",description:u.message||"Có lỗi xảy ra khi tạo khóa học.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}finally{h(!1)}}};return e.jsxs(je,{size:"2xl",isOpen:t,onClose:n,children:[e.jsx(de,{}),e.jsxs(fe,{children:[e.jsx(ve,{fontSize:"25px",textAlign:"center",children:"Thêm mới chủ đề"}),e.jsx(ye,{}),e.jsxs(he,{children:[e.jsxs(M,{isInvalid:i.topicName,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Tên chủ đề",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{bg:v,placeholder:"Nhập tên chủ đề",name:"topicName",value:a.topicName,onChange:x,textColor:c}),e.jsx(q,{children:i.topicName})]}),e.jsxs(M,{isInvalid:i.courseID,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Loại khóa học",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsxs(U,{bg:v,name:"courseID",value:a.courseID,onChange:x,textColor:c,children:[e.jsx("option",{value:"",children:"Chọn loại khóa học"},"0"),l.map(u=>e.jsx("option",{value:u.courseID,children:u.courseName},u.courseID))]}),e.jsx(q,{children:i.courseID})]}),e.jsxs(M,{mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Mô tả"}),e.jsx(ut,{name:"topicDescription",bg:v,placeholder:"Nhập mô tả",value:a.topicDescription,onChange:x,textColor:c,maxH:"100px"})]}),e.jsxs(M,{isInvalid:i.status,children:[e.jsx(B,{fontWeight:"bold",children:"Trạng thái"}),e.jsxs(U,{bg:v,name:"status",value:a.status,onChange:x,textColor:c,children:[e.jsx("option",{value:"",children:"Chọn trạng thái"},"default"),e.jsx("option",{value:"1",children:"Online"},"online"),e.jsx("option",{value:"0",children:"Offline"},"offline")]})]})]}),e.jsxs(De,{children:[e.jsx(H,{colorScheme:"gray",mr:3,onClick:n,children:"Hủy"}),e.jsx(H,{colorScheme:"green",isLoading:m,loadingText:"Đang lưu...",onClick:D,children:"Thêm"})]})]})]})}const pn=[{Header:"STT",accessor:"stt",Cell:({rowIndex:t})=>t+1},{Header:"Tên chủ đề",accessor:"topicName",sortable:!0},{Header:"Tên khóa học",accessor:"courseName",sortable:!0},{Header:"Mô tả",accessor:"topicDescription"},{Header:"Trạng thái",accessor:"status",Cell:({row:t})=>{const[n,o]=r.useState(t==null?void 0:t.status),a=t==null?void 0:t.topicID,s=Q(),l=ct({mutationFn:i=>{if(!a){console.error("Lỗi: Không có topicId");return}return Ot({controller:"Topic",id:a,newStatus:i})},onSuccess:()=>{s({title:"Cập nhật thành công",description:"Cập nhật trạng thái thành công",status:"success",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"})},onError:i=>{console.error("Lỗi cập nhật trạng thái:",i),o(n),s({title:"Cập nhật thất bại",description:"Không thể cập nhật trạng thái, vui lòng thử lại.",status:"error",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"})}}),p=()=>{const i=n===0?1:0;o(i),l.mutate(i)};return e.jsx(Ke,{bg:n===1?"green.400":"red.400",fontSize:"sm",textColor:"white",cursor:"pointer",onClick:p,children:n===1?"Online":"Offline"})}},{Header:"Hành động",accessor:"action",Cell:t=>e.jsx(qe,{...t,controller:"Topic",deleteFunction:$e,idData:"topicID",detailPath:"topic",deleteSuccessToast:{title:"Đã xóa!",description:"Khóa học đã được xóa thành công."},deleteErrorToast:{title:"Xóa thất bại!",description:"Vui lòng thử lại sau."},fetchData:t.fetchData})}];function ao(){_e("Quản lý chủ đề");const t=Q(),{isOpen:n,onOpen:o,onClose:a}=ie(),s=We(),[l,p]=r.useState("name"),[i,g]=r.useState(!0),[d,m]=r.useState(1),[h,f]=r.useState(10),[c,v]=r.useState(""),b=Qe(c,600),x=k=>typeof k=="string"&&k.trim()!=="",y=["topics",d,h,i,l],D=["topicsSearch",b,d,h],{data:u,isLoading:z}=pe({queryKey:y,queryFn:()=>X({controller:"Topic",page:d,pageSize:h,ascending:i}),enabled:!x(b),keepPreviousData:!0,staleTime:6e4,retry:1,onError:()=>{t({title:"Lỗi khi tải dữ liệu",description:"Không thể tải dữ liệu. Vui lòng thử lại sau.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}}),{data:C,isLoading:S}=pe({queryKey:D,queryFn:()=>ge({controller:"Topic",keyword:b,page:d,pageSize:h}),enabled:x(b),keepPreviousData:!0,staleTime:6e4,retry:1,onError:()=>{t({title:"Lỗi khi tìm kiếm",description:"Không thể tìm kiếm. Vui lòng thử lại sau.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}});r.useEffect(()=>{const k=x(b)?C:u;if(k!=null&&k.totalPages&&d<k.totalPages){const T=d+1;x(b)?s.prefetchQuery({queryKey:["topicsSearch",b,T,h],queryFn:()=>ge({controller:"Topic",keyword:b,page:T,pageSize:h}),staleTime:6e4,retry:1}):s.prefetchQuery({queryKey:["topics",T,h,i,l],queryFn:()=>X({controller:"Topic",page:T,pageSize:h,ascending:i}),staleTime:6e4,retry:1})}},[b,C,u,d,h,i,l,s]);const j=k=>{l===k?g(!i):(p(k),g(!0)),m(1)},F=k=>{const T=x(b)?(C==null?void 0:C.totalPages)||0:(u==null?void 0:u.totalPages)||0;k>0&&k<=T&&m(k)},R=k=>{const T=parseInt(k,10);T!==h&&(f(T),m(1))},_=k=>{v(k),m(1)},A=()=>{s.invalidateQueries({queryKey:["topics"]}),s.invalidateQueries({queryKey:["topicsSearch"]})},V=x(b)?C==null?void 0:C.data:u==null?void 0:u.data,W=x(b)?(C==null?void 0:C.totalPages)||0:(u==null?void 0:u.totalPages)||0,Y=x(b)?(C==null?void 0:C.totalCount)||0:(u==null?void 0:u.totalCount)||0,N=x(b)?S:z;return e.jsx(me,{children:e.jsxs(E,{pt:{base:"130px",md:"80px",xl:"80px"},children:[e.jsx(Ve,{onAdd:o,onSearch:_,valueSearch:c,title:pn}),e.jsx(oo,{isOpen:n,onClose:a,fetchData:A}),e.jsx(Ge,{columnsData:pn,tableData:V||[],loading:N,onSort:j,sortField:l,ascending:i,fetchData:A}),e.jsx(Oe,{currentPage:d,totalPages:W,totalRows:Y,onPageChange:F,pageSize:h,onPageSizeChange:R})]})})}const io=()=>{var C;const{id:t}=lt(),[n,o]=r.useState([]),[a,s]=r.useState(null),[l,p]=r.useState(null),[i,g]=r.useState({}),d=we(),m=Q(),[h,f]=r.useState(!1),{colorMode:c}=ce(),v=c==="light"?"black":"white",b=c==="light"?"white":"whiteAlpha.300",x=r.useCallback(async()=>{try{const S=await nt({controller:"Topic",id:t});s(S),g(S)}catch{m({title:"Đã xảy ra lỗi.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}},[t,m]),y=async()=>{try{const S=await X({controller:"Course",page:1,pageSize:10});o(S.data)}catch(S){console.error("Lỗi khi lấy danh mục khóa học:",S),o([])}};r.useEffect(()=>{t&&(x(),y())},[t,x]);const D=S=>{p(S)},u=(S,j)=>{g(F=>{const R={...F,[S]:j};return s(_=>({..._,[S]:j})),R})},z=async()=>{f(!0);try{const S=new FormData;Object.keys(i).forEach(j=>{j!=="TopicID"&&S.append(j,i[j])}),s(j=>({...j,...i})),await He({controller:"Topic",id:t,data:S}),await x(),p(null),m({title:"Cập nhật thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),f(!1)}catch(S){console.error("Đã xảy ra lỗi khi cập nhật",S),m({title:"Đã xảy ra lỗi khi cập nhật.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),f(!1)}};return a?e.jsx(me,{children:e.jsx(E,{pt:{base:"130px",md:"80px",xl:"80px"},px:"25px",children:e.jsxs(E,{bg:b,p:{base:"4",md:"6"},borderRadius:"lg",boxShadow:"lg",maxW:"1000px",w:"100%",mx:"auto",children:[e.jsx(L,{justifyContent:"end",align:"end",px:{base:"10px",md:"25px"},children:e.jsx(et,{children:e.jsxs(H,{onClick:()=>d("/admin/topic"),variant:"solid",size:"lg",colorScheme:"teal",borderRadius:"xl",px:5,boxShadow:"lg",bgGradient:"linear(to-l, messenger.500, navy.300)",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},children:[e.jsx(mt,{})," Quay lại"]})})}),e.jsxs(le,{spacing:6,align:"stretch",mt:4,children:[e.jsx(ue,{}),e.jsxs(xe,{templateColumns:{base:"1fr",md:"repeat(2, 1fr)"},gap:6,children:[e.jsxs(ne,{borderRightWidth:2,children:[e.jsx(I,{align:"center",fontSize:25,mb:5,fontWeight:"bold",children:"Thông tin chủ đề"}),e.jsxs(le,{align:"stretch",ps:{base:"0",md:"20px"},spacing:4,children:[["topicName"].map(S=>e.jsxs(L,{align:"center",children:[l===S?e.jsx(oe,{textColor:v,value:i[S]||"",onChange:j=>u(S,j.target.value),placeholder:`Chỉnh sửa ${S}`,onBlur:()=>p(null),autoFocus:!0}):e.jsxs(I,{fontSize:"lg",textColor:v,children:[e.jsxs("strong",{children:[S==="topicName"?"Tên chủ đề":S==="fee"?"Giá tiền":"Giá tiền gốc",":"]})," ",S==="fee"||S==="originalFee"?Vt(a[S]):a[S]||"Chưa có thông tin"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>D(S),cursor:"pointer"})]},S)),e.jsxs(L,{align:"center",children:[l==="course"?e.jsx(U,{value:i.courseID||"",onBlur:()=>p(null),autoFocus:!0,onChange:S=>u("courseID",S.target.value),placeholder:"Chọn loại khóa học",width:{base:"100%",md:"50%"},children:n.map(S=>e.jsx("option",{value:S.courseID,children:S.courseName},S.courseID))}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Chọn khóa học:"})," ",((C=n.find(S=>S.courseID===Number(a.courseID)))==null?void 0:C.courseName)||"Chưa chọn"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>D("course"),cursor:"pointer"})]}),e.jsxs(L,{align:"center",children:[l==="topicDescription"?e.jsx(oe,{value:i.topicDescription||"",onChange:S=>u("topicDescription",S.target.value),placeholder:"Chỉnh sửa mô tả",onBlur:()=>p(null),autoFocus:!0,textColor:v}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Mô tả:"})," ",a.topicDescription||"Chưa có thông tin"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>D("topicDescription"),cursor:"pointer"})]})]})]}),e.jsxs(ne,{children:[e.jsx(I,{align:"center",fontSize:25,mb:5,fontWeight:"bold",children:"Thông tin khác"}),e.jsxs(le,{align:"stretch",ps:{base:"0",md:"20px"},spacing:4,children:[e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Ngày tạo: "}),ze(a.createdAt)]}),a.updatedAt&&e.jsx(e.Fragment,{children:e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Ngày cập nhật: "}),ze(a.updatedAt)]})})]})]})]})]}),e.jsx(L,{justifyContent:"flex-end",mt:6,children:e.jsx(H,{variant:"solid",size:"lg",colorScheme:"teal",borderRadius:"xl",px:10,boxShadow:"lg",bgGradient:"linear(to-l, green.500, green.300)",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},onClick:z,isLoading:h,loadingText:"Đang lưu...",children:"Lưu"})})]})})}):e.jsx(bt,{})};function lo({isOpen:t,onClose:n,fetchData:o}){const[a,s]=r.useState({topicID:"",topicName:"",lessonTitle:"",lessonContent:"",order:1,status:0}),[l,p]=r.useState([]),[i,g]=r.useState({}),d=Q(),[m,h]=r.useState(!1),{colorMode:f}=ce(),c=f==="light"?"black":"white",v=f==="light"?"gray.100":"whiteAlpha.100",b=r.useRef(null);r.useEffect(()=>{t&&(s({topicID:"",topicName:"",lessonTitle:"",lessonContent:"",order:1,status:0}),g({}),x())},[t]);const x=async()=>{try{const C=await X({controller:"Topic",page:1,pageSize:10});p(C.data)}catch(C){console.error("Lỗi khi lấy chủ đề:",C),p([])}},y=C=>{const{name:S,value:j}=C.target;s(F=>({...F,[S]:S==="status"?parseInt(j,10):j}))},D=C=>{s(S=>({...S,lessonContent:C}))},u=()=>{let C={};return a.lessonTitle||(C.lessonTitle="Tên bài học không được bỏ trống"),a.topicID||(C.topicID="Vui lòng chọn chủ đề"),g(C),Object.keys(C).length===0},z=async()=>{if(u()){h(!0);try{await st({controller:"Lesson",data:a}),d({title:"Thêm mới bài học thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),o&&await o(),n()}catch(C){let S="Đã xảy ra lỗi. Vui lòng thử lại.";C.response&&C.response.data?S=C.response.data.message||"Lỗi không xác định từ server.":C.message&&(S=C.message),d({title:"Đã xảy ra lỗi.",description:S,status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}finally{h(!1)}}};return e.jsxs(je,{size:"5xl",isOpen:t,onClose:n,scrollBehavior:"inside",children:[e.jsx(de,{}),e.jsxs(fe,{children:[e.jsx(ve,{fontSize:"25px",textAlign:"center",children:"Thêm mới bài học"}),e.jsx(ye,{}),e.jsxs(he,{children:[e.jsxs(xe,{templateColumns:"3fr 1fr",gap:4,children:[e.jsxs(E,{flex:1,children:[e.jsxs(M,{isInvalid:i.lessonTitle,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Tiêu đề bài học",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{bg:v,placeholder:"Nhập tiêu đề bài học",name:"lessonTitle",value:a.lessonTitle,onChange:y,textColor:c}),e.jsx(q,{children:i.lessonTitle})]}),e.jsxs(M,{isInvalid:i.topicID,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Chọn chủ đề",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsxs(U,{bg:v,name:"topicID",value:a.topicID,onChange:y,textColor:c,children:[e.jsx("option",{value:"",children:"Chọn chủ đề"},"0"),l.map(C=>e.jsx("option",{value:C.topicID,children:C.topicName},C.topicID))]}),e.jsx(q,{children:i.topicID})]})]}),e.jsxs(E,{children:[e.jsxs(M,{isInvalid:!!i.order,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Thứ tự ",e.jsx(I,{as:"span",color:"red.500",children:"*"})]}),e.jsxs(U,{bg:v,name:"order",placeholder:"Chọn thứ tự",value:a.order,onChange:y,textColor:c,children:[e.jsx("option",{value:"1",children:"1"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"})]}),e.jsx(q,{children:i.order})]}),e.jsxs(M,{isInvalid:i.status,children:[e.jsx(B,{fontWeight:"bold",children:"Trạng thái"}),e.jsxs(U,{bg:v,name:"status",value:a.status,onChange:y,textColor:c,children:[e.jsx("option",{value:"",children:"Chọn trạng thái"},"default"),e.jsx("option",{value:"1",children:"Online"},"online"),e.jsx("option",{value:"0",children:"Offline"},"offline")]})]})]})]}),e.jsxs(M,{mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Nội dung bài học"}),e.jsx(Ae,{ref:b,value:a.lessonContent,config:Me,onChange:D,onBlur:C=>D(C)},a.lessonID)]})]}),e.jsxs(De,{children:[e.jsx(H,{colorScheme:"gray",mr:3,onClick:n,children:"Hủy"}),e.jsx(H,{colorScheme:"green",isLoading:m,loadingText:"Đang lưu...",onClick:z,children:"Thêm"})]})]})]})}const gn=[{Header:"STT",accessor:"stt",Cell:({rowIndex:t})=>t+1},{Header:"Tên bài học",accessor:"lessonTitle",sortable:!0},{Header:"Tên chủ đề",accessor:"topicName"},{Header:"Cấp",accessor:"order"},{Header:"Trạng thái",accessor:"status",Cell:({row:t})=>{const[n,o]=r.useState(t==null?void 0:t.status),a=t==null?void 0:t.lessonID,s=Q(),l=ct({mutationFn:i=>{if(!a){console.error("Lỗi: Không có lessonID");return}return Ot({controller:"Lesson",id:a,newStatus:i})},onSuccess:()=>{s({title:"Cập nhật thành công",description:"Cập nhật trạng thái thành công",status:"success",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"})},onError:i=>{console.error("Lỗi cập nhật trạng thái:",i),o(n),s({title:"Cập nhật thất bại",description:"Không thể cập nhật trạng thái, vui lòng thử lại.",status:"error",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"})}}),p=()=>{const i=n===0?1:0;o(i),l.mutate(i)};return e.jsx(Ke,{bg:n===1?"green.400":"red.400",fontSize:"sm",textColor:"white",cursor:"pointer",onClick:p,children:n===1?"Online":"Offline"})}},{Header:"Hành động",accessor:"action",Cell:t=>e.jsx(qe,{...t,controller:"Lesson",deleteFunction:$e,idData:"lessonID",detailPath:"lesson",deleteSuccessToast:{title:"Đã xóa!",description:"Khóa học đã được xóa thành công."},deleteErrorToast:{title:"Xóa thất bại!",description:"Vui lòng thử lại sau."},fetchData:t.fetchData})}];function co(){_e("Quản lý bài học");const t=Q(),{isOpen:n,onOpen:o,onClose:a}=ie(),s=We(),[l,p]=r.useState("name"),[i,g]=r.useState(!0),[d,m]=r.useState(1),[h,f]=r.useState(10),[c,v]=r.useState(""),b=Qe(c,600),x=k=>typeof k=="string"&&k.trim()!=="",y=["lessons",d,h,i,l],D=["lessonsSearch",b,d,h],{data:u,isLoading:z}=pe({queryKey:y,queryFn:()=>X({controller:"Lesson",page:d,pageSize:h,ascending:i}),enabled:!x(b),keepPreviousData:!0,staleTime:6e4,retry:1,onError:()=>{t({title:"Lỗi khi tải dữ liệu",description:"Không thể tải dữ liệu. Vui lòng thử lại sau.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}}),{data:C,isLoading:S}=pe({queryKey:D,queryFn:()=>ge({controller:"Lesson",keyword:b,page:d,pageSize:h}),enabled:x(b),keepPreviousData:!0,staleTime:6e4,retry:1,onError:()=>{t({title:"Lỗi khi tìm kiếm",description:"Không thể tìm kiếm. Vui lòng thử lại sau.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}});r.useEffect(()=>{const k=x(b)?C:u;if(k!=null&&k.totalPages&&d<k.totalPages){const T=d+1;x(b)?s.prefetchQuery({queryKey:["lessonsSearch",b,T,h],queryFn:()=>ge({controller:"Lesson",keyword:b,page:T,pageSize:h}),staleTime:6e4,retry:1}):s.prefetchQuery({queryKey:["lessons",T,h,i,l],queryFn:()=>X({controller:"Lesson",page:T,pageSize:h,ascending:i}),staleTime:6e4,retry:1})}},[b,C,u,d,h,i,l,s]);const j=k=>{l===k?g(!i):(p(k),g(!0)),m(1)},F=k=>{const T=x(b)?(C==null?void 0:C.totalPages)||0:(u==null?void 0:u.totalPages)||0;k>0&&k<=T&&m(k)},R=k=>{const T=parseInt(k,10);T!==h&&(f(T),m(1))},_=k=>{v(k),m(1)},A=()=>{s.invalidateQueries({queryKey:["lessons"]}),s.invalidateQueries({queryKey:["lessonsSearch"]})},V=x(b)?C==null?void 0:C.data:u==null?void 0:u.data,W=x(b)?(C==null?void 0:C.totalPages)||0:(u==null?void 0:u.totalPages)||0,Y=x(b)?(C==null?void 0:C.totalCount)||0:(u==null?void 0:u.totalCount)||0,N=x(b)?S:z;return e.jsx(me,{children:e.jsxs(E,{pt:{base:"130px",md:"80px",xl:"80px"},children:[e.jsx(Ve,{onAdd:o,onSearch:_,valueSearch:c,title:gn}),e.jsx(lo,{isOpen:n,onClose:a,fetchData:A}),e.jsx(Ge,{columnsData:gn,tableData:V||[],loading:N,onSort:j,sortField:l,ascending:i,fetchData:A}),e.jsx(Oe,{currentPage:d,totalPages:W,totalRows:Y,onPageChange:F,pageSize:h,onPageSizeChange:R})]})})}const ho=()=>{var S;const{id:t}=lt(),n=r.useRef(null),[o,a]=r.useState([]),[s,l]=r.useState(null),[p,i]=r.useState(null),[g,d]=r.useState({}),m=we(),h=Q(),[f,c]=r.useState(!1),{colorMode:v}=ce(),b=v==="light"?"black":"white",x=v==="light"?"white":"whiteAlpha.300",y=r.useCallback(async()=>{try{const j=await nt({controller:"Lesson",id:t});l(j),d(j)}catch(j){console.log("Lỗi:",j),h({title:"Đã xảy ra lỗi.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}},[t,h]),D=async()=>{try{const j=await X({controller:"Topic",page:1,pageSize:10});a(j.data)}catch(j){console.error("Lỗi khi lấy danh mục khóa học:",j),a([])}};r.useEffect(()=>{t&&(y(),D())},[t,y]);const u=j=>{i(j)},z=(j,F)=>{console.log(`Thay đổi trường ${j}:`,F),d(R=>{const _={...R,[j]:F};return l(A=>({...A,[j]:F})),_})},C=async()=>{c(!0);try{const j=new FormData;Object.keys(g).forEach(F=>{F!=="LessonID"&&j.append(F,g[F])}),l(F=>({...F,...g})),await He({controller:"Lesson",id:t,data:j}),await y(),i(null),h({title:"Cập nhật thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),c(!1)}catch(j){console.error("Đã xảy ra lỗi khi cập nhật",j),h({title:"Đã xảy ra lỗi khi cập nhật.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),c(!1)}};return s?e.jsx(me,{children:e.jsx(E,{pt:{base:"130px",md:"80px",xl:"80px"},px:"25px",children:e.jsxs(E,{bg:x,p:{base:"4",md:"6"},borderRadius:"lg",boxShadow:"lg",maxW:"1000px",w:"100%",mx:"auto",children:[e.jsx(L,{justifyContent:"end",align:"end",px:{base:"10px",md:"25px"},children:e.jsx(et,{children:e.jsxs(H,{onClick:()=>m("/admin/lesson"),variant:"solid",size:"lg",colorScheme:"teal",borderRadius:"xl",px:5,boxShadow:"lg",bgGradient:"linear(to-l, messenger.500, navy.300)",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},children:[e.jsx(mt,{})," Quay lại"]})})}),e.jsxs(le,{spacing:6,align:"stretch",mt:4,children:[e.jsx(ue,{}),e.jsxs(xe,{templateColumns:{base:"1fr",md:"repeat(2, 1fr)"},gap:6,children:[e.jsxs(ne,{borderRightWidth:2,children:[e.jsx(I,{align:"center",fontSize:25,mb:5,fontWeight:"bold",children:"Thông tin bài học"}),e.jsxs(le,{align:"stretch",ps:{base:"0",md:"20px"},spacing:4,children:[["lessonTitle"].map(j=>e.jsxs(L,{align:"center",children:[p===j?e.jsx(oe,{textColor:b,value:g[j]||"",onChange:F=>z(j,F.target.value),placeholder:`Chỉnh sửa ${j}`,onBlur:()=>i(null),autoFocus:!0}):e.jsxs(I,{fontSize:"lg",textColor:b,children:[e.jsxs("strong",{children:[j==="lessonTitle"?"Tên bài học":j==="fee"?"Giá tiền":"Giá tiền gốc",":"]})," ",j==="fee"||j==="originalFee"?Vt(s[j]):s[j]||"Chưa có thông tin"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>u(j),cursor:"pointer"})]},j)),e.jsxs(L,{align:"center",children:[p==="topic"?e.jsx(U,{value:g.topicID||"",onBlur:()=>i(null),autoFocus:!0,onChange:j=>z("topicID",j.target.value),placeholder:"Chọn chủ đề",width:"100%",children:o.map(j=>e.jsx("option",{value:j.topicID,children:j.topicName},j.topicID))}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Chọn chủ đề:"})," ",((S=o.find(j=>j.topicID===Number(g.topicID)))==null?void 0:S.topicName)||"Chưa chọn"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>u("topic"),cursor:"pointer"})]})]})]}),e.jsxs(ne,{children:[e.jsx(I,{align:"center",fontSize:25,mb:5,fontWeight:"bold",children:"Thông tin khác"}),e.jsxs(le,{align:"stretch",ps:{base:"0",md:"20px"},spacing:4,children:[e.jsxs(L,{align:"center",children:[p==="order"?e.jsxs(U,{value:g.order||"",onBlur:()=>i(null),autoFocus:!0,onChange:j=>z("order",j.target.value),placeholder:"Chọn cấp",width:{base:"100%",md:"50%"},children:[e.jsx("option",{value:"1",children:"1"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"})]}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Chọn cấp:"})," ",s.order||"0"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>u("order"),cursor:"pointer"})]}),e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Ngày tạo: "}),ze(s.createdAt)]}),s.updatedAt&&e.jsx(e.Fragment,{children:e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Ngày cập nhật: "}),ze(s.updatedAt)]})})]})]})]}),e.jsx(E,{width:"100%",borderTopWidth:2,pt:5,px:5,children:e.jsxs(L,{align:"center",children:[p==="lessonContent"?e.jsx(E,{width:"100%",overflowY:"auto",maxHeight:"500px",children:e.jsx(Ae,{ref:n,value:g.lessonContent,config:Me,onChange:j=>z("lessonContent",j),autoFocus:!0})}):e.jsx(E,{width:"max-content",children:e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Nội dung bài học:"}),e.jsx(E,{overflowY:"auto",maxHeight:"300px",sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:at(s==null?void 0:s.lessonContent)}})]})}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>u("lessonContent"),cursor:"pointer"})]})})]}),e.jsx(L,{justifyContent:"flex-end",mt:6,children:e.jsx(H,{variant:"solid",size:"lg",colorScheme:"teal",borderRadius:"xl",px:10,boxShadow:"lg",bgGradient:"linear(to-l, green.500, green.300)",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},onClick:C,isLoading:f,loadingText:"Đang lưu...",children:"Lưu"})})]})})}):e.jsx(bt,{})},uo={toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link","image"],["clean"]]},po=["header","bold","italic","underline","strike","list","bullet","link","image"];function go({isOpen:t,onClose:n,fetchData:o}){const[a,s]=r.useState({problemCode:"",problemName:"",coderId:1,timeLimit:"1.00",memoryLimit:"128",testType:"Output Matching",testCompilerID:"",note:"",selectedCategoryIDs:[],testCode:"",problemContent:"",problemExplanation:"",selectedLessonID:"",published:0}),[l,p]=r.useState([]),[i,g]=r.useState([]),[d,m]=r.useState([]),[h,f]=r.useState({}),c=Q(),[v,b]=r.useState(!1),{colorMode:x}=ce(),y=x==="light"?"black":"white",D=x==="light"?"gray.100":"whiteAlpha.100",[u,z]=r.useState("vs-dark"),[C,S]=r.useState("cpp");r.useEffect(()=>{t&&(s({problemCode:"",coderId:1,problemName:"",timeLimit:"1.00",memoryLimit:"128",testType:"Output Matching",testCompilerID:"",selectedLessonID:"",note:"",selectedCategoryIDs:[],testCode:"",problemContent:"",problemExplanation:"",published:0}),f({}),j())},[t]);const j=async()=>{try{const N=await X({controller:"Category",page:1,pageSize:10}),k=await X({controller:"Compiler",page:1,pageSize:10}),T=await X({controller:"Lesson",page:1,pageSize:10});m(T.data),p(N.data),g(k.data),k.data.length>0&&s(w=>({...w,testCompilerID:k.data[0].compilerID}))}catch(N){console.error("Lỗi khi lấy danh mục bài toán:",N),p([]),g([]),m([])}},F=(N,k)=>{s(T=>({...T,selectedCategoryIDs:N.target.checked?[...new Set([...T.selectedCategoryIDs,k])]:T.selectedCategoryIDs.filter(w=>w!==k)}))},R=(N,k)=>{s(T=>({...T,[N]:k}))},_=N=>{const{name:k,value:T}=N.target;s(w=>({...w,[k]:k==="published"?parseInt(T,10):T}))},A=()=>{let N={};return a.problemName||(N.problemName="Tên bài toán không được bỏ trống"),a.problemCode||(N.problemCode="Mã bài toán không được bỏ trống"),a.selectedCategoryIDs.length===0&&(N.selectedCategoryIDs="Vui lòng chọn thể loại"),a.testCompilerID||(N.testCompilerID="Vui lòng chọn biên dịch viên"),f(N),Object.keys(N).length===0},V=async()=>{if(!A())return;b(!0);const N={coderId:a.coderId,problemCode:a.problemCode,problemName:a.problemName,timeLimit:a.timeLimit,memoryLimit:a.memoryLimit,testType:a.testType,testCompilerID:a.testCompilerID,note:a.note,testCode:a.testCode,problemContent:a.problemContent,problemExplanation:a.problemExplanation,selectedCategoryIDs:a.selectedCategoryIDs,selectedLessonID:a.selectedLessonID,published:a.published};try{await st({controller:"Problem",data:N}),c({title:"Thêm mới bài toán thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),o&&await o(),n()}catch(k){c({title:"Đã xảy ra lỗi.",description:k.message||"Có lỗi xảy ra khi tạo bài toán.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}finally{b(!1)}},W=i.find(N=>N.compilerID===Number(C)),Y=Mn((W==null?void 0:W.compilerExtension)||"");return e.jsxs(je,{size:"full",isOpen:t,onClose:n,scrollBehavior:"inside",children:[e.jsx(de,{}),e.jsxs(fe,{children:[e.jsx(ve,{fontSize:"25px",textAlign:"center",children:"Thêm mới bài toán"}),e.jsx(ye,{}),e.jsx(he,{children:e.jsxs(xe,{templateColumns:"1fr 500px",gap:"6",children:[e.jsxs(ne,{children:[e.jsxs(M,{isInvalid:h.problemCode,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Mã bài toán",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{bg:D,placeholder:"Nhập mã bài toán",name:"problemCode",value:a.problemCode,onChange:_,textColor:y}),e.jsx(q,{children:h.problemCode})]}),e.jsxs(M,{isInvalid:h.problemName,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Tên bài toán",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{bg:D,placeholder:"Nhập tên bài toán",name:"problemName",value:a.problemName,onChange:_,textColor:y}),e.jsx(q,{children:h.problemName})]}),e.jsxs(M,{isInvalid:h.problemContent,mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Nội dung bài toán"}),e.jsx(E,{maxH:"600px",overflowY:"auto",children:e.jsx(Ds,{modules:uo,formats:po,theme:"snow",placeholder:"Chia sẻ cảm nghĩ của bạn hoặc thêm hình ảnh vào nội dung...",value:a.problemContent,onChange:N=>R("problemContent",N)},a.problemID+"-content")}),e.jsx(q,{children:h.problemContent})]}),e.jsxs(M,{mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Code mẫu"}),e.jsxs(L,{gap:20,direction:"row",children:[e.jsxs(U,{mb:4,value:C,onChange:N=>S(N.target.value),children:[e.jsx("option",{defaultValue:"none",disabled:!0,children:"Chọn ngôn ngữ"}),i.map(N=>e.jsx("option",{value:N.compilerID,children:N.compilerName},N.compilerID))]}),e.jsxs(U,{mb:4,value:u,onChange:N=>z(N.target.value),children:[e.jsx("option",{defaultValue:"none",disabled:!0,children:"Chọn giao diện"}),e.jsx("option",{value:"vs-dark",children:"Tối"}),e.jsx("option",{value:"vs-light",children:"Sáng"})]})]}),e.jsx(E,{border:"1px solid",borderColor:"gray.600",borderRadius:"md",mb:4,children:e.jsx(Tn,{height:"400px",theme:u,language:Y,value:a.testCode,onChange:N=>R("testCode",N||""),onBlur:N=>R("testCode",N||""),options:{fontSize:14,minimap:{enabled:!1},suggestOnTriggerCharacters:!0,quickSuggestions:{other:!0,comments:!0,strings:!0},wordBasedSuggestions:!0,parameterHints:{enabled:!0},tabCompletion:"on"}})})]})]}),e.jsx(ne,{children:e.jsxs(E,{position:"sticky",top:"0",maxH:"100vh",overflowY:"auto",children:[e.jsxs(M,{isInvalid:h.selectedCategoryIDs,mb:4,children:[e.jsxs(B,{fontWeight:"bold",children:["Thể loại",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(Mt,{columns:2,spacing:2,w:"full",children:l.map(N=>e.jsx(yt,{isChecked:a.selectedCategoryIDs.includes(N.categoryID),onChange:k=>F(k,N.categoryID),children:N.catName},N.categoryID))}),e.jsx(q,{children:h.selectedCategoryIDs})]}),e.jsxs(M,{mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Trình biên dịch"}),e.jsx(U,{value:a.testCompilerID,name:"testCompilerID",onChange:_,children:i.map(N=>e.jsx("option",{value:N.compilerID,children:N.compilerName},N.compilerID))})]}),e.jsxs(M,{mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Chọn bài học"}),e.jsxs(U,{value:a.selectedLessonID,name:"selectedLessonID",onChange:_,children:[e.jsx("option",{value:"",disabled:!0,children:"-- Chọn bài học --"}),d.map(N=>e.jsx("option",{value:N.lessonID,children:N.lessonTitle},N.lessonID))]})]}),e.jsxs(M,{isInvalid:h.timeLimit,mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Giới hạn thời gian"}),e.jsx(te,{bg:D,type:"number",placeholder:"Nhập giới hạn thời gian",name:"timeLimit",value:a.timeLimit,onChange:_,textColor:y}),e.jsx(q,{children:h.timeLimit})]}),e.jsxs(M,{isInvalid:h.memoryLimit,mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Giới hạn bộ nhớ"}),e.jsx(te,{bg:D,type:"number",placeholder:"Nhập giới hạn bộ nhớ",name:"memoryLimit",value:a.memoryLimit,onChange:_,textColor:y}),e.jsx(q,{children:h.memoryLimit})]}),e.jsxs(M,{mb:4,children:[e.jsx(B,{fontWeight:"bold",children:"Loại bài kiểm tra"}),e.jsxs(U,{bg:D,name:"testType",value:a.testType,onChange:_,textColor:y,children:[e.jsx("option",{value:"Output Matching",children:"Output Matching"},"outputMatching"),e.jsx("option",{value:"Custom",children:"Custom"},"custom")]})]}),e.jsxs(M,{children:[e.jsx(B,{fontWeight:"bold",children:"Trạng thái"}),e.jsxs(U,{bg:D,name:"published",value:a.published,onChange:_,textColor:y,children:[e.jsx("option",{value:"",disabled:!0,children:"Chọn trạng thái"},"default"),e.jsx("option",{value:"1",children:"Online"},"online"),e.jsx("option",{value:"0",children:"Offline"},"offline")]})]})]})})]})}),e.jsxs(De,{children:[e.jsx(H,{colorScheme:"gray",mr:3,onClick:n,children:"Hủy"}),e.jsx(H,{colorScheme:"green",isLoading:v,loadingText:"Đang lưu...",onClick:V,children:"Thêm"})]})]})]})}const xo=({problemId:t})=>{const[n,o]=r.useState(null);return r.useEffect(()=>{(async()=>{try{const s=await J.get("/TestCase/count",{params:{problemId:t}});o(s.data.totalTestCases)}catch{o("Lỗi")}})()},[t]),e.jsx(Ie,{label:"Xem chi tiết",placement:"top",hasArrow:!0,children:e.jsx(et,{as:Dn,to:`/admin/testcase/${t}`,children:e.jsx(I,{align:"center",color:"blue",children:n})})})},xn=[{Header:"STT",accessor:"stt",Cell:({rowIndex:t})=>t+1},{Header:"Mã bài tập",accessor:"problemCode"},{Header:"Tên bài tập",accessor:"problemName",sortable:!0},{Header:"Nội dung bài tập",accessor:"problemContent"},{Header:"Testcase",accessor:"testCase",Cell:({row:t})=>e.jsx(xo,{problemId:t==null?void 0:t.problemID})},{Header:"Trạng thái",accessor:"published",Cell:({row:t})=>{const[n,o]=r.useState(t==null?void 0:t.published),a=t==null?void 0:t.problemID,s=Q(),l=ct({mutationFn:i=>{if(!a){console.error("Lỗi: Không có problemId");return}return J.put(`/Problem/${a}`,{published:i})},onSuccess:()=>{s({title:"Cập nhật thành công",description:"Cập nhật trạng thái thành công",status:"success",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"})},onError:i=>{console.error("Lỗi cập nhật trạng thái:",i),o(n),s({title:"Cập nhật thất bại",description:"Không thể cập nhật trạng thái, vui lòng thử lại.",status:"error",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"})}}),p=()=>{const i=n===0?1:0;o(i),l.mutate(i)};return e.jsx(Ke,{bg:n===1?"green.400":"red.400",fontSize:"sm",textColor:"white",cursor:"pointer",onClick:p,children:n===1?"Online":"Offline"})}},{Header:"Hành động",accessor:"action",Cell:t=>e.jsx(qe,{...t,controller:"Problem",deleteFunction:$e,idData:"problemID",detailPath:"problem",deleteSuccessToast:{title:"Đã xóa!",description:"Bài học đã được xóa thành công."},deleteErrorToast:{title:"Xóa thất bại!",description:"Vui lòng thử lại sau."},fetchData:t.fetchData})}];function mo(){_e("Quản lý bài tập");const t=Q(),{isOpen:n,onOpen:o,onClose:a}=ie(),s=We(),[l,p]=r.useState("name"),[i,g]=r.useState(!0),[d,m]=r.useState(1),[h,f]=r.useState(10),[c,v]=r.useState(""),b=Qe(c,600),x=k=>typeof k=="string"&&k.trim()!=="",y=["problems",d,h,i,l],D=["problemsSearch",b,d,h],{data:u,isLoading:z}=pe({queryKey:y,queryFn:()=>X({controller:"Problem",page:d,pageSize:h,ascending:i}),enabled:!x(b),keepPreviousData:!0,staleTime:6e4,retry:1,onError:()=>{t({title:"Lỗi khi tải dữ liệu",description:"Không thể tải dữ liệu. Vui lòng thử lại sau.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}}),{data:C,isLoading:S}=pe({queryKey:D,queryFn:()=>ge({controller:"Problem",keyword:b,page:d,pageSize:h}),enabled:x(b),keepPreviousData:!0,staleTime:6e4,retry:1,onError:()=>{t({title:"Lỗi khi tìm kiếm",description:"Không thể tìm kiếm. Vui lòng thử lại sau.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}});r.useEffect(()=>{const k=x(b)?C:u;if(k!=null&&k.totalPages&&d<k.totalPages){const T=d+1;x(b)?s.prefetchQuery({queryKey:["problemsSearch",b,T,h],queryFn:()=>ge({controller:"Problem",keyword:b,page:T,pageSize:h}),staleTime:6e4,retry:1}):s.prefetchQuery({queryKey:["problems",T,h,i,l],queryFn:()=>X({controller:"Problem",page:T,pageSize:h,ascending:i}),staleTime:6e4,retry:1})}},[b,C,u,d,h,i,l,s]);const j=k=>{l===k?g(!i):(p(k),g(!0)),m(1)},F=k=>{const T=x(b)?(C==null?void 0:C.totalPages)||0:(u==null?void 0:u.totalPages)||0;k>0&&k<=T&&m(k)},R=k=>{const T=parseInt(k,10);T!==h&&(f(T),m(1))},_=k=>{v(k),m(1)},A=()=>{s.invalidateQueries({queryKey:["problems"]}),s.invalidateQueries({queryKey:["problemsSearch"]})},V=x(b)?C==null?void 0:C.data:u==null?void 0:u.data,W=x(b)?(C==null?void 0:C.totalPages)||0:(u==null?void 0:u.totalPages)||0,Y=x(b)?(C==null?void 0:C.totalCount)||0:(u==null?void 0:u.totalCount)||0,N=x(b)?S:z;return e.jsx(me,{children:e.jsxs(E,{pt:{base:"130px",md:"80px",xl:"80px"},children:[e.jsx(Ve,{onAdd:o,onSearch:_,valueSearch:c,title:xn}),e.jsx(go,{isOpen:n,onClose:a,fetchData:A}),e.jsx(Ge,{columnsData:xn,tableData:V||[],loading:N,onSort:j,sortField:l,ascending:i,fetchData:A}),e.jsx(Oe,{currentPage:d,totalPages:W,totalRows:Y,onPageChange:F,pageSize:h,onPageSizeChange:R})]})})}const bo=()=>{var N,k,T;const{id:t}=lt(),n=r.useRef(null),o=we(),a=Q(),[s,l]=r.useState(!1),{colorMode:p}=ce(),i=p==="light"?"black":"white",g=p==="light"?"white":"whiteAlpha.300",[d,m]=r.useState(null),[h,f]=r.useState([]),[c,v]=r.useState([]),[b,x]=r.useState(null),[y,D]=r.useState({}),u={"Output Matching":"Output Matching","Validate Output":"Validate Output"},[z,C]=r.useState([]),[S,j]=r.useState(""),F=r.useCallback(async()=>{try{const w=await nt({controller:"Problem",id:t});m({...w,selectedCategoryIDs:w.selectedCategoryIDs||[],selectedCategoryNames:w.selectedCategoryNames||[]}),D({...w,selectedCategoryIDs:w.selectedCategoryIDs||[]})}catch{a({title:"Đã xảy ra lỗi.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}},[t,a]),R=async()=>{try{const w=await X({controller:"Compiler",page:1,pageSize:10}),O=await X({controller:"Category",page:1,pageSize:10}),ae=await X({controller:"Lesson",page:1,pageSize:10});v(ae.data),f(O.data);const Ne=w.data;if(C(Ne),Ne.length>0){const ke=Ne[0];j(ke)}}catch(w){console.error("Lỗi khi lấy danh mục khóa học:",w),f([]),C([]),v([])}};r.useEffect(()=>{t&&(F(),R())},[t,F]);const _=w=>{w==="selectedCategory"&&D(O=>({...O,selectedCategoryIDs:d.selectedCategoryIDs||[]})),x(w)},A=(w,O)=>{D(ae=>{const Ne={...ae,[w]:O};return m(ke=>({...ke,[w]:O})),Ne})},V=async()=>{l(!0);try{const w=new FormData;Object.keys(y).forEach(O=>{O==="selectedCategoryIDs"?y.selectedCategoryIDs.forEach(ae=>{w.append("SelectedCategoryIDs",ae)}):O!=="ProblemID"&&w.append(O,y[O])}),m(O=>({...O,...y})),await He({controller:"Problem",id:t,data:w}),await F(),x(null),a({title:"Cập nhật thành công!",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),l(!1)}catch(w){console.error("Đã xảy ra lỗi khi cập nhật",w),a({title:"Đã xảy ra lỗi khi cập nhật.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"}),l(!1)}},W=z.find(w=>w.compilerID===Number(S)),Y=Mn((W==null?void 0:W.compilerExtension)||"");return d?e.jsx(me,{children:e.jsx(E,{pt:{base:"130px",md:"80px",xl:"80px"},px:"10px",children:e.jsxs(E,{bg:g,p:{base:"4",md:"6"},borderRadius:"lg",boxShadow:"lg",w:"100%",maxW:"1000vh",mx:"auto",children:[e.jsx(L,{justifyContent:"end",align:"end",px:{base:"10px",md:"25px"},children:e.jsx(et,{children:e.jsxs(H,{onClick:()=>o("/admin/problem"),variant:"solid",size:"lg",colorScheme:"teal",borderRadius:"xl",px:5,boxShadow:"lg",bgGradient:"linear(to-l, messenger.500, navy.300)",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},children:[e.jsx(mt,{})," Quay lại"]})})}),e.jsx(le,{spacing:6,align:"stretch",mt:4,children:e.jsxs(xe,{templateColumns:{base:"1fr",md:"repeat(2, 1fr)"},gap:6,children:[e.jsx(ne,{children:e.jsxs(le,{align:"stretch",spacing:4,children:[["problemCode","problemName","timeLimit","memoryLimit"].map(w=>e.jsxs(L,{align:"center",children:[b===w?e.jsx(oe,{type:w==="timeLimit"||w==="memoryLimit"?"number":"text",textColor:i,value:y[w]||"",onChange:O=>A(w,O.target.value),placeholder:`Chỉnh sửa ${w}`,onBlur:()=>x(null),autoFocus:!0}):e.jsxs(I,{fontSize:"lg",children:[e.jsxs("strong",{children:[w==="problemCode"?"Mã bài tập":w==="problemName"?"Tên bài tập":w==="timeLimit"?"Thời gian giới hạn":"Bộ nhớ giới hạn",":"]})," ",d[w]||"Chưa có thông tin"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>_(w),cursor:"pointer"})]},w)),e.jsxs(L,{align:"center",children:[e.jsx(I,{fontSize:"lg",fontWeight:"bold",children:"Nội dung:"}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>_("problemContent"),cursor:"pointer"})]}),b==="problemContent"?e.jsx(Ae,{ref:n,value:y.problemContent,config:Me,onChange:w=>A("problemContent",w),autoFocus:!0,style:{width:"100%",minHeight:"300px"}}):e.jsx(E,{overflowY:"auto",maxHeight:"300px",bg:"gray.200",borderRadius:"md",p:2,sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:at(d==null?void 0:d.problemContent)}}),e.jsxs(L,{align:"center",children:[e.jsx(I,{fontSize:"lg",fontWeight:"bold",children:"Giải thích:"}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>_("problemExplanation"),cursor:"pointer"})]}),b==="problemExplanation"?e.jsx(Ae,{ref:n,value:y.problemExplanation,config:Me,onChange:w=>A("problemExplanation",w),autoFocus:!0,style:{width:"100%",minHeight:"300px"}}):e.jsx(E,{overflowY:"auto",maxHeight:"300px",bg:"gray.200",borderRadius:"md",p:2,sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:at(d==null?void 0:d.problemExplanation)}}),e.jsxs(L,{align:"center",children:[e.jsx(I,{fontSize:"lg",fontWeight:"bold",children:"Code mẫu:"}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>_("testCode"),cursor:"pointer"})]}),b==="testCode"?e.jsxs(E,{borderColor:"gray.600",borderRadius:"md",mb:4,children:[e.jsx(U,{mb:4,placeholder:"Chọn ngôn ngữ",value:S,onChange:w=>j(w.target.value),children:z.map(w=>e.jsx("option",{value:w.compilerID,children:w.compilerName},w.compilerID))}),e.jsx(Tn,{height:"400px",theme:"vs-dark",value:d.testCode,language:Y,onChange:w=>A("testCode",w||""),onBlur:w=>A("testCode",w||""),options:{fontSize:14,minimap:{enabled:!1},suggestOnTriggerCharacters:!0,quickSuggestions:{other:!0,comments:!0,strings:!0},wordBasedSuggestions:!0,parameterHints:{enabled:!0},tabCompletion:"on"}})]}):e.jsx(E,{overflowY:"auto",maxHeight:"300px",bg:"gray.200",borderRadius:"md",p:2,sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:at(d==null?void 0:d.testCode)}})]})}),e.jsx(ne,{children:e.jsxs(le,{align:"stretch",spacing:4,children:[e.jsxs(L,{align:"center",children:[b==="testType"?e.jsxs(U,{value:y.testType||d.testType||"",onBlur:()=>x(null),onChange:w=>A("testType",w.target.value),autoFocus:!0,width:"100%",children:[e.jsx("option",{value:"Output Matching",children:"Output Matching"}),e.jsx("option",{value:"Validate Output",children:"Validate Output"})]}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Hình thức kiểm tra:"})," ",u[d.testType]||"Không xác định"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>_("testType"),cursor:"pointer"})]}),e.jsx(L,{align:"center",children:e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Tên người tạo:"})," ",d.coderName||"Chưa có thông tin"]})}),e.jsx(L,{align:"center",children:e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Trạng thái:"})," ",d.published===1?"Công khai":"Riêng tư"]})}),e.jsxs(L,{align:"center",children:[b==="compiler"?e.jsx(U,{mb:4,placeholder:"Chọn ngôn ngữ",value:S,onChange:w=>j(w.target.value),children:z.map(w=>e.jsx("option",{value:w.compilerID,children:w.compilerName},w.compilerID))}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Trình biên dịch:"})," ",((N=z.find(w=>w.compilerID===Number(d.testCompilerID)))==null?void 0:N.compilerName)||"Chưa chọn"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>_("compiler")})]}),e.jsxs(L,{align:"center",children:[b==="selectedCategory"?e.jsx(Mt,{columns:2,spacing:2,w:"full",children:h.map(w=>{var ae;const O=(ae=y.selectedCategoryIDs)==null?void 0:ae.includes(w.categoryID);return e.jsx(yt,{isChecked:O,onChange:Ne=>{const ke=Ne.target.checked?[...new Set([...y.selectedCategoryIDs||[],w.categoryID])]:(y.selectedCategoryIDs||[]).filter(Fe=>Fe!==w.categoryID);D(Fe=>({...Fe,selectedCategoryIDs:ke}))},children:w.catName},w.categoryID)})}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Thể loại:"})," ",((k=d.selectedCategoryNames)==null?void 0:k.length)>0?d.selectedCategoryNames.join(", "):"Chưa có danh mục"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>_("selectedCategory")})]}),e.jsxs(L,{align:"center",children:[b==="lesson"?e.jsx(U,{name:"selectedLessonID",value:y.selectedLessonID||"",onBlur:()=>x(null),onChange:w=>A("selectedLessonID",w.target.value),autoFocus:!0,width:"100%",children:c.map(w=>e.jsx("option",{value:w.lessonID,children:w.lessonTitle},w.lessonID))}):e.jsxs(I,{fontSize:"lg",children:[e.jsx("strong",{children:"Bài học: "})," ",((T=c.find(w=>w.lessonID===Number(d.selectedLessonID)))==null?void 0:T.lessonTitle)||"Chưa chọn"]}),e.jsx($,{"aria-label":"Edit",icon:e.jsx(Z,{}),ml:2,size:"sm",onClick:()=>_("lesson")})]})]})})]})}),e.jsx(L,{justifyContent:"flex-end",mt:6,children:e.jsx(H,{variant:"solid",size:"lg",colorScheme:"teal",borderRadius:"xl",px:10,boxShadow:"lg",bgGradient:"linear(to-l, green.500, green.300)",transition:"all 0.2s ease-in-out",_hover:{color:"white",transform:"scale(1.05)"},_active:{transform:"scale(0.90)"},onClick:V,isLoading:s,loadingText:"Đang lưu...",children:"Lưu"})})]})})}):e.jsx(bt,{})},jo=({blogId:t,initialStatus:n,fetchData:o})=>{const[a,s]=r.useState(n),l=Q(),p=ct({mutationFn:g=>J.patch(`/Blog/${t}/status`,{published:g}),onSuccess:(g,d)=>{s(d),l({title:"Cập nhật thành công",description:"Cập nhật trạng thái thành công",status:"success",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"}),o==null||o()},onError:()=>{l({title:"Cập nhật thất bại",description:"Không thể cập nhật trạng thái",status:"error",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"})}}),i=()=>{const g=a===1?0:1;p.mutate(g)};return e.jsx(Ke,{bg:a===1?"green.400":"gray.400",fontSize:"sm",textColor:"white",cursor:"pointer",onClick:p.isLoading?null:i,opacity:p.isLoading?.6:1,pointerEvents:p.isLoading?"none":"auto",children:p.isLoading?e.jsx(Be,{size:"xs",color:"white"}):a===1?"Online":"Offline"})},fo=({blogId:t,initialStatus:n,fetchData:o})=>{const[a,s]=r.useState(!!n),l=Q();r.useEffect(()=>{s(!!n)},[n]);const p=ct({mutationFn:g=>J.patch(`/Blog/${t}/status`,{pinHome:g?1:0}),onSuccess:(g,d)=>{s(d),l({title:"Cập nhật thành công",description:"Cập nhật trạng thái thành công",status:"success",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"}),o==null||o()},onError:()=>{l({title:"Cập nhật thất bại",description:"Không thể cập nhật trạng thái",status:"error",duration:1e3,isClosable:!0,position:"top",variant:"left-accent"})}}),i=()=>{p.isLoading||p.mutate(!a)};return e.jsx(L,{alignItems:"center",justifyContent:"center",cursor:p.isLoading?"not-allowed":"pointer",children:e.jsx(Es,{isChecked:a,onChange:i,isDisabled:p.isLoading,colorScheme:"blue"})})},mn=t=>[{Header:"STT",accessor:"stt",Cell:({rowIndex:n})=>n+1},{Header:"Tiêu đề bài viết",accessor:"title",Cell:({row:n})=>e.jsx(Dn,{to:`/blogs/${Pn(n.title)}-${n.blogID}`,children:e.jsx(I,{color:"black",cursor:"pointer",_hover:{textDecoration:"underline"},children:Wr(n==null?void 0:n.title,20)})}),sortable:!0},{Header:"Ngày đăng",accessor:"blogDate",Cell:({value:n})=>e.jsx("p",{children:ze(n)}),sortable:!0},{Header:"Người viết",accessor:"coderName"},{Header:"Lượt xem",accessor:"viewCount",Cell:({value:n})=>e.jsx(Ke,{colorScheme:"red",align:"center",children:Or(n)||0})},{Header:"Đã xuất bản",accessor:"published",Cell:({row:n})=>e.jsx(jo,{blogId:n.blogID,initialStatus:n.published,fetchData:t})},{Header:"Ghim trang chủ",accessor:"pinHome",Cell:({row:n})=>e.jsx(fo,{blogId:n.blogID,initialStatus:n.pinHome,fetchData:t})},{Header:"Hành động",accessor:"action",Cell:n=>e.jsx(qe,{...n,controller:"Blog",deleteFunction:$e,idData:"blogID",deleteSuccessToast:{title:"Đã xóa!",description:"Bài viết đã được xóa thành công."},deleteErrorToast:{title:"Xóa thất bại!",description:"Vui lòng thử lại sau."},fetchData:n.fetchData})}];function yo(){var A,V,W,Y,N,k;_e("Quản lý bài viết");const t=Q(),n=We();ie();const[o,a]=r.useState("name"),[s,l]=r.useState(!0),[p,i]=r.useState(1),[g,d]=r.useState(10),[m,h]=r.useState(""),f=Qe(m,600),c=T=>typeof T=="string"&&T.trim()!=="",v=["blogs",p,g,s,o],b=["blogsSearch",f,p,g],x=pe({queryKey:v,queryFn:()=>X({controller:"Blog",page:p,pageSize:g,ascending:s}),enabled:!c(f),keepPreviousData:!0,staleTime:6e4,retry:1,onError:()=>{t({title:"Lỗi khi tải dữ liệu",description:"Không thể tải dữ liệu. Vui lòng thử lại sau.",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"left-accent"})}}),y=pe({queryKey:b,queryFn:()=>ge({controller:"Blog",keyword:f,page:p,pageSize:g}),enabled:c(f),keepPreviousData:!0,staleTime:6e4,retry:1,onError:T=>{t({title:"Lỗi khi tìm kiếm",description:T.message||"Không thể tìm kiếm. Vui lòng thử lại sau.",status:"error",duration:3e3,isClosable:!0,position:"top",variant:"left-accent"})}});r.useEffect(()=>{const T=c(f)?y.data:x.data;if(T!=null&&T.totalPages&&p<T.totalPages){const w=p+1;c(f)?n.prefetchQuery({queryKey:["blogsSearch",f,w,g],queryFn:()=>ge({controller:"Blog",keyword:f,page:w,pageSize:g})}):n.prefetchQuery({queryKey:["blogs",w,g,s,o],queryFn:()=>X({controller:"Blog",page:w,pageSize:g,ascending:s})})}},[f,y.data,x.data,p,g,s,o,n]);const D=T=>{o===T?l(!s):(a(T),l(!0)),i(1)},u=T=>{var O,ae;const w=c(f)?((O=y.data)==null?void 0:O.totalPages)||0:((ae=x.data)==null?void 0:ae.totalPages)||0;T>0&&T<=w&&i(T)},z=T=>{const w=parseInt(T,10);w!==g&&(d(w),i(1))},C=T=>{h(T),i(1)},S=()=>{n.invalidateQueries({queryKey:["blogs"]}),n.invalidateQueries({queryKey:["blogsSearch"]})},j=c(f)?(A=y.data)==null?void 0:A.data:(V=x.data)==null?void 0:V.data,F=c(f)?((W=y.data)==null?void 0:W.totalPages)||0:((Y=x.data)==null?void 0:Y.totalPages)||0,R=c(f)?((N=y.data)==null?void 0:N.totalCount)||0:((k=x.data)==null?void 0:k.totalCount)||0,_=c(f)?y.isFetching:x.isFetching;return e.jsx(me,{children:e.jsxs(E,{pt:{base:"130px",md:"80px",xl:"80px"},children:[e.jsx(Ve,{onSearch:C,valueSearch:m,title:mn}),e.jsx(Ge,{columnsData:mn(S),tableData:j||[],loading:_,onSort:D,sortField:o,ascending:s,fetchData:S}),e.jsx(Oe,{currentPage:p,totalPages:F,totalRows:R,onPageChange:u,pageSize:g,onPageSizeChange:z})]})})}const Co=be.lazy(()=>re(()=>import("./index-anuv8OI6.js"),__vite__mapDeps([12,1,2,3,4,13,5,14,15,6,7,16]))),vo=be.lazy(()=>re(()=>import("./index-DvKFbiQm.js"),__vite__mapDeps([17,1,2,3,4,13,6,7]))),So=be.lazy(()=>re(()=>import("./CourseDetail-CEYADAKp.js"),__vite__mapDeps([18,1,2,3,4,6,7]))),wo=be.lazy(()=>re(()=>import("./index-BxiIq11d.js"),__vite__mapDeps([19,1,2,3,4,6,7]))),ko=be.lazy(()=>re(()=>import("./index-B89RBN5M.js"),__vite__mapDeps([20,1,2,3,4,6,7]))),Io=be.lazy(()=>re(()=>import("./index-D_jns5O0.js"),__vite__mapDeps([21,1,2,3,4,22,14,15,6,7]))),To=be.lazy(()=>re(()=>import("./BlogDetail-BaOyJfr2.js"),__vite__mapDeps([23,1,2,3,4,14,6,7]))),Re=[{name:"Main Dashboard",layout:"/admin",path:"/dashboard",icon:e.jsx(Zt,{size:20}),component:e.jsx(Pr,{}),allowedRoles:[1,3]},{name:"Loại khóa học",layout:"/admin",icon:e.jsx(Ls,{size:20}),path:"/category-course",component:e.jsx(Zr,{}),allowedRoles:[1]},{name:"Khóa học",layout:"/admin",icon:e.jsx(en,{size:20}),path:"/course",component:e.jsx(to,{}),allowedRoles:[1,3],item:[{name:"Chi tiết khóa học",path:"detail/:id",component:e.jsx(ro,{})}]},{name:"Chủ đề",layout:"/admin",icon:e.jsx(zs,{size:20}),path:"/topic",component:e.jsx(ao,{}),allowedRoles:[1,3],item:[{name:"Chi tiết chủ đề",path:"detail/:id",component:e.jsx(io,{})}]},{name:"Bài học",layout:"/admin",icon:e.jsx(Ns,{size:20}),path:"/lesson",component:e.jsx(co,{}),allowedRoles:[1,3],item:[{name:"Chi tiết bài học",path:"detail/:id",component:e.jsx(ho,{})}]},{name:"Nhãn",layout:"/admin",icon:e.jsx(tn,{size:20}),path:"/badge",component:e.jsx(Ur,{}),allowedRoles:[1],item:[{name:"Thêm mới nhãn",path:"create",component:e.jsx(Bn,{})}]},{name:"Quản lý bài tập",layout:"/admin",icon:e.jsx(Fs,{size:20}),path:"/problem",component:e.jsx(mo,{}),allowedRoles:[1,3],item:[{name:"Chi tiết bài tập",path:"detail/:id",component:e.jsx(bo,{})}]},{name:"Quản lý bài viết",layout:"/admin",icon:e.jsx(nn,{size:20}),path:"/blog",component:e.jsx(yo,{}),allowedRoles:[1,3]},{name:"Người dùng",layout:"/admin",icon:e.jsx(Rs,{size:20}),path:"/coder",component:e.jsx($r,{}),allowedRoles:[1],item:[{name:"Chi tiết người dùng",path:"detail/:id",component:e.jsx(Yr,{})}]},{name:"TRANG CHỦ",layout:"/user",path:"/",icon:e.jsx(Zt,{size:20}),component:e.jsx(Co,{}),protected:!1},{name:"HỌC TẬP",layout:"/user",path:"/course",icon:e.jsx(en,{size:20}),component:e.jsx(vo,{}),item:[{name:"Chi tiết khóa học",path:":slugId",component:e.jsx(So,{}),protected:!1},{name:"Chi tiết bài học",path:":slugId/:lessonId",component:e.jsx(wo,{}),protected:!0}]},{name:"XÊP HẠNG",layout:"/user",path:"/ranking",icon:e.jsx(tn,{size:20}),component:e.jsx(ko,{}),protected:!1},{name:"BÀI VIẾT",layout:"/user",path:"/blogs",icon:e.jsx(nn,{size:20}),component:e.jsx(Io,{}),protected:!1,item:[{name:"Chi tiết bài viết",path:":slugId",component:e.jsx(To,{}),protected:!1}]}],Do=({isOpen:t,onClose:n})=>{const[o,a]=r.useState(""),[s,l]=r.useState(null),p=we(),i=r.useRef(null),g=r.useRef([]),m=Re.filter(u=>u.layout==="/admin").map(u=>({path:`/admin${u.path}`,name:u.name})).filter(u=>u.name.toLowerCase().includes(o.toLowerCase())),h=G("white","gray.900"),f=G("black","white"),c=G("gray.200","gray.700"),v=G("gray.200","gray.700"),b=G("gray.700","white");r.useEffect(()=>{t&&i.current&&(a(""),l(null),i.current.focus())},[t]),r.useEffect(()=>{s!==null&&g.current[s]&&g.current[s].scrollIntoView({behavior:"smooth",block:"nearest"})},[s]);const x=u=>{u.key==="ArrowDown"?l(z=>z===null||z===m.length-1?0:z+1):u.key==="ArrowUp"?l(z=>z===null||z===0?m.length-1:z-1):u.key==="Enter"&&s!==null&&y(m[s])},y=u=>{p(u.path),a(""),n()},D=u=>{l(u)};return e.jsxs(je,{isOpen:t,size:"2xl",onClose:n,isCentered:!0,children:[e.jsx(de,{}),e.jsx(fe,{bg:h,children:e.jsxs(he,{px:2,onKeyDown:x,tabIndex:-1,children:[e.jsx(oe,{ref:i,placeholder:"Nhập tên trang...",value:o,onChange:u=>a(u.target.value),mb:3,_focusVisible:{borderColor:f,borderWidth:"2px"},bg:"transparent",color:b}),e.jsx(ht,{ps:4,maxH:"50vh",overflowY:"auto",children:m.map((u,z)=>e.jsxs(Ct,{ref:C=>g.current[z]=C,onClick:()=>y(u),_hover:{cursor:"pointer",bg:c},px:4,py:2,borderRadius:"md",bg:s===z?v:"transparent",onMouseEnter:()=>D(z),children:[e.jsx(I,{fontWeight:"bold",color:b,children:u.name}),e.jsx(I,{fontSize:"sm",color:"gray.500",children:u.path})]},u.path))}),e.jsxs(L,{gap:"5",px:5,justify:"space-evenly",align:"center",my:2,children:[e.jsxs(I,{fontSize:"sm",color:"gray.600",mt:2,children:["Để chọn trang nhấn ",e.jsx(ot,{fontWeight:"bold",px:3,py:1,ml:1,children:"↲"})]}),e.jsxs(I,{fontSize:"sm",color:"gray.600",mt:2,children:["Di chuyển lên",e.jsx(ot,{px:3,fontWeight:"bold",py:1,ml:2,children:"↓"}),e.jsx(ot,{fontWeight:"bold",px:3,py:1,ml:2,children:"↑"})," để lựa chọn trang"]})]})]})})]},t?"open":"closed")},Eo=t=>{const{variant:n,children:o,...a}=t;return e.jsx(L,{h:"1px",w:"100%",bg:"rgba(135, 140, 189, 0.3)",...a})},Ht="/assets/logo-BXfPRnHf.png";function Lo(){return e.jsxs(L,{align:"center",direction:"column",children:[e.jsx(et,{href:"/admin/dashboard",p:2,children:e.jsx(_s,{src:Ht,alt:"NTU Logo",h:"80px"})}),e.jsx(Eo,{mb:"10px"})]})}function zo(t){let n=pt(),o=G("gray.700","white"),a=G("secondaryGray.600","secondaryGray.600"),s=G("brand.500","white"),l=G("secondaryGray.500","white"),p=G("brand.500","brand.400");const{routes:i}=t,{coder:g}=tt(),d=(g==null?void 0:g.roleID)===1,m=f=>n.pathname.includes(f),h=f=>f.map((c,v)=>{var x;const b=(x=c.allowedRoles)==null?void 0:x.includes(g==null?void 0:g.roleID);return c.category?e.jsxs(be.Fragment,{children:[e.jsx(I,{fontSize:"md",color:o,fontWeight:"bold",mx:"auto",ps:{sm:"10px",xl:"16px"},pt:"18px",pb:"12px",children:c.name}),h(c.items)]},`cat-${v}`):c.layout==="/admin"&&(d||b)?e.jsx(Ze,{to:c.layout+c.path,children:c.icon?e.jsx(E,{children:e.jsxs(Ye,{spacing:m(c.path.toLowerCase())?"22px":"26px",py:"5px",ps:"10px",children:[e.jsxs(L,{w:"100%",alignItems:"center",justifyContent:"center",children:[e.jsx(E,{color:m(c.path.toLowerCase())?s:l,me:"18px",children:c.icon}),e.jsx(I,{me:"auto",color:m(c.path.toLowerCase())?o:l,fontWeight:m(c.path.toLowerCase())?"bold":"normal",children:c.name})]}),e.jsx(E,{h:"36px",w:"4px",bg:m(c.path.toLowerCase())?p:"transparent",borderRadius:"5px"})]})}):e.jsx(E,{children:e.jsxs(Ye,{spacing:m(c.path.toLowerCase())?"22px":"26px",py:"5px",ps:"10px",children:[e.jsx(I,{me:"auto",color:m(c.path.toLowerCase())?o:a,fontWeight:m(c.path.toLowerCase())?"bold":"normal",children:c.name}),e.jsx(E,{h:"36px",w:"4px",bg:"brand.400",borderRadius:"5px"})]})})},v):null});return e.jsx(e.Fragment,{children:h(i)})}function Vn(t){const{routes:n,coder:o}=t;return e.jsxs(L,{direction:"column",height:"100%",pt:"25px",px:"16px",borderRadius:"30px",children:[e.jsx(Lo,{}),e.jsx(En,{direction:"column",mb:"auto",mt:"8px",children:e.jsx(E,{ps:"20px",pe:{md:"16px","2xl":"1px"},children:e.jsx(zo,{routes:n,coder:o})})})]})}const Gt=({style:t,...n})=>{const o={position:"absolute",maxWidth:"100%",width:6,transition:"opacity 200ms ease 0s",opacity:0,background:"transparent",bottom:2,top:2,borderRadius:3,right:0};return e.jsx("div",{style:{...t,...o},...n})},$t=({style:t,...n})=>{const o={borderRadius:15,background:"rgba(222, 222, 222, .1)"};return e.jsx("div",{style:{...t,...o},...n})},qt=({style:t,...n})=>{const o={marginBottom:-22};return e.jsx(E,{me:{base:"0px !important",lg:"-16px !important"},style:{...t,...o},...n})};function Gn(t){const{routes:n}=t;let o="0.2s linear",a=G("14px 17px 40px 4px rgba(112, 144, 176, 0.08)","unset"),s=G("white","navy.800");return e.jsx(E,{display:{sm:"none",xl:"block"},w:"100%",position:"fixed",minH:"100%",children:e.jsx(E,{bg:s,transition:o,w:"300px",h:"100vh",m:"0px",minH:"100%",overflowX:"hidden",boxShadow:a,children:e.jsx(Bt.Scrollbars,{autoHide:!0,renderTrackVertical:Gt,renderThumbVertical:$t,renderView:qt,children:e.jsx(Vn,{routes:n})})})})}function No(t){let n=G("white","navy.800"),o=G("gray.400","white");const{isOpen:a,onOpen:s,onClose:l}=ie(),p=be.useRef(),{routes:i}=t;return e.jsxs(L,{display:{sm:"flex",xl:"none"},alignItems:"center",children:[e.jsx(L,{ref:p,w:"max-content",h:"max-content",onClick:s,children:e.jsx(Le,{as:Ps,color:o,my:"auto",w:"20px",h:"20px",me:"10px",_hover:{cursor:"pointer"}})}),e.jsxs(Ln,{isOpen:a,onClose:l,placement:document.documentElement.dir==="rtl"?"right":"left",finalFocusRef:p,children:[e.jsx(de,{}),e.jsxs(zn,{w:"285px",maxW:"285px",bg:n,children:[e.jsx(ye,{zIndex:"3",onClose:l,_focus:{boxShadow:"none"},_hover:{boxShadow:"none"}}),e.jsx(he,{maxW:"285px",px:"0rem",pb:"0",children:e.jsx(Bt.Scrollbars,{autoHide:!0,renderTrackVertical:Gt,renderThumbVertical:$t,renderView:qt,children:e.jsx(Vn,{routes:i})})})]})]})]})}Gn.propTypes={logoText:ee.string,routes:ee.arrayOf(ee.object),variant:ee.string};function $n(t){const{secondary:n}=t,{logout:o,coder:a}=tt(),s=we(),{colorMode:l,toggleColorMode:p}=ce(),{isOpen:i,onOpen:g,onClose:d}=ie(),m=G("gray.400","white");let h=G("white","navy.800");const f=G("secondaryGray.900","white"),c=G("brand.700","brand.400"),v=G("#E6ECFA","rgba(135, 140, 189, 0.3)"),b=G("14px 17px 40px 4px rgba(112, 144, 176, 0.18)","14px 17px 40px 4px rgba(112, 144, 176, 0.06)");return e.jsxs(L,{w:{sm:"100%",md:"auto"},alignItems:"center",flexDirection:"row",bg:h,flexWrap:n?{base:"wrap",md:"nowrap"}:"unset",p:"10px",borderRadius:"30px",boxShadow:b,children:[e.jsx(Dr,{mb:()=>n?{base:"10px",md:"unset"}:"unset",me:"10px",borderRadius:"30px",onOpen:g}),e.jsx(Do,{isOpen:i,onClose:d}),e.jsx(No,{routes:Re}),e.jsx(H,{variant:"outline",colorScheme:"blue",mx:2,onClick:()=>s("/"),display:{base:"none",md:"block"},children:"Trang người dùng"}),e.jsxs(Ft,{children:[e.jsx(Rt,{p:"0px",children:e.jsx(Le,{mt:"6px",as:As,color:m,w:"18px",h:"18px",me:"10px"})}),e.jsxs(_t,{boxShadow:b,p:"20px",borderRadius:"20px",bg:h,border:"none",mt:"22px",me:{base:"30px",md:"unset"},minW:{base:"unset",md:"400px",xl:"450px"},maxW:{base:"360px",md:"unset"},children:[e.jsxs(L,{w:"100%",mb:"20px",children:[e.jsx(I,{fontSize:"md",fontWeight:"600",color:f,children:"Notifications"}),e.jsx(I,{fontSize:"sm",fontWeight:"500",color:c,ms:"auto",cursor:"pointer",children:"Mark all read"})]}),e.jsxs(L,{flexDirection:"column",children:[e.jsx(rt,{_hover:{bg:"none"},_focus:{bg:"none"},px:"0",borderRadius:"8px",mb:"10px"}),e.jsx(rt,{_hover:{bg:"none"},_focus:{bg:"none"},px:"0",borderRadius:"8px",mb:"10px"})]})]})]}),e.jsx(H,{variant:"no-hover",bg:"transparent",p:"0px",minW:"unset",minH:"unset",h:"18px",w:"max-content",onClick:p,children:e.jsx(Le,{me:"10px",h:"18px",w:"18px",color:m,as:l==="light"?Hs:Ms})}),e.jsxs(Ft,{children:[e.jsx(Rt,{p:"0px",children:e.jsx(At,{_hover:{cursor:"pointer"},color:"white",bg:"#11047A",size:"sm",w:"40px",h:"40px",alt:"avatar",src:a.avatar||"coder"})}),e.jsxs(_t,{boxShadow:b,p:"0px",mt:"10px",borderRadius:"20px",bg:h,border:"none",zIndex:2,children:[e.jsx(L,{w:"100%",mb:"0px",children:e.jsxs(I,{ps:"20px",pt:"16px",pb:"10px",w:"100%",borderBottom:"1px solid",borderColor:v,fontSize:"sm",fontWeight:"700",color:f,children:["👋  Hey,",e.jsxs(I,{as:"span",color:"Red",children:[" ",a.coderName||"coder"]})]})}),e.jsxs(L,{flexDirection:"column",p:"10px",children:[e.jsx(rt,{_hover:{bg:"gray.200"},borderRadius:"8px",px:"14px",onClick:()=>s("/"),children:"Trang người dùng"}),e.jsx(rt,{_hover:{bg:"gray.200"},color:"red.400",borderRadius:"8px",px:"14px",onClick:o,children:e.jsx(I,{fontSize:"sm",children:"Log out"})})]})]})]})]})}$n.propTypes={variant:ee.string,fixed:ee.bool,secondary:ee.bool,onOpen:ee.func};function qn(t){const[n,o]=r.useState(!1),a=pt();r.useEffect(()=>(window.addEventListener("scroll",C),()=>{window.removeEventListener("scroll",C)}));const{secondary:s,message:l}=t;let p,i;const g=Re.find(S=>{var j;return a.pathname.startsWith(S.layout)&&a.pathname.includes(S.path.split("/:")[0])?(p=(j=S.item)==null?void 0:j.find(F=>{const R=F.path.split("/:")[0];return a.pathname.includes(R)}),!0):!1}),d=p?p.name:g?g.name:"Dashboard";let m=G("navy.700","white"),h=G("gray.700","white"),f="fixed",c="none",v="blur(20px)",b="none",x=G("rgba(244, 247, 254, 0.2)","rgba(11,20,55,0.5)"),y="transparent",D="0px",u="15px",z="0px";const C=()=>{window.scrollY>1?o(!0):o(!1)};return e.jsxs(E,{position:f,boxShadow:b,bg:x,borderColor:y,filter:c,backdropFilter:v,backgroundPosition:"center",backgroundSize:"cover",borderRadius:"16px",borderWidth:"1.5px",borderStyle:"solid",transitionDelay:"0s, 0s, 0s, 0s",transitionDuration:" 0.25s, 0.25s, 0.25s, 0s","transition-property":"box-shadow, background-color, filter, border",transitionTimingFunction:"linear, linear, linear, linear",alignItems:{xl:"center"},display:s?"block":"flex",minH:"75px",justifyContent:{xl:"center"},lineHeight:"25.6px",mx:"auto",mt:D,pb:"8px",right:{base:"12px",md:"30px",lg:"30px",xl:"30px"},px:{sm:u,md:"10px"},ps:{xl:"12px"},pt:"8px",top:{base:"12px",md:"16px",lg:"20px",xl:"20px"},w:{base:"calc(100vw - 6%)",md:"calc(100vw - 8%)",lg:"calc(100vw - 6%)",xl:"calc(100vw - 350px)","2xl":"calc(100vw - 365px)"},zIndex:2,children:[e.jsxs(L,{w:"100%",flexDirection:{sm:"column",md:"row"},alignItems:{xl:"center"},mb:z,children:[e.jsxs(E,{mb:{sm:"8px",md:"0px"},children:[e.jsxs(Bs,{children:[e.jsx(kt,{color:h,fontSize:"sm",mb:"5px",children:e.jsx(It,{href:"#",color:h,children:"Admin"})}),g&&e.jsx(kt,{color:h,fontSize:"sm",mb:"5px",children:e.jsx(It,{href:`${g.layout}${g.path}`,color:h,children:g.name})}),i,p&&e.jsx(kt,{color:h,fontSize:"sm",mb:"5px",children:e.jsx(It,{href:"#",color:h,children:p.name})})]}),e.jsx(et,{color:m,href:"#",bg:"inherit",borderRadius:"inherit",fontWeight:"bold",fontSize:"34px",_hover:{color:{mainText:m}},_active:{bg:"inherit",transform:"none",borderColor:"transparent"},_focus:{boxShadow:"none"},children:d})]}),e.jsx(E,{ms:"auto",w:{sm:"100%",md:"unset"},children:e.jsx($n,{onOpen:t.onOpen,logoText:t.logoText,secondary:t.secondary,fixed:t.fixed,scrolled:n})})]}),s?e.jsx(I,{color:"white",children:l}):null]})}qn.propTypes={brandText:ee.string,variant:ee.string,secondary:ee.bool,fixed:ee.bool,onOpen:ee.func};const Fo=r.createContext(),Ue=({children:t,allowedRoles:n})=>{const{isAuthenticated:o,coder:a,isLoading:s}=tt(),l=Q(),p=we(),[i,g]=r.useState(!1),[d,m]=r.useState("");return r.useEffect(()=>{s||(o?n&&!n.includes(a==null?void 0:a.roleID)&&g(!0):(m("Bạn cần phải đăng nhập."),g(!0)))},[o,a,n,s]),r.useEffect(()=>{i&&d&&l({title:d,status:"warning",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})},[i,d,l]),s?null:i?(p(-1),null):t},Ro=()=>e.jsx(L,{direction:"column",justify:"center",align:"center",height:"100vh",children:e.jsx(Be,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"})}),_o=r.lazy(()=>re(()=>import("./index-PVDGRr9X.js"),__vite__mapDeps([24,1,2,3,4,6,7]))),Po=r.lazy(()=>re(()=>import("./NotFound-Ba0RH7_S.js"),__vite__mapDeps([25,1,2,3,4,6,7])));function Ao(t){const{...n}=t,{onOpen:o}=ie(),[a]=r.useState(!1),[s,l]=r.useState(!1),p=()=>window.location.pathname!=="/admin/full-screen-maps",i=h=>{let f="Default Brand Text";for(let c=0;c<h.length;c++)if(h[c].collapse){let v=i(h[c].items);if(v!==f)return v}else if(h[c].category){let v=i(h[c].items);if(v!==f)return v}else if(window.location.href.indexOf(h[c].layout+h[c].path)!==-1)return h[c].name;return f},g=h=>{let f=!1;for(let c=0;c<h.length;c++)if(h[c].collapse){let v=g(h[c].items);if(v!==f)return v}else if(h[c].category){let v=g(h[c].items);if(v!==f)return v}else if(window.location.href.indexOf(h[c].layout+h[c].path)!==-1)return h[c].secondary;return f},d=h=>{let f=!1;for(let c=0;c<h.length;c++)if(h[c].collapse){let v=d(h[c].items);if(v!==f)return v}else if(h[c].category){let v=d(h[c].items);if(v!==f)return v}else if(window.location.href.indexOf(h[c].layout+h[c].path)!==-1)return h[c].messageNavbar;return f},m=h=>h.flatMap((f,c)=>{if(f.layout==="/admin"){const v=e.jsx(Se,{path:f.path,element:e.jsx(Ue,{allowedRoles:f.allowedRoles,children:f.component})},c),b=f.item?f.item.map((x,y)=>e.jsx(Se,{path:`${f.path}/${x.path}`,element:e.jsx(Ue,{allowedRoles:x.allowedRoles||f.allowedRoles,children:x.component})},`${c}-${y}`)):[];return[v,...b]}return[]});return e.jsx(E,{children:e.jsx(E,{children:e.jsxs(Fo.Provider,{value:{toggleSidebar:s,setToggleSidebar:l},children:[e.jsx(Gn,{routes:Re,display:"none",...n}),e.jsxs(E,{float:"right",minHeight:"95vh",height:"100%",overflow:"auto",position:"relative",maxHeight:"100%",w:{base:"100%",xl:"calc( 100% - 290px )"},maxWidth:{base:"100%",xl:"calc( 100% - 290px )"},transition:"all 0.33s cubic-bezier(0.685, 0.0473, 0.346, 1)",transitionDuration:".2s, .2s, .35s",transitionProperty:"top, bottom, width",transitionTimingFunction:"linear, linear, ease",children:[e.jsx(Ks,{children:e.jsx(E,{children:e.jsx(qn,{onOpen:o,logoText:"NTU",brandText:i(Re),secondary:g(Re),message:d(Re),fixed:a,...n})})}),p()?e.jsx(E,{mx:"auto",p:{base:"20px",md:"30px"},pe:"20px",minH:"90vh",pt:"50px",children:e.jsx(r.Suspense,{fallback:e.jsx(Ro,{}),children:e.jsxs(Kt,{children:[m(Re),e.jsx(Se,{index:!0,element:e.jsx(Ws,{to:"/admin/dashboard",replace:!0})}),e.jsx(Se,{path:"testcase/:problemId",element:e.jsx(_o,{})}),e.jsx(Se,{path:"*",element:e.jsx(Po,{})})]})})}):null,e.jsx(E,{children:e.jsx(Tr,{})})]})]})})})}const Ho=Wt(E);function bn({routes:t,direction:n}){const o=G("blue.500","blue.300"),a=G("gray.800","gray.500");return e.jsx(L,{direction:n,spacing:2,gap:4,alignItems:"center",position:"relative",children:t&&t.length>0&&t.map((s,l)=>e.jsx(Ze,{to:s.path,style:{textDecoration:"none",position:"relative"},children:({isActive:p})=>e.jsxs(E,{position:"relative",textAlign:"center",children:[e.jsx(I,{fontWeight:"bold",fontSize:16,color:p?o:a,py:1,px:2,_hover:{color:o},transition:"all 0.2s ease-in-out",children:s.name}),p&&e.jsx(Ho,{layoutId:"underline",position:"absolute",bottom:"-2px",left:"0",width:"100%",height:"4px",bg:o,borderRadius:"full",initial:!1,transition:{type:"spring",stiffness:500,damping:30}})]})},l))})}const Mo=({onSuccess:t,onForgotPassword:n})=>{const[o,a]=r.useState(!1),[s,l]=r.useState({userName:"",password:""}),[p,i]=r.useState(!1),[g,d]=r.useState({userName:"",password:""}),m=Q(),h=async()=>{var f,c,v;if(d({userName:"",password:""}),!s.userName||!s.password){d({userName:s.userName?"":"Tên đăng nhập không thể bỏ trống.",password:s.password?"":"Mật khẩu không thể bỏ trống."});return}i(!0);try{const b=await Mr(s);if(b.status===200){const x=await J.get("/Auth/me",{withCredentials:!0});x.status===200&&t(x.data),m({title:"Đăng nhập thành công!",status:"success",duration:3e3,isClosable:!0,position:"top",variant:"top-accent"})}else{const x=((f=b.data)==null?void 0:f.message)||"Vui lòng kiểm tra thông tin";d({userName:x,password:x})}}catch(b){console.error("Error:",b),d({userName:((c=b.response)==null?void 0:c.data)||"Tên đăng nhập hoặc mật khẩu không đúng",password:((v=b.response)==null?void 0:v.data)||"Tên đăng nhập hoặc mật khẩu không đúng"})}finally{i(!1)}};return e.jsxs("form",{onSubmit:f=>{f.preventDefault(),h()},children:[e.jsxs(M,{isInvalid:!!g.userName,children:[e.jsx(B,{fontWeight:"bold",children:"Tên đăng nhập"}),e.jsx(te,{type:"text",placeholder:"Nhập tên đăng nhập",value:s.userName,onChange:f=>l({...s,userName:f.target.value}),autoFocus:!0}),e.jsx(q,{children:g.userName})]}),e.jsxs(M,{mt:4,isInvalid:!!g.password,children:[e.jsx(B,{fontWeight:"bold",children:"Mật khẩu"}),e.jsxs(it,{children:[e.jsx(te,{type:o?"text":"password",placeholder:"Nhập mật khẩu",value:s.password,onChange:f=>l({...s,password:f.target.value})}),e.jsx(xt,{children:e.jsx($,{variant:"link",icon:o?e.jsx(vt,{}):e.jsx(St,{}),onClick:()=>a(!o),"aria-label":"Toggle Password Visibility"})})]}),e.jsx(q,{children:g.password})]}),e.jsx(H,{type:"submit",colorScheme:"blue",width:"full",mt:7,isLoading:p,loadingText:"Đang đăng nhập..",_hover:{boxShadow:"0px 4px 10px rgb(74, 168, 222)"},children:"Đăng nhập"}),e.jsx(E,{textAlign:"right",mt:2,children:e.jsx(et,{color:"blue.500",fontSize:"sm",cursor:"pointer",onClick:()=>{n&&n()},_hover:{textDecoration:"underline"},children:"Quên mật khẩu?"})})]})},Bo=({onSuccess:t})=>{const[n,o]=r.useState({coderName:"",coderEmail:"",userName:"",password:"",repassword:"",phoneNumber:""}),[a,s]=r.useState(!1),[l,p]=r.useState({coderName:"",coderEmail:"",userName:"",password:"",repassword:"",phoneNumber:""}),[i,g]=r.useState(!1),d=Q(),m=we(),h=c=>({coderName:c.coderName?"":"Họ và tên không thể bỏ trống.",coderEmail:c.coderEmail?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.coderEmail)?"":"Email không đúng định dạng.":"Email không thể bỏ trống.",phoneNumber:c.phoneNumber&&!/^0\d{9}$/.test(c.phoneNumber)?"Số điện thoại phải có 10 chữ số và bắt đầu bằng số 0.":"",userName:c.userName?c.userName.length<6?"Tên đăng nhập phải có ít nhất 6 ký tự.":"":"Tên đăng nhập không thể bỏ trống.",password:An(c.password),repassword:c.repassword?c.repassword!==c.password?"Mật khẩu xác nhận không khớp.":"":"Xác nhận mật khẩu không thể bỏ trống."}),f=async()=>{var b,x;p({coderName:"",coderEmail:"",userName:"",password:"",repassword:"",phone:"",phoneNumber:""});const c=h(n);if(Object.values(c).some(y=>y)){p(c);return}g(!0);try{const y=await Br(n);y.status===200||y.status===201?(d({title:"Đăng ký thành công!",status:"success",duration:3e3,isClosable:!0,position:"top",variant:"top-accent"}),t(y.data),m("/")):d({title:"Đã xảy ra lỗi. Vui lòng thử lại.",status:"error",duration:3e3,isClosable:!0,position:"top",variant:"top-accent"})}catch(y){console.error("Lỗi đăng ký:",y);const D=(x=(b=y.response)==null?void 0:b.data)==null?void 0:x.errors;if(Array.isArray(D)){const u={};D.includes("Email đã tồn tại.")&&(u.coderEmail="Email đã tồn tại."),p(z=>({...z,...u}))}else p(typeof D=="object"&&D!==null?u=>({...u,...D}):u=>({...u,general:"Đã xảy ra lỗi. Vui lòng thử lại."}))}finally{g(!1)}};return e.jsxs("form",{onSubmit:c=>{c.preventDefault(),f()},children:[e.jsxs(Mt,{columns:{base:1,md:2},spacing:4,children:[e.jsxs(M,{isInvalid:!!l.coderName,children:[e.jsxs(B,{fontWeight:"bold",children:["Họ và tên ",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{type:"text",placeholder:"Nhập họ và tên",value:n.coderName,onChange:c=>o({...n,coderName:c.target.value})}),e.jsx(q,{children:l.coderName})]}),e.jsxs(M,{isInvalid:!!l.userName,children:[e.jsxs(B,{fontWeight:"bold",children:["Tên đăng nhập",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{type:"text",placeholder:"Nhập tên đăng nhập (ít nhất 6 ký tự)",value:n.userName,onChange:c=>o({...n,userName:c.target.value})}),e.jsx(q,{children:l.userName})]}),e.jsxs(M,{isInvalid:!!l.password,children:[e.jsxs(B,{fontWeight:"bold",children:["Mật khẩu",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsxs(it,{children:[e.jsx(te,{type:a?"text":"password",placeholder:"Nhập ít nhất 6 ký tự",value:n.password,onChange:c=>o({...n,password:c.target.value})}),e.jsx(xt,{children:e.jsx($,{variant:"link",icon:a?e.jsx(vt,{}):e.jsx(St,{}),onClick:()=>s(!a)})})]}),e.jsx(q,{children:l.password})]}),e.jsxs(M,{isInvalid:!!l.repassword,children:[e.jsxs(B,{fontWeight:"bold",children:["Xác nhận mật khẩu",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{type:a?"text":"password",placeholder:"Xác nhận mật khẩu",value:n.repassword,onChange:c=>o({...n,repassword:c.target.value})}),e.jsx(q,{children:l.repassword})]}),e.jsxs(M,{isInvalid:!!l.coderEmail,children:[e.jsxs(B,{fontWeight:"bold",children:["Email",e.jsx(I,{as:"span",color:"red.500",children:" *"})]}),e.jsx(te,{type:"email",placeholder:"Nhập email",value:n.coderEmail,onChange:c=>o({...n,coderEmail:c.target.value})}),e.jsx(q,{children:l.coderEmail})]}),e.jsxs(M,{isInvalid:!!l.phoneNumber,children:[e.jsx(B,{fontWeight:"bold",children:"Số điện thoại"}),e.jsx(te,{type:"number",placeholder:"Nhập số điện thoại",value:n.phoneNumber,onChange:c=>o({...n,phoneNumber:c.target.value})}),e.jsx(q,{children:l.phoneNumber})]})]}),e.jsx(H,{colorScheme:"green",width:"full",mt:7,type:"submit",isLoading:i,loadingText:"Đang đăng ký...",_hover:{boxShadow:"0px 4px 10px rgb(74, 222, 128)"},children:"Đăng ký"})]})},Ko=({onCodeSent:t})=>{const[n,o]=r.useState(""),[a,s]=r.useState(!1),[l,p]=r.useState(""),i=Q(),g=async()=>{var d,m;if(p(""),!n){p("Vui lòng nhập email.");return}s(!0);try{(await J.post("/auth/send-reset-code",{email:n})).status===200&&(i({title:"Mã reset đã được gửi đến email của bạn.",status:"success",duration:3e3,isClosable:!0,variant:"top-accent",position:"top"}),t(n))}catch(h){p(((m=(d=h.response)==null?void 0:d.data)==null?void 0:m.message)||"Gửi mã thất bại. Vui lòng thử lại.")}finally{s(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(M,{isInvalid:!!l,children:[e.jsx(B,{children:"Email"}),e.jsx(oe,{type:"email",placeholder:"Nhập email của bạn",value:n,onChange:d=>o(d.target.value),autoFocus:!0}),e.jsx(q,{children:l})]}),e.jsx(H,{mt:4,colorScheme:"blue",onClick:g,isLoading:a,width:"30%",children:"Gửi mã"})]})},Wo=({email:t,onCodeVerified:n})=>{const[o,a]=r.useState(""),[s,l]=r.useState(!1),[p,i]=r.useState(""),[g,d]=r.useState(30),m=Q();r.useEffect(()=>{if(g<=0)return;const c=setInterval(()=>{d(v=>v-1)},1e3);return()=>clearInterval(c)},[g]);const h=c=>{const v=Math.floor(c/60),b=c%60;return`${String(v).padStart(2,"0")}:${String(b).padStart(2,"0")}`},f=async()=>{var c,v;if(i(""),!o){i("Vui lòng nhập mã.");return}if(g<=0){m({title:"Mã đã hết hạn. Vui lòng yêu cầu mã mới.",status:"error",duration:3e3,isClosable:!0,variant:"top-accent",position:"top"});return}l(!0);try{(await J.post("/auth/verify-reset-code",{email:t,code:o})).status===200&&(m({title:"Mã xác thực hợp lệ.",status:"success",duration:2e3,isClosable:!0,variant:"top-accent",position:"top"}),n(o))}catch(b){i(((v=(c=b.response)==null?void 0:c.data)==null?void 0:v.message)||"Mã không hợp lệ hoặc đã hết hạn.")}finally{l(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(M,{isInvalid:!!p,children:[e.jsx(B,{children:"Mã xác thực"}),e.jsx(oe,{placeholder:"Nhập mã đã nhận",value:o,onChange:c=>a(c.target.value),autoFocus:!0,isDisabled:g<=0}),e.jsx(q,{children:p})]}),e.jsxs(I,{mt:2,fontSize:"sm",color:g<=10?"red.500":"gray.500",children:["Mã hết hạn sau: ",h(g)]}),e.jsx(H,{mt:4,colorScheme:"blue",onClick:f,isLoading:s,width:"30%",isDisabled:g<=0,children:"Xác nhận mã"})]})},Oo=({email:t,code:n,onResetSuccess:o})=>{const[a,s]=r.useState(""),[l,p]=r.useState(!1),[i,g]=r.useState(!1),[d,m]=r.useState(""),h=Q(),f=async()=>{var b,x;m("");const v=An(a);if(v){m(v);return}g(!0);try{(await J.post("/auth/reset-password",{email:t,code:n,newPassword:a})).status===200&&(h({title:"Đổi mật khẩu thành công!",status:"success",duration:3e3,isClosable:!0}),o())}catch(y){m(((x=(b=y.response)==null?void 0:b.data)==null?void 0:x.message)||"Đổi mật khẩu thất bại.")}finally{g(!1)}},c=Rn(["Mật khẩu mới","Ít nhất 8 ký tự","Ít nhất 1 chữ cái viết hoa","Ít nhất 1 chữ cái viết thường","Ít nhất 1 số","Ít nhất 1 ký tự đặc biệt","Mật khẩu không được chứa khoảng trắng."],{delaySpeed:500});return e.jsxs(e.Fragment,{children:[e.jsxs(M,{isInvalid:!!d,children:[e.jsx(B,{children:"Mật khẩu mới"}),e.jsxs(it,{children:[e.jsx(oe,{type:l?"text":"password",placeholder:c,value:a,onChange:v=>s(v.target.value),autoFocus:!0}),e.jsx(xt,{children:e.jsx($,{"aria-label":"Toggle password visibility",icon:l?e.jsx(vt,{}):e.jsx(St,{}),onClick:()=>p(!l),variant:"ghost"})})]}),e.jsx(q,{children:d})]}),e.jsx(H,{mt:4,colorScheme:"blue",onClick:f,isLoading:i,width:"30%",children:"Đổi mật khẩu"})]})},zt=[{title:"Gửi mã",description:"Nhập email để nhận mã"},{title:"Xác nhận mã",description:"Nhập mã đã nhận được"},{title:"Đặt lại mật khẩu",description:"Đặt mật khẩu mới"},{title:"Hoàn thành",description:"Xong rồi"}],Vo=()=>{const t=Q(),[n,o]=r.useState(""),[a,s]=r.useState(""),[l,p]=r.useState(0),[i,g]=r.useState(!1),[d,m]=r.useState(0),{activeStep:h,setActiveStep:f}=Os({index:l,count:zt.length}),c=y=>{o(y),f(1),p(1)},v=y=>{s(y),f(2),p(2)},b=()=>{f(3),p(3)},x=async()=>{var y,D;if(!n){t({title:"Email không hợp lệ.",status:"warning",duration:3e3,isClosable:!0,variant:"top-accent",position:"top"});return}g(!0);try{await J.post("/auth/send-reset-code",{email:n}),t({title:"Mã xác thực đã được gửi lại.",status:"success",duration:3e3,isClosable:!0,variant:"top-accent",position:"top"}),s(""),m(u=>u+1)}catch(u){t({title:"Gửi lại mã thất bại.",description:((D=(y=u.response)==null?void 0:y.data)==null?void 0:D.message)||"Lỗi không xác định.",status:"error",duration:3e3,isClosable:!0,variant:"top-accent",position:"top"})}finally{g(!1)}};return e.jsxs(E,{maxWidth:"100%",mx:"auto",p:5,children:[e.jsx(Vs,{index:h,orientation:"horizontal",mb:8,children:zt.map(({title:y},D)=>e.jsxs(Gs,{children:[e.jsx($s,{children:e.jsx(qs,{complete:e.jsx(Qs,{}),incomplete:e.jsx(sn,{}),active:e.jsx(sn,{})})}),e.jsx(E,{flexShrink:"0",children:e.jsx(Ys,{fontSize:"sm",children:y})}),D!==zt.length-1&&e.jsx(Xs,{})]},y))}),l===0&&e.jsx(Ko,{onCodeSent:c}),l===1&&e.jsxs(e.Fragment,{children:[e.jsx(Wo,{email:n,onCodeVerified:v},d),e.jsxs(I,{mt:4,children:["Chưa nhận được mã?"," ",e.jsx(H,{variant:"link",colorScheme:"blue",onClick:x,width:"30%",isLoading:i,children:"Gửi lại"})]}),e.jsx(I,{ml:2,fontSize:"sm",color:"red",mt:2,fontStyle:"italic",children:"Nếu bạn không nhận được mã, hãy kiểm tra thư mục spam hoặc thử lại."})]}),l===2&&e.jsx(Oo,{email:n,code:a,onResetSuccess:b}),l===3&&e.jsxs(e.Fragment,{children:[e.jsx(I,{textAlign:"center",color:"green.600",fontWeight:"bold",mb:4,children:"Mật khẩu đã được đổi thành công! Vui lòng đăng nhập lại."}),e.jsx(H,{width:"full",colorScheme:"blue",onClick:()=>window.location.reload(),children:"Quay lại trang đăng nhập"})]})]})},Go=({onSuccess:t,onError:n})=>e.jsx(E,{display:"inline-block",width:"100%",children:e.jsx(Us,{onSuccess:o=>{t(o)},onError:()=>{n==null||n({message:"Đăng nhập Google thất bại"})},useOneTap:!1,text:"signin_with",shape:"pill",logo_alignment:"left",width:"100%"})}),Nt="/assets/codingImg-Bb6-a_gi.png",jn=()=>{const{isOpen:t,onOpen:n,onClose:o}=ie(),[a,s]=r.useState(!0),[l,p]=r.useState(!1),{coder:i,setCoder:g,logout:d,loginSuccessHandler:m}=tt(),h=Q(),c=(i!=null&&i.avatar?/\.gif(\?.*)?$/i.test(i.avatar):!1)?i.avatar.replace(/\.gif(\?.*)?$/i,".png"):(i==null?void 0:i.avatar)||"",v=()=>{p(!1),s(S=>!S)},b=S=>{S&&(g(S),p(!1),o(),m())},x=S=>{S&&(g(S),h({title:"Đăng ký thành công!",status:"success",duration:3e3,isClosable:!0,position:"top",variant:"top-accent"}),s(!0),p(!1),n())},y=()=>{p(!0),n()},D=()=>{p(!1),s(!0),o()},u=()=>l?"3xl":a?"md":"2xl",z=async S=>{var j,F;if(!(S!=null&&S.credential)){h({title:"Token không hợp lệ.",status:"error",duration:3e3,isClosable:!0,position:"top",variant:"top-accent"});return}try{const R=await J.post("/auth/google-login",{token:S.credential}),_=R==null?void 0:R.data;_!=null&&_.token?(g({accountID:_.accountID,roleID:_.roleID,coderName:_.coderName,token:_.token}),h({title:"Đăng nhập thành công!",status:"success",duration:3e3,isClosable:!0,position:"top",variant:"top-accent"}),p(!1),s(!0),o(),m()):h({title:"Đăng nhập thất bại!",description:"Token không hợp lệ hoặc thiếu thông tin.",status:"error",duration:3e3,isClosable:!0,position:"top",variant:"top-accent"})}catch(R){console.error("Lỗi khi đăng nhập Google:",R),h({title:"Lỗi đăng nhập Google",description:((F=(j=R==null?void 0:R.response)==null?void 0:j.data)==null?void 0:F.message)||R.message,status:"error",duration:3e3,isClosable:!0,position:"top",variant:"top-accent"})}},C=!!i;return e.jsxs(E,{bg:"transparent",children:[e.jsx(L,{justifyContent:"flex-end",gap:4,children:C?e.jsxs(L,{alignItems:"center",children:[(i.roleID===1||i.roleID===3)&&e.jsx(Ze,{to:"/admin/dashboard",children:e.jsx(H,{leftIcon:e.jsx(Js,{}),variant:"outline",_hover:{border:"1px solid blue"},_active:{transform:"scale(0.90)"},children:"Trang quản trị"})}),e.jsxs(Ft,{children:[e.jsx(Rt,{as:H,variant:"none",children:e.jsx(In,{borderRadius:"full",boxSize:"40px",objectFit:"cover",loading:"lazy",border:"3px solid blue",src:c||{LoginImg:Nt},fallbackSrc:Nt,fallback:e.jsx(Je,{src:Nt,boxSize:"40px"}),alt:i.coderName||"coder"})}),e.jsxs(_t,{p:2,children:[e.jsx(rt,{as:Ze,to:"/profile",_hover:{bg:"gray.200"},px:4,borderRadius:"md",children:"Hồ sơ cá nhân"}),e.jsx(rt,{_hover:{bg:"gray.200"},borderRadius:"md",color:"red",px:4,onClick:d,children:"Đăng xuất"})]})]})]}):e.jsxs(L,{gap:1,children:[e.jsx(H,{color:"black",onClick:()=>{s(!0),p(!1),n()},children:"Đăng nhập"}),e.jsx(H,{colorScheme:"blue",onClick:()=>{s(!1),p(!1),n()},leftIcon:e.jsx(Zs,{}),children:"Đăng ký"})]})}),e.jsxs(je,{size:u(),isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(de,{}),e.jsxs(fe,{children:[e.jsx(ve,{textAlign:"center",children:l?"Quên mật khẩu":a?"Đăng nhập":"Đăng ký"}),e.jsx(ye,{}),e.jsxs(he,{textAlign:"center",p:5,children:[l?e.jsx(Vo,{onSuccess:D}):a?e.jsx(Mo,{onSuccess:b,onForgotPassword:y}):e.jsx(Bo,{onSuccess:x}),!l&&e.jsx(H,{variant:"link",mt:3,onClick:v,children:a?"Chưa có tài khoản? Đăng ký":"Đã có tài khoản? Đăng nhập"}),e.jsx(ue,{my:3}),!l&&e.jsx(Go,{onSuccess:z,onError:S=>{console.error("Lỗi Google Login:",S),h({title:"Lỗi đăng nhập Google",description:(S==null?void 0:S.message)||"Đã xảy ra lỗi.",status:"error",duration:3e3,isClosable:!0,position:"top",variant:"top-accent"})}})]})]})]})]})},$o=({isOpen:t,onClose:n})=>{const[o,a]=r.useState(""),[s,l]=r.useState(null),[p,i]=r.useState([]),[g,d]=r.useState(!1),[m,h]=r.useState(!1),f=we(),c=r.useRef(null),v=r.useRef([]),b=G("white","gray.900"),x=G("black","white"),y=G("gray.200","gray.700"),D=G("gray.200","gray.700"),u=G("gray.700","white"),z=r.useRef(null);r.useEffect(()=>{t&&c.current&&(a(""),l(null),i([]),c.current.focus())},[t]),r.useEffect(()=>{s!==null&&v.current[s]&&v.current[s].scrollIntoView({behavior:"smooth",block:"nearest"})},[s]),r.useEffect(()=>{if(!o.trim()){i([]),h(!1);return}return z.current&&clearTimeout(z.current),z.current=setTimeout(async()=>{try{d(!0);const Y=(await J.get("/Searchs/suggestions",{params:{keyword:o}})).data.map(N=>{const k=Pn(N.name);let T="/";return N.type==="course"?T=`/course/${k}-${N.id}`:N.type==="blog"?T=`/blogs/${k}-${N.id}`:N.type==="coder"&&(T=`/profile/${N.id}`),{...N,path:T}});i(Y),h(!0)}catch(W){console.error("Search API error:",W),i([]),h(!0)}finally{d(!1)}},300),()=>clearTimeout(z.current)},[o]);const C=W=>{const Y=F();W.key==="ArrowDown"?l(N=>N===null||N===Y.length-1?0:N+1):W.key==="ArrowUp"?l(N=>N===null||N===0?Y.length-1:N-1):W.key==="Enter"&&s!==null&&S(Y[s])},S=W=>{f(W.path),a(""),i([]),n()},j=W=>{l(W)},F=()=>[...R.course,...R.coder,...R.blog],R={course:p.filter(W=>W.type==="course"),coder:p.filter(W=>W.type==="coder"),blog:p.filter(W=>W.type==="blog")},_=(W,Y,N)=>{if(Y.length===0)return null;const k=F().findIndex(T=>{var w;return T.type===((w=Y[0])==null?void 0:w.type)});return e.jsxs(be.Fragment,{children:[e.jsx(I,{px:4,pt:2,pb:1,bg:"blue.300",fontWeight:"semibold",color:"black",fontSize:"sm",children:W}),e.jsx(ue,{mb:2}),Y.map((T,w)=>{const O=k+w;return e.jsxs(Ct,{ref:ae=>v.current[O]=ae,onClick:()=>S(T),_hover:{cursor:"pointer",bg:y},px:4,py:2,borderRadius:"md",bg:s===O?D:"transparent",onMouseEnter:()=>j(O),children:[e.jsx(I,{fontWeight:"bold",color:u,children:T.name}),T.path&&e.jsx(I,{fontSize:"sm",color:"gray.500",children:T.path})]},`${T.type}-${T.id}`)}),e.jsx(ue,{mb:2})]},N)},A=["Nhập từ khóa...","Phím tắt Ctrl + K","Tìm kiếm người dùng...","Tìm kiếm bài viết...","Tìm kiếm bài học..."],[V]=gt.useTypewriter({words:A,loop:!0,delaySpeed:1e3});return r.useEffect(()=>{t||(a(""),l(null),i([]))},[t]),e.jsxs(je,{isOpen:t,size:"2xl",onClose:n,isCentered:!0,children:[e.jsx(de,{}),e.jsx(fe,{bg:b,children:e.jsxs(he,{px:2,onKeyDown:C,tabIndex:-1,minH:"40vh",children:[e.jsx(oe,{ref:c,placeholder:V,value:o,onChange:W=>a(W.target.value),mb:3,_focusVisible:{borderColor:x,borderWidth:"2px"},bg:"transparent",color:u}),g?e.jsx(L,{justify:"center",align:"center",py:6,minH:"20vh",children:e.jsx(Be,{size:"lg"})}):p.length>0?e.jsxs(ht,{ps:4,maxH:"50vh",overflowY:"auto",minH:"20vh",children:[_("📚 Khóa học",R.course,"course"),_("👤 Người dùng",R.coder,"coder"),_("📝 Bài viết",R.blog,"blog")]}):m&&o.trim()!==""?e.jsx(L,{justify:"center",align:"center",py:6,minH:"20vh",children:e.jsxs(I,{fontSize:"md",color:"gray.500",textAlign:"center",children:['❌ Không tìm thấy kết quả phù hợp với "',o,'"']})}):null,e.jsxs(L,{gap:"5",px:5,justify:"space-evenly",align:"center",my:2,children:[e.jsxs(I,{fontSize:"sm",color:"gray.600",mt:2,children:["Để chọn mục nhấn ",e.jsx(ot,{fontWeight:"bold",px:3,py:1,ml:1,children:"↲"})]}),e.jsxs(I,{fontSize:"sm",color:"gray.600",mt:2,children:["Di chuyển",e.jsx(ot,{px:3,fontWeight:"bold",py:1,ml:2,children:"↓"}),e.jsx(ot,{fontWeight:"bold",px:3,py:1,ml:2,children:"↑"})]})]})]})})]})};function Qn(t){const{routes:n}=t,{isOpen:o,onOpen:a,onClose:s}=ie(),{isOpen:l,onOpen:p,onClose:i}=ie(),g=be.useRef(),d=we(),m=b=>{d(b)},h=G("white","blue.200"),f=G("black","white"),c=["Nhập từ khóa...","Phím tắt Ctrl + K","Tìm kiếm bài viết...","Tìm kiếm bài học..."],[v]=gt.useTypewriter({words:c,loop:!0,delaySpeed:1e3});return r.useEffect(()=>{const b=x=>{(x.ctrlKey&&x.key==="K"||x.key==="k")&&(x.preventDefault(),p())};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[p]),e.jsxs(E,{position:"sticky",top:"0",left:"0",right:"0",bg:h,color:f,px:{base:"10px",md:"15px"},py:4,zIndex:"2",boxShadow:"lg",children:[e.jsxs(L,{align:"center",gap:0,justify:"space-between",children:[e.jsxs(L,{display:{base:"none",lg:"flex"},gap:1,children:[e.jsx(E,{fontSize:"xl",fontWeight:"bold",mr:10,cursor:"pointer",onClick:()=>m("/"),children:e.jsx(Je,{src:Ht,h:"40px"})}),e.jsx(bn,{direction:"row",routes:n})]}),e.jsxs(E,{display:{base:"none",lg:"flex"},gap:5,children:[e.jsx(Pt,{placeholder:v,boxShadow:"lg",borderRadius:"full",onClick:p,readOnly:!0}),e.jsx($o,{isOpen:l,onClose:i}),e.jsx(jn,{})]}),e.jsxs(L,{w:"100%",display:{base:"flex",lg:"none"},justifyContent:"space-between",children:[e.jsx($,{"aria-label":"Toggle Menu",icon:o?e.jsx(wn,{}):e.jsx(er,{}),onClick:a,variant:"ghost",color:f}),e.jsx(E,{fontSize:"xl",fontWeight:"bold",mr:10,cursor:"pointer",onClick:()=>m("/"),children:e.jsx(Je,{src:Ht,h:"40px"})})]})]}),o&&e.jsxs(Ln,{placement:"right",onClose:s,isOpen:o,finalFocusRef:g,children:[e.jsx(de,{}),e.jsxs(zn,{w:"285px",maxW:"285px",bg:h,color:f,children:[e.jsx(ye,{zIndex:"3",onClick:s,color:"red",bg:"white",_focus:{boxShadow:"none"},_hover:{boxShadow:"none"}}),e.jsx(he,{maxW:"285px",px:"0",pb:"0",children:e.jsx(Bt.Scrollbars,{autoHide:!0,renderTrackVertical:Gt,renderThumbVertical:$t,renderView:qt,children:e.jsxs(En,{spacing:3,p:3,my:"30px",children:[e.jsx(jn,{}),e.jsx(bn,{direction:"column",routes:n}),e.jsx(Pt,{placeholder:v,boxShadow:"lg",borderRadius:"full",onClick:p,readOnly:!0})]})})})]})]})]})}Qn.propTypes={logoText:ee.string,routes:ee.arrayOf(ee.object),variant:ee.string};const qo=r.lazy(()=>re(()=>import("./UpdateInfo-DLNV6fHS.js"),__vite__mapDeps([26,1,2,3,4,6,7]))),Qo=r.lazy(()=>re(()=>import("./UpdatePassword-CjUPV97N.js"),__vite__mapDeps([27,1,2,3,4,6,7]))),Yo=Wt.div,Xo={enter:t=>({x:t>0?300:-300,opacity:0}),center:{x:0,opacity:1},exit:t=>({x:t<0?300:-300,opacity:0})},Uo=({coderID:t,isOpen:n,onClose:o,onUpdated:a})=>{const[s,l]=r.useState(0),[p,i]=r.useState(0),g=d=>{i(d>s?1:-1),l(d)};return r.useEffect(()=>{n&&(l(0),i(0))},[n]),e.jsxs(je,{isOpen:n,onClose:o,size:s===0?"3xl":"md",isCentered:!0,scrollBehavior:"inside",children:[e.jsx(de,{}),e.jsxs(fe,{children:[e.jsx(ve,{textAlign:"center",children:"Thông tin lập trình viên"}),e.jsx(ye,{}),e.jsxs(tr,{isFitted:!0,colorScheme:"blue",index:s,onChange:g,children:[e.jsxs(nr,{px:4,pt:2,children:[e.jsx(rn,{children:"Cập nhật thông tin"}),e.jsx(rn,{children:"Đổi mật khẩu"})]}),e.jsx(he,{overflow:"auto",maxH:"70vh",px:4,pt:4,children:e.jsx(sr,{initial:!1,custom:p,children:e.jsx(Yo,{custom:p,variants:Xo,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3},children:e.jsx(r.Suspense,{fallback:e.jsx(Be,{}),children:s===0?e.jsx(qo,{coderID:t,onClose:o,onUpdated:a}):e.jsx(Qo,{coderID:t})})},s)})})]})]})]})},Jo=({info:t,isAllowShow:n,onOpen:o,isOpen:a,onClose:s,fetchData:l,coderID:p})=>e.jsxs(L,{flexDirection:"column",alignItems:"center",children:[e.jsx(On,{size:"2xl",name:"Coder Name",src:t.avatar,mb:4,border:"4px solid white"}),e.jsx(I,{fontSize:"2xl",color:"white",fontWeight:"bold",children:(t==null?void 0:t.coderName)||(t==null?void 0:t.coderEmail)||"Coder Name"}),e.jsxs(L,{my:2,align:"center",p:3,borderRadius:"md",boxShadow:"lg",bgGradient:"linear(to-r, #1a202c, #2d3748)",children:[e.jsx(I,{fontWeight:"bold",bgGradient:"linear(to-r, teal.200, purple.300)",bgClip:"text",fontSize:"md",children:"Tổng điểm:"}),e.jsxs(Ke,{colorScheme:"yellow",ms:2,fontSize:"md",px:3,py:1,children:[(t==null?void 0:t.totalPoint)||0,e.jsx(Le,{as:rr,color:"yellow.500"})]})]}),n&&e.jsxs(E,{children:[e.jsx(H,{bg:"blue",color:"white",size:"md",_hover:{bg:"blue.500"},rightIcon:e.jsx(Z,{}),onClick:o,children:"Chỉnh sửa thông tin"}),e.jsx(Uo,{coderID:p,isOpen:a,onClose:s,onUpdated:l})]})]}),Zo=({info:t,isCoderNameValid:n,isEmailValid:o,isPhoneValid:a,isAllowShow:s})=>e.jsxs(E,{textColor:"white",children:[e.jsx(I,{fontSize:"xl",mt:2,textTransform:"uppercase",fontWeight:"bold",children:"Thông tin"}),e.jsxs(L,{flexDirection:"column",gap:2,children:[e.jsxs(L,{align:"center",mt:2,mr:2,justify:"space-between",children:[e.jsxs(L,{align:"center",children:[e.jsx(or,{style:{marginRight:"8px"}}),e.jsx(Ie,{placement:"top",label:t!=null&&t.coderName?t==null?void 0:t.coderName:"Không có thông tin",hasArrow:!0,fontSize:"md",children:e.jsx(I,{fontSize:"md",children:(t==null?void 0:t.coderName)||""})})]}),e.jsx(L,{children:e.jsx(Ie,{placement:"top",label:n?"Đã xác thực":"Chưa xác thực",children:e.jsx(L,{align:"center",children:n?e.jsx(Le,{as:Tt,color:"green.300",boxSize:5}):e.jsx(Dt,{cursor:"pointer",style:{color:"red",fontSize:"18px"}})})})})]}),e.jsxs(L,{align:"center",mt:2,mr:2,justify:"space-between",children:[e.jsxs(L,{align:"center",children:[e.jsx(ar,{style:{marginRight:"4px"}}),e.jsx(Ie,{placement:"top",label:ln(t==null?void 0:t.coderEmail)||"Không có thông tin",hasArrow:!0,fontSize:"md",children:e.jsx(I,{fontSize:"md",children:ln(t==null?void 0:t.coderEmail)})})]}),e.jsx(L,{children:e.jsx(Ie,{placement:"top",label:o?"Đã xác thực":"Chưa xác thực",children:e.jsx(L,{align:"center",children:o?e.jsx(Le,{as:Tt,color:"green.300",boxSize:5}):e.jsx(Dt,{cursor:"pointer",style:{color:"red",fontSize:"18px"}})})})})]}),s&&e.jsxs(L,{align:"center",mt:2,mr:2,justify:"space-between",children:[e.jsxs(L,{align:"center",children:[e.jsx(ir,{style:{marginRight:"8px"}}),e.jsx(Ie,{placement:"top",label:(t==null?void 0:t.phoneNumber)||"Không có thông tin",hasArrow:!0,fontSize:"md",children:e.jsx(I,{fontSize:"md",children:(t==null?void 0:t.phoneNumber)||""})})]}),e.jsx(L,{children:e.jsx(Ie,{placement:"top",label:a?"Đã xác thực":"Chưa xác thực",children:e.jsx(L,{align:"center",children:a?e.jsx(Le,{as:Tt,color:"green.300",boxSize:5}):e.jsx(Dt,{cursor:"pointer",style:{color:"red",fontSize:"18px"}})})})})]}),e.jsx(L,{align:"center",mt:2,mr:2,justify:"space-between",children:e.jsxs(L,{align:"center",children:[e.jsx(lr,{style:{marginRight:"8px"}}),e.jsx(I,{fontSize:"md",children:t.birthDay?Kr(t.birthDay):""})]})})]})]}),ea=r.lazy(()=>re(()=>import("./CourseLearning-DQnGqFC6.js"),__vite__mapDeps([28,1,2,3,4,6,7]))),ta=r.lazy(()=>re(()=>import("./BlogBox-BUF6VZiE.js"),__vite__mapDeps([29,1,2,3,4,22,14,6,7]))),na=r.lazy(()=>re(()=>import("./ActionBox-zalO8Ji3.js"),__vite__mapDeps([30,1,2,3,4,6,7]))),sa=r.lazy(()=>re(()=>import("./HistorySubmission--q_FzdXx.js"),__vite__mapDeps([31,1,2,3,4,6,7]))),fn=()=>{_e("Hồ sơ cá nhân");const{id:t}=lt(),{isOpen:n,onOpen:o,onClose:a}=ie(),s=Q(),{coder:l}=tt(),{coderID:p}=l||{},i=p&&!t,[g,d]=r.useState({}),[m,h]=r.useState(!1),[f,c]=r.useState((g==null?void 0:g.description)||""),v=r.useCallback(async()=>{try{const S=await nt({controller:"Coder",id:t||p});S&&d(S)}catch(C){console.error("Error fetching data:",C)}},[t,p]);r.useEffect(()=>{v()},[v]),r.useEffect(()=>{m||c((g==null?void 0:g.description)||"")},[g==null?void 0:g.description,m]);const b=!!(g!=null&&g.coderName),x=!!(g!=null&&g.coderEmail),y=!!(g!=null&&g.phoneNumber),D=()=>{c((g==null?void 0:g.description)||""),h(!0)},u=()=>{c((g==null?void 0:g.description)||""),h(!1)},z=async()=>{var C,S;try{const j={description:f};console.log("Dữ liệu gửi lên API:",j),await He({controller:"Coder",id:p,data:j}),s({title:"Cập nhật thành công!",status:"success",duration:2e3,isClosable:!0,variant:"top-accent",position:"top"}),h(!1),v()}catch(j){console.error("Lỗi khi cập nhật:",j);const F=((S=(C=j.response)==null?void 0:C.data)==null?void 0:S.message)||j.message;s({title:"Lỗi khi cập nhật.",status:"error",description:F,duration:2e3,isClosable:!0,variant:"top-accent",position:"top"})}};return e.jsx(me,{children:e.jsxs(E,{maxW:"180vh",minH:"100vh",mx:"auto",mb:5,children:[e.jsx(E,{mt:5,ms:10,children:e.jsx(H,{colorScheme:"blue",variant:"link",size:"md",onClick:()=>window.history.back(),leftIcon:e.jsx(cr,{}),_hover:{transform:"translateX(-5px)"},children:"Quay lại"})}),e.jsxs(xe,{templateColumns:{base:"1fr",md:"1fr 2fr"},gap:4,mx:5,p:4,children:[e.jsxs(ne,{bgGradient:"linear(to-b, blue.600, purple.500)",p:4,borderRadius:"md",color:"black",display:"flex",flexDirection:"column",alignItems:"left",boxShadow:"md",maxW:"345px",children:[e.jsx(Jo,{info:g,isAllowShow:i,isOpen:n,onOpen:o,onClose:a,fetchData:v,coderID:p}),e.jsx(ue,{my:2}),e.jsx(Zo,{info:g,isCoderNameValid:b,isAllowShow:i,isEmailValid:x,isPhoneValid:y}),e.jsx(ue,{my:2}),e.jsxs(E,{textColor:"white",minH:"10vh",children:[e.jsx(I,{fontSize:"xl",mt:2,textTransform:"uppercase",fontWeight:"bold",children:"Giới thiệu"}),m?e.jsxs(E,{children:[e.jsx(ut,{value:f,onChange:C=>{C.target.value.length<=200&&c(C.target.value)},maxLength:200,mt:2,placeholder:"Nhập giới thiệu",bg:"white",color:"black",h:"100px",resize:"none"}),e.jsxs(L,{justify:"space-between",align:"center",mt:1,children:[e.jsxs(I,{fontSize:"sm",color:"white",children:[f.length,"/200 ký tự"]}),e.jsxs(L,{gap:2,children:[e.jsx($,{"aria-label":"save",icon:e.jsx(dr,{}),size:"sm",colorScheme:"green",onClick:z}),e.jsx($,{"aria-label":"cancel",icon:e.jsx(hr,{}),size:"sm",colorScheme:"red",onClick:u})]})]})]}):e.jsxs(L,{mt:2,justifyContent:"space-between",alignContent:"center",alignItems:"center",children:[e.jsx(I,{w:"100%",fontSize:"md",children:(g==null?void 0:g.description)||""}),i&&e.jsx(Ie,{placement:"top",label:"Chỉnh sửa",children:e.jsx($,{"aria-label":"edit",icon:e.jsx(ur,{}),size:"sm",color:"white",ml:2,bg:"transparent",_hover:{color:"black",bg:"gray.300"},onClick:D})})]})]})]}),e.jsxs(ne,{minW:"980px",children:[e.jsx(r.Suspense,{fallback:e.jsx(Ce,{height:"393px",w:"100%"}),children:e.jsx(ea,{coderID:t||p})}),e.jsxs(xe,{templateColumns:{base:"1fr",md:"1fr 0.7fr"},gap:4,h:"75vh",mt:5,children:[e.jsx(ne,{overflow:"hidden",children:e.jsx(r.Suspense,{fallback:e.jsx(Ce,{height:"100%",w:"100%"}),children:e.jsx(ta,{coderID:t||p})})}),e.jsx(ne,{overflow:"hidden",children:e.jsx(r.Suspense,{fallback:e.jsx(Ce,{height:"100%",w:"100%"}),children:e.jsx(na,{coderID:t||p})})})]}),e.jsx(ne,{mt:5,overflow:"hidden",children:e.jsx(r.Suspense,{fallback:e.jsx(Ce,{height:"393px",w:"100%"}),children:e.jsx(sa,{coderId:t||p})})})]})]})]})})};Wt(L);const Yn=()=>e.jsx(L,{justify:"center",align:"center",h:"100vh",bg:"white",children:e.jsx(Be,{thickness:"5px",speed:"0.35s",color:"blue.500",size:"xl"})}),ra=be.lazy(()=>re(()=>import("./NotFound-Ba0RH7_S.js"),__vite__mapDeps([25,1,2,3,4,6,7])));function oa(t){const{...n}=t,o=G("gray.200","navy.800"),a=G("black","white"),l=pt().pathname==="/user/full-screen-maps",p=r.useMemo(()=>Re.filter(g=>g.layout==="/user"),[]),i=()=>{const g=[];return p.forEach((d,m)=>{const h=d.protected?e.jsx(Ue,{children:d.component},`route-${m}`):be.cloneElement(d.component,{key:`route-${m}`});g.push(e.jsx(Se,{path:d.path,element:h},`route-${m}`)),d.item&&Array.isArray(d.item)&&d.item.forEach((f,c)=>{const v=`${d.path}/${f.path}`,b=f.protected?e.jsx(Ue,{children:f.component},`subroute-${m}-${c}`):be.cloneElement(f.component,{key:`subroute-${m}-${c}`});g.push(e.jsx(Se,{path:v,element:b},`subroute-${m}-${c}`))})}),g.push(e.jsx(Se,{path:"/profile",element:e.jsx(Ue,{children:e.jsx(fn,{})})},"profile-main"),e.jsx(Se,{path:"/profile/:id",element:e.jsx(Ue,{children:e.jsx(fn,{})})},"profile-id"),e.jsx(Se,{path:"*",element:e.jsx(ra,{})},"not-found")),g};return e.jsxs(E,{bg:o,color:a,h:"100vh",display:"flex",flexDirection:"column",children:[e.jsx(Qn,{routes:p,...n}),!l&&e.jsx(E,{flex:"1",w:"100%",overflowX:"hidden",overflowY:"auto",position:"relative",bg:o,color:a,mx:{lg:"auto",md:"0"},transition:"all 0.33s cubic-bezier(0.685, 0.0473, 0.346, 1)",transitionDuration:".2s, .2s, .35s",transitionProperty:"top, bottom, width",transitionTimingFunction:"linear, linear, ease",children:e.jsx(r.Suspense,{fallback:e.jsx(Yn,{}),children:e.jsx(Kt,{children:i()})})})]})}const aa={baseStyle:t=>({p:"20px",display:"flex",flexDirection:"column",width:"100%",position:"relative",borderRadius:"20px",minWidth:"0px",wordWrap:"break-word",bg:K("#ffffff","navy.800")(t),boxShadow:K("14px 17px 40px 4px rgba(112, 144, 176, 0.08)","unset")(t),backgroundClip:"border-box"})},ia={components:{Card:aa}},la={components:{Button:{baseStyle:{borderRadius:"16px",boxShadow:"45px 76px 113px 7px rgba(112, 144, 176, 0.08)",transition:".25s all ease",boxSizing:"border-box",_focus:{boxShadow:"none"},_active:{boxShadow:"none"}},variants:{outline:()=>({borderRadius:"16px"}),brand:t=>({bg:K("brand.500","brand.400")(t),color:"white",_focus:{bg:K("brand.500","brand.400")(t)},_active:{bg:K("brand.500","brand.400")(t)},_hover:{bg:K("brand.600","brand.400")(t)}}),darkBrand:t=>({bg:K("brand.900","brand.400")(t),color:"white",_focus:{bg:K("brand.900","brand.400")(t)},_active:{bg:K("brand.900","brand.400")(t)},_hover:{bg:K("brand.800","brand.400")(t)}}),lightBrand:t=>({bg:K("#F2EFFF","whiteAlpha.100")(t),color:K("brand.500","white")(t),_focus:{bg:K("#F2EFFF","whiteAlpha.100")(t)},_active:{bg:K("secondaryGray.300","whiteAlpha.100")(t)},_hover:{bg:K("secondaryGray.400","whiteAlpha.200")(t)}}),light:t=>({bg:K("secondaryGray.300","whiteAlpha.100")(t),color:K("secondaryGray.900","white")(t),_focus:{bg:K("secondaryGray.300","whiteAlpha.100")(t)},_active:{bg:K("secondaryGray.300","whiteAlpha.100")(t)},_hover:{bg:K("secondaryGray.400","whiteAlpha.200")(t)}}),action:t=>({fontWeight:"500",borderRadius:"50px",bg:K("secondaryGray.300","brand.400")(t),color:K("brand.500","white")(t),_focus:{bg:K("secondaryGray.300","brand.400")(t)},_active:{bg:K("secondaryGray.300","brand.400")(t)},_hover:{bg:K("secondaryGray.200","brand.400")(t)}}),setup:t=>({fontWeight:"500",borderRadius:"50px",bg:K("transparent","brand.400")(t),border:K("1px solid","0px solid")(t),borderColor:K("secondaryGray.400","transparent")(t),color:K("secondaryGray.900","white")(t),_focus:{bg:K("transparent","brand.400")(t)},_active:{bg:K("transparent","brand.400")(t)},_hover:{bg:K("secondaryGray.100","brand.400")(t)}})}}}},ca={components:{Badge:{baseStyle:{borderRadius:"10px",lineHeight:"100%",padding:"7px",paddingLeft:"12px",paddingRight:"12px"},variants:{outline:()=>({borderRadius:"16px"}),brand:t=>({bg:K("brand.500","brand.400")(t),color:"white",_focus:{bg:K("brand.500","brand.400")(t)},_active:{bg:K("brand.500","brand.400")(t)},_hover:{bg:K("brand.600","brand.400")(t)}})}}}},da={components:{Input:{baseStyle:{field:{fontWeight:400,borderRadius:"8px"}},variants:{main:t=>({field:{bg:K("transparent","navy.800")(t),border:"1px solid",color:K("secondaryGray.900","white")(t),borderColor:K("secondaryGray.100","whiteAlpha.100")(t),borderRadius:"16px",fontSize:"sm",p:"20px",_placeholder:{color:"secondaryGray.400"}}}),auth:t=>({field:{fontWeight:"500",color:K("navy.700","white")(t),bg:K("transparent","transparent")(t),border:"1px solid",borderColor:K("secondaryGray.100","rgba(135, 140, 189, 0.3)")(t),borderRadius:"16px",_placeholder:{color:"secondaryGray.600",fontWeight:"400"}}}),authSecondary:t=>({field:{bg:"transparent",border:"1px solid",borderColor:"secondaryGray.100",borderRadius:"16px",_placeholder:{color:"secondaryGray.600"}}}),search:t=>({field:{border:"none",py:"11px",borderRadius:"inherit",_placeholder:{color:"secondaryGray.600"}}})}},NumberInput:{baseStyle:{field:{fontWeight:400}},variants:{main:t=>({field:{bg:"transparent",border:"1px solid",borderColor:"secondaryGray.100",borderRadius:"16px",_placeholder:{color:"secondaryGray.600"}}}),auth:t=>({field:{bg:"transparent",border:"1px solid",borderColor:"secondaryGray.100",borderRadius:"16px",_placeholder:{color:"secondaryGray.600"}}}),authSecondary:t=>({field:{bg:"transparent",border:"1px solid",borderColor:"secondaryGray.100",borderRadius:"16px",_placeholder:{color:"secondaryGray.600"}}}),search:t=>({field:{border:"none",py:"11px",borderRadius:"inherit",_placeholder:{color:"secondaryGray.600"}}})}},Select:{baseStyle:{field:{fontWeight:400}},variants:{main:t=>({field:{bg:K("transparent","navy.800")(t),border:"1px solid",color:"secondaryGray.600",borderColor:K("secondaryGray.100","whiteAlpha.100")(t),borderRadius:"16px",_placeholder:{color:"secondaryGray.600"}},icon:{color:"secondaryGray.600"}}),mini:t=>({field:{bg:K("transparent","navy.800")(t),border:"0px solid transparent",fontSize:"0px",p:"10px",_placeholder:{color:"secondaryGray.600"}},icon:{color:"secondaryGray.600"}}),subtle:t=>({box:{width:"unset"},field:{bg:"transparent",border:"0px solid",color:"secondaryGray.600",borderColor:"transparent",width:"max-content",_placeholder:{color:"secondaryGray.600"}},icon:{color:"secondaryGray.600"}}),transparent:t=>({field:{bg:"transparent",border:"0px solid",width:"min-content",color:K("secondaryGray.600","secondaryGray.600")(t),borderColor:"transparent",padding:"0px",paddingLeft:"8px",paddingRight:"20px",fontWeight:"700",fontSize:"14px",_placeholder:{color:"secondaryGray.600"}},icon:{transform:"none !important",position:"unset !important",width:"unset",color:"secondaryGray.600",right:"0px"}}),auth:t=>({field:{bg:"transparent",border:"1px solid",borderColor:"secondaryGray.100",borderRadius:"16px",_placeholder:{color:"secondaryGray.600"}}}),authSecondary:t=>({field:{bg:"transparent",border:"1px solid",borderColor:"secondaryGray.100",borderRadius:"16px",_placeholder:{color:"secondaryGray.600"}}}),search:t=>({field:{border:"none",py:"11px",borderRadius:"inherit",_placeholder:{color:"secondaryGray.600"}}})}}}},ha={components:{Progress:{baseStyle:{field:{fontWeight:400,w:"16px",h:"16px",borderRadius:"20px",_checked:{transform:"translate(20px, 0px)"}},track:{w:"40px",h:"20px",borderRadius:"20px",_focus:{boxShadow:"none"}}},variants:{table:t=>({field:{bg:"brand.500",borderRadius:"16px",fontSize:"sm"},track:{borderRadius:"20px",bg:K("blue.50","whiteAlpha.50")(t),h:"8px",w:"54px"},thumb:{w:"250px"}})}}}},ua={components:{RangeSlider:{variants:{main:t=>({thumb:{bg:K("brand.500","brand.400")(t)}})}}}},pa={components:{Textarea:{baseStyle:{field:{fontWeight:400,borderRadius:"8px"}},variants:{main:t=>({field:{bg:K("transparent","navy.800")(t),border:"1px solid !important",color:K("secondaryGray.900","white")(t),borderColor:K("secondaryGray.100","whiteAlpha.100")(t),borderRadius:"16px",fontSize:"sm",p:"20px",_placeholder:{color:"secondaryGray.400"}}}),auth:t=>({field:{bg:"white",border:"1px solid",borderColor:"secondaryGray.100",borderRadius:"16px",_placeholder:{color:"secondaryGray.600"}}}),authSecondary:t=>({field:{bg:"white",border:"1px solid",borderColor:"secondaryGray.100",borderRadius:"16px",_placeholder:{color:"secondaryGray.600"}}}),search:t=>({field:{border:"none",py:"11px",borderRadius:"inherit",_placeholder:{color:"secondaryGray.600"}}})}}}},ga={components:{Switch:{baseStyle:{thumb:{fontWeight:400,borderRadius:"50%",w:"16px",h:"16px",_checked:{transform:"translate(20px, 0px)"}},track:{display:"flex",alignItems:"center",boxSizing:"border-box",w:"40px",h:"20px",p:"2px",ps:"2px",_focus:{boxShadow:"none"}}},variants:{main:t=>({track:{bg:K("gray.300","navy.700")(t)}})}}}},xa={components:{Link:{baseStyle:{textDecoration:"none",boxShadow:"none",_focus:{boxShadow:"none"},_active:{boxShadow:"none"},_hover:{textDecoration:"none",border:"none"}},_hover:{textDecoration:"none",border:"none"}}}},ma=pr({sm:"320px","2sm":"380px",md:"768px",lg:"960px",xl:"1200px","2xl":"1600px","3xl":"1920px"}),ba={colors:{brand:{100:"#E9E3FF",200:"#422AFB",300:"#422AFB",400:"#7551FF",500:"#422AFB",600:"#3311DB",700:"#02044A",800:"#190793",900:"#11047A"},brandScheme:{100:"#E9E3FF",200:"#7551FF",300:"#7551FF",400:"#7551FF",500:"#422AFB",600:"#3311DB",700:"#02044A",800:"#190793",900:"#02044A"},brandTabs:{100:"#E9E3FF",200:"#422AFB",300:"#422AFB",400:"#422AFB",500:"#422AFB",600:"#3311DB",700:"#02044A",800:"#190793",900:"#02044A"},secondaryGray:{100:"#E0E5F2",200:"#E1E9F8",300:"#F4F7FE",400:"#E9EDF7",500:"#8F9BBA",600:"#A3AED0",700:"#707EAE",800:"#707EAE",900:"#1B2559"},red:{100:"#FEEFEE",500:"#EE5D50",600:"#E31A1A"},blue:{50:"#EFF4FB",500:"#3965FF"},orange:{100:"#FFF6DA",500:"#FFB547"},green:{100:"#E6FAF5",500:"#01B574"},navy:{50:"#d0dcfb",100:"#aac0fe",200:"#a3b9f8",300:"#728fea",400:"#3652ba",500:"#1b3bbb",600:"#24388a",700:"#1B254B",800:"#111c44",900:"#0b1437"},gray:{100:"#FAFCFE"}},styles:{global:t=>({body:{overflowX:"hidden",bg:K("secondaryGray.300","navy.900")(t),fontFamily:"DM Sans",letterSpacing:"-0.5px"},input:{color:"gray.700"},html:{fontFamily:"DM Sans"}})}},ja=gr({breakpoints:ma},ba,ca,la,xa,ha,ua,da,pa,ga,ia),fa=()=>{const t=pt(),{isLoading:n}=tt();return r.useEffect(()=>{n?Xe.start():Xe.done()},[n]),r.useEffect(()=>{Xe.start();const o=setTimeout(()=>{n||Xe.done()},300);return()=>{clearTimeout(o)}},[t]),null};function ya(){const[t,n]=r.useState(ja),{isLoading:o}=tt(),[a,s]=r.useState(o);return r.useEffect(()=>{let l;return o?s(!0):l=setTimeout(()=>s(!1),1e3),()=>clearTimeout(l)},[o]),e.jsxs(xr,{theme:t,children:[e.jsx(fa,{}),a?e.jsx(Yn,{}):e.jsxs(Kt,{children:[e.jsx(Se,{path:"admin/*",element:e.jsx(Ue,{allowedRoles:[1,3],children:e.jsx(Ao,{theme:t,setTheme:n})})}),e.jsx(Se,{path:"/*",element:e.jsx(oa,{theme:t,setTheme:n})})]})]})}Te.locale("vi");const Ca=new mr,va=br.createRoot(document.getElementById("root"));va.render(e.jsx(wr,{children:e.jsx(jr,{future:{v7_relativeSplatPath:!0},children:e.jsxs(fr,{client:Ca,children:["  ",e.jsx(yr,{clientId:void 0,children:e.jsx(vr,{children:e.jsx(ya,{})})})]})})}));export{qe as A,Hn as B,Ge as C,He as D,An as E,Wn as I,Wr as L,Hr as N,Oe as P,me as S,Ve as T,J as a,tt as b,Nt as c,$e as d,Ar as e,Or as f,Da as g,X as h,On as i,Na as j,Vt as k,La as l,ze as m,za as n,nt as o,At as p,Ea as q,Qe as r,at as s,Pn as t,_e as u,Pt as v,po as w,uo as x,st as y,Kr as z};
