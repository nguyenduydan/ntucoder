import{b as n,j as e,aC as p,f as we,bz as Ce,_ as oe,B as h,H as ae,T as t,aD as le,aq as G,ar as Ee,ae as Me,F as B,m as b,D as ce,v as He,aE as U,w as I,bh as Fe,bw as $e,aB as ke,I as Ne,g as ve,z as We,c5 as Oe,n as _e,ad as re,c6 as he,aG as Ie,a0 as De,aH as ze,a2 as Re,a4 as Ae,ac as Te,as as Pe,ai as Ge,h as Ke,c7 as Ye,V as Ve,c1 as X,c4 as Xe,an as de,bB as xe,c8 as ge,c9 as pe,ca as me,cb as ue,bZ as je,bv as Ue,bx as se,b$ as Ze,c0 as te,L as fe,E as be,cc as qe,cd as Je,ce as Qe,cf as es,cg as ss,ch as ts,ci as ns}from"./vendor-BGniOJC6.js";import{b as Z,a as F,i as rs,m as is,n as as,o as ye,u as os,S as ls,s as Se,k as ne}from"./index-PLasXggS.js";import"./charts-vendor-CYURHQdq.js";import"./lodash-vendor-CS6reBND.js";import"./axios-vendor-xsH4HHeE.js";import"./moment-vendor-CTDujYFw.js";function cs({value:r,onChange:u}){const[o,s]=n.useState(0);return e.jsx(p,{spacing:.5,children:[1,2,3,4,5].map(i=>e.jsx(we,{icon:e.jsx(Ce,{fontSize:"24px"}),variant:"ghost",color:i<=(o||r)?"yellow.400":"gray.300",onMouseEnter:()=>s(i),onMouseLeave:()=>s(0),onClick:()=>u(i),"aria-label":`Chọn ${i} sao`,size:"lg",boxSize:"40px",_hover:{transform:"scale(1.2)"}},i))})}const hs=({courseId:r})=>{const{isAuthenticated:u}=Z(),[o,s]=n.useState({rating:5,content:""}),[i,d]=n.useState([]),[D,m]=n.useState(!0),[C,z]=n.useState([0,0,0,0,0]),x=oe(),[k,R]=n.useState(!1),$=k?i:i.slice(0,5),T=()=>{R(a=>!a)},j=n.useCallback(async()=>{try{const f=(await F.get(`/Review?courseId=${r}`)).data||[];d(f);const A=[0,0,0,0,0];f.forEach(E=>A[E.rating-1]++),z(A.reverse())}catch(a){x({title:"Lỗi",description:a.message,status:"error"})}finally{m(!1)}},[r,x]),L=async()=>{try{const a=await F.post(`/Review?courseId=${r}`,o);(a.status===200||a.status===201)&&(x({title:"Thành công",description:"Đánh giá đã được gửi!",status:"success",variant:"top-accent",duration:2e3,position:"top",isClosable:!0}),s({...o,content:"",rating:5})),j()}catch(a){x({title:"Thất bại",description:a.message,status:"error",variant:"top-accent",duration:2e3,position:"top",isClosable:!0})}};n.useEffect(()=>{j()},[j]);const v=i.length,H=v>0?(i.reduce((a,f)=>a+f.rating,0)/v).toFixed(1):0;return e.jsxs(h,{mx:"auto",p:4,children:[e.jsx(ae,{size:"lg",mb:4,children:"Đánh giá khóa học"}),e.jsxs(p,{spacing:6,align:"start",mb:6,children:[e.jsxs(h,{minW:"200px",children:[e.jsx(t,{fontSize:"5xl",children:H}),e.jsx(p,{children:[...Array(5)].map((a,f)=>e.jsx(le,{boxSize:7,color:f<Math.round(H)?"yellow.400":"gray.300"},f))}),e.jsxs(t,{color:"gray.500",mt:3,children:["(",v," đánh giá)"]})]}),e.jsx(G,{align:"start",flex:1,children:[5,4,3,2,1].map((a,f)=>{const A=v?Math.round(C[f]/v*100):0;return e.jsxs(p,{w:"100%",children:[e.jsxs(t,{w:"30px",flex:"0.1",children:[a," sao"]}),e.jsx(Ee,{value:A,flex:"1",size:"sm",colorScheme:"yellow",bg:"gray.200",rounded:"md",sx:{"& > div":{backgroundColor:"yellow.400"}}}),e.jsxs(t,{w:"40px",textAlign:"right",color:"gray.400",children:[A,"%"]})]},a)})})]}),u&&e.jsxs(h,{mb:8,children:[e.jsx(ae,{size:"md",mb:3,children:"Viết đánh giá"}),e.jsx(Me,{placeholder:"Nội dung đánh giá của bạn...",value:o.content,onChange:a=>s({...o,content:a.target.value}),mb:3,resize:"none",h:"140px"}),e.jsxs(B,{justify:"flex-end",children:[e.jsx(cs,{value:o.rating,onChange:a=>s({...o,rating:a})}),e.jsx(b,{colorScheme:"blue",ml:3,onClick:L,isDisabled:o.content.length===0,children:"Gửi đánh giá"})]})]}),e.jsx(ce,{mb:6}),e.jsx(ae,{size:"md",mb:4,children:"Đánh giá của người học"}),D?e.jsx(He,{}):$.length===0?e.jsx(t,{children:"Chưa có đánh giá nào."}):$.map(a=>e.jsxs(h,{mb:2,p:3,borderRadius:"md",children:[e.jsxs(p,{mb:1,children:[e.jsx(rs,{coderID:a.coderID,size:"sm"}),e.jsxs(h,{children:[e.jsx(U,{to:`/profile/${a.coderID}`,children:e.jsx(t,{_hover:{color:"blue"},fontWeight:"bold",children:(a.coderName||"Ẩn danh").replace(/(.{3}).*(@.*)/,"$1******$2")})}),e.jsxs(p,{spacing:1,children:[[...Array(5)].map((f,A)=>e.jsx(I,{as:le,color:A<a.rating?"yellow.400":"gray.300"},A)),e.jsx(t,{fontSize:"xs",color:"gray.500",children:is(a.createdAt)})]})]})]}),e.jsx(t,{mt:2,children:a.content}),e.jsx(ce,{mt:2})]},a.reviewID)),i.length>5&&e.jsx(b,{mt:4,variant:"outline",colorScheme:"black",_hover:{bg:"black",color:"white"},onClick:T,children:k?"Thu gọn":"Xem thêm"})]})},ds=Fe(h),xs={hidden:{opacity:0,y:-50},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}},normal:{opacity:1,y:0}},gs=({children:r,offsetTop:u=64,...o})=>{const s=n.useRef(null),[i,d]=n.useState(!1),[D,m]=n.useState(0),[C,z]=n.useState(0);return n.useEffect(()=>{const x=s.current;if(!x)return;const k=x.getBoundingClientRect().top+window.scrollY;m(x.offsetHeight);const R=()=>{const T=window.scrollY+u>=k;T&&!i?(d(!0),z(j=>j+1)):!T&&i&&d(!1)};return window.addEventListener("scroll",R),()=>window.removeEventListener("scroll",R)},[i,u]),e.jsxs(h,{children:[i&&e.jsx(h,{height:`${D}px`}),e.jsx(ds,{ref:s,position:i?"fixed":"static",top:i?`${u}px`:"auto",left:0,zIndex:"100",width:"100%",bg:"white",boxShadow:i?"md":"none",borderBottom:"1px solid",borderColor:"gray.200",variants:xs,initial:i?"hidden":"normal",animate:i?"visible":"normal",...o,children:e.jsx($e,{height:i?"75px":"auto",justifyContent:i?"center":"flex-start",children:r})},C)]})},ps=({coder:r,newComment:u,setNewComment:o,handleAddComment:s,...i})=>e.jsxs(p,{mt:3,align:"center",spacing:3,px:5,children:[e.jsx(ke,{size:"sm",name:(r==null?void 0:r.name)||"Bạn",src:(r==null?void 0:r.avatar)||"https://bit.ly/prosper-baba"}),e.jsxs(Ne,{bg:"white",children:[e.jsx(ve,{pr:"5.5rem",placeholder:"Viết bình luận...",boxShadow:"md",value:u,onChange:d=>o(d.target.value),onKeyDown:d=>d.key==="Enter"&&s(),...i}),e.jsx(We,{width:"3rem",children:e.jsx(we,{icon:e.jsx(Oe,{}),colorScheme:"green",size:"sm",onClick:s,"aria-label":"Gửi bình luận"})})]})]}),ms=5,Le=({comment:r,onReply:u,onDelete:o,globalExpand:s})=>{var E,N;const{coder:i,isAuthenticated:d}=Z(),D=oe(),[m,C]=n.useState(!1),[z,x]=n.useState(""),[k,R]=n.useState(!1),[$,T]=n.useState(!1),j=n.useRef();n.useEffect(()=>{R(s)},[s]);const L=()=>T(!0),v=()=>T(!1),H=async()=>{if(z.trim()!=="")try{const y={content:z.trim(),courseID:r.courseID,parentCommentID:r.commentID},K=(i==null?void 0:i.token)||localStorage.getItem("token"),O=await F.post("/comments",y,{headers:{Authorization:`Bearer ${K}`}});u(r.commentID,{...O.data,replies:[]}),x(""),C(!1),R(!0)}catch(y){console.error("Add reply error",y),D({title:"Lỗi khi gửi bình luận",status:"error",position:"top",variant:"top-accent",duration:"1000"})}},a=()=>{C(!0),x(`@${r.coderName} `)},f=()=>{C(!1),x("")},A=async()=>{try{await F.delete(`/comments/${r.commentID}`),o(r.commentID),D({title:"Bạn đã xóa bình luận này",status:"success",position:"top",variant:"top-accent",duration:"1000"}),v()}catch(y){console.error("Delete comment error",y),D({title:"Bạn không thể xóa bình luận này",status:"error",position:"top",variant:"top-accent",duration:"1000"}),v()}};return e.jsxs(h,{children:[e.jsxs(B,{align:"flex-start",mb:2,position:"relative",children:[e.jsx(ke,{size:"sm",name:r.coderName,src:r.coderAvatar,mr:3,mt:5,zIndex:1}),e.jsxs(h,{bg:"gray.200",p:3,borderRadius:"md",w:"full",zIndex:1,children:[e.jsxs(B,{justify:"space-between",align:"center",children:[e.jsx(U,{to:`/profile/${r.coderID}`,children:e.jsx(t,{fontWeight:"bold",fontSize:"sm",children:r.coderName})}),d&&(i==null?void 0:i.coderID)===r.coderID&&e.jsx(b,{size:"xs",colorScheme:"red",variant:"ghost",onClick:L,children:"Xóa"})]}),e.jsx(t,{fontSize:"sm",mt:1,children:r.content}),e.jsxs(p,{mt:2,spacing:4,children:[e.jsx(t,{fontSize:"xs",color:"gray.500",children:as(r.commentTime)}),e.jsx(b,{size:"xs",variant:"link",colorScheme:"blue",onClick:a,children:"Trả lời"}),((E=r.replies)==null?void 0:E.length)>0&&e.jsx(b,{size:"xs",variant:"link",colorScheme:"gray",onClick:()=>R(!k),children:k?"Ẩn trả lời":`Xem ${r.replies.length} trả lời`})]}),e.jsx(he,{in:m,animateOpacity:!0,children:d&&e.jsx(G,{mt:2,align:"stretch",spacing:1,children:e.jsxs(p,{children:[e.jsx(ve,{placeholder:"Trả lời bình luận...",value:z,autoFocus:!0,bg:"white",onChange:y=>x(y.target.value),onKeyDown:y=>y.key==="Enter"&&H()}),e.jsx(b,{size:"sm",colorScheme:"blue",onClick:H,children:"Gửi"}),e.jsx(b,{size:"sm",variant:"outline",colorScheme:"red",onClick:f,children:"Hủy"})]})})})]})]}),e.jsx(he,{in:k,animateOpacity:!0,children:e.jsx(h,{pl:10,position:"relative",children:(N=r.replies)==null?void 0:N.map(y=>e.jsx(Le,{comment:y,onReply:()=>{},onDelete:o,globalExpand:s},y.commentID))})}),e.jsx(Ie,{isOpen:$,leastDestructiveRef:j,onClose:v,isCentered:!0,children:e.jsx(De,{children:e.jsxs(ze,{children:[e.jsx(Re,{fontSize:"lg",fontWeight:"bold",children:"Xác nhận xóa"}),e.jsx(Ae,{children:"Bạn có chắc muốn xóa bình luận này? Hành động này không thể hoàn tác."}),e.jsxs(Te,{children:[e.jsx(b,{ref:j,onClick:v,children:"Hủy"}),e.jsx(b,{colorScheme:"red",onClick:A,ml:3,children:"Xóa"})]})]})})})]})},us=({courseId:r})=>{const u=n.useRef(null),{coder:o,isAuthenticated:s}=Z(),[i,d]=n.useState([]),[D,m]=n.useState(""),[C,z]=n.useState(!1),[x,k]=n.useState(!1),[R,$]=n.useState(!0),[T,j]=n.useState(1),[L,v]=n.useState(!1),[H,a]=n.useState("CommentTime"),[f,A]=n.useState(!1),E=async(l=1,M=!1,S=ms)=>{try{l===1?z(!0):k(!0);const w=await F.get("/comments",{params:{courseId:r,page:l,pageSize:S,sortBy:H,ascending:f}}),Y=w.data.data||[],J=w.data.totalPages||1;d(M?c=>[...c,...Y]:Y),j(l),$(l<J)}catch(w){console.error("Load comments error",w)}finally{z(!1),k(!1)}},N=n.useCallback(()=>{if(!u.current||x||C||!R)return;const{scrollTop:l,scrollHeight:M,clientHeight:S}=u.current;M-l-S<100&&E(T+1,!0)},[T,E,R,x,C]);n.useEffect(()=>{const l=u.current;if(l)return l.addEventListener("scroll",N),()=>{l.removeEventListener("scroll",N)}},[N]),n.useEffect(()=>{r&&(L?E(1,!1,9999):E(1,!1))},[r,H,f,L]);const y=l=>{d(M=>M.filter(S=>S.commentID!==l).map(S=>({...S,replies:S.replies?S.replies.filter(w=>w.commentID!==l):[]})))},K=async()=>{if(D.trim()!==""){if(!s){alert("Bạn cần đăng nhập để bình luận");return}try{const l={content:D.trim(),courseID:r,parentCommentID:null},M=(o==null?void 0:o.token)||localStorage.getItem("token"),S=await F.post("/comments",l,{headers:{Authorization:`Bearer ${M}`}});d(w=>[{...S.data,replies:[]},...w]),m("")}catch(l){console.error("Add comment error",l),alert("Lỗi khi gửi bình luận")}}},O=(l,M)=>{d(S=>S.map(w=>w.commentID===l?{...w,replies:[...w.replies||[],M]}:w))},q=()=>{v(l=>!l)};return C?e.jsx(t,{textAlign:"center",children:"Đang tải bình luận..."}):e.jsxs(h,{w:"100%",maxW:"100%",mx:"auto",px:4,py:2,children:[!s&&e.jsx(t,{color:"red",fontStyle:"italic",children:"**Đăng nhập để có thể bình luận"}),e.jsxs(B,{justify:"space-between",align:"center",mb:4,flexWrap:"wrap",gap:2,children:[e.jsx(t,{fontSize:"lg",fontWeight:"bold",children:"Bình luận"}),e.jsxs(p,{spacing:2,children:[e.jsx(b,{colorScheme:"navy",px:4,py:2,onClick:q,maxW:"150px",whiteSpace:"normal",children:e.jsx(t,{fontSize:"12px",textAlign:"center",children:L?"Thu gọn tất cả trả lời":"Xem tất cả trả lời"})}),e.jsxs(_e,{ms:4,size:"sm",value:f?"asc":"desc",onChange:l=>A(l.target.value==="asc"),borderRadius:"md",children:[e.jsx("option",{value:"desc",children:"Mới nhất trước"}),e.jsx("option",{value:"asc",children:"Cũ nhất trước"})]})]})]}),e.jsx(h,{height:"400px",overflowY:"auto",borderColor:"gray.200",borderRadius:"md",bg:"white",ref:u,px:4,py:2,children:e.jsxs(G,{spacing:4,align:"stretch",children:[i.map(l=>e.jsx(Le,{comment:l,onReply:O,onDelete:y,globalExpand:L},l.commentID)),x&&e.jsxs(G,{spacing:3,mt:3,children:[e.jsx(re,{height:"20px",width:"100%"}),e.jsx(re,{height:"20px",width:"90%"}),e.jsx(re,{height:"20px",width:"95%"})]})]})}),s&&e.jsx(ps,{coder:o,newComment:D,setNewComment:m,handleAddComment:K})]})},Cs=()=>{var O,q,l,M,S,w,Y,J;const{slugId:r}=Pe(),u=r?r.split("-"):[],o=u.length>0?parseInt(u.pop(),10):NaN,[s,i]=n.useState(null),[d,D]=n.useState(!0),m=oe(),C=Ge(),z=Ke(),[x,k]=n.useState(!1),[R,$]=n.useState([]),T=Z(),{coder:j}=Z(),L=n.useCallback(async()=>{if(isNaN(o)){m({title:"Lỗi",description:"ID không hợp lệ!",status:"error",duration:3e3,isClosable:!0}),D(!1),C("/course");return}try{const c=await ye({controller:"Course",id:o});if(!c||Object.keys(c).length===0){m({title:"Cảnh báo",description:"Không có dữ liệu cho khóa học này.",status:"warning",duration:3e3,isClosable:!0}),i(null);return}const g=c.topics||[],_=await Promise.all(g.map(async W=>{try{const ee=((await ye({controller:"Topic",id:W.topicID})).lessons||[]).filter(V=>Number(V.status)===1);return{...W,lessons:ee}}catch(P){return console.log("Error fetching lessons:",P),{...W,lessons:[]}}})),Q=await F.get(`/Course/problem-count?courseId=${o}`);if($(Q.data),i({...c,topics:_}),j!=null&&j.coderID){const W=await F.get("/Enrollment/CheckEnrollment",{params:{courseId:o||"",coderID:j.coderID||""}});k(W.data.isEnrolled)}}catch{m({title:"Lỗi",description:"Không thể tải dữ liệu. Vui lòng thử lại!",status:"error",duration:3e3,isClosable:!0}),i(null)}finally{D(!1)}},[o,j==null?void 0:j.coderID,C,m]);n.useEffect(()=>{L()},[L]);const v=s!=null&&s.topics?s.topics.length:0,H=s!=null&&s.topics?s.topics.reduce((c,g)=>c+(g.lessons?g.lessons.length:0),0):0;os((s==null?void 0:s.courseName)||"Khóa học");const a=async()=>{if(T.isAuthenticated===!1)m({title:"Bạn cần phải đăng nhập.",status:"warning",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"});else{const c={courseID:o};try{const g=await F.post("/Enrollment",c);g.status===200||g.status===201?(k(!0),m({title:"Đăng ký khóa học thành công",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})):m({title:"Lỗi đăng ký khóa học",description:g.data.message,status:"error",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"}),L()}catch(g){console.error("Lỗi đăng ký: ",g.response?g.response.data:g.message),m({title:g.response?g.response.data.message:g.message,status:"error",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})}}},f=n.useRef(),[A,E]=n.useState(!1),N=()=>E(!0),y=()=>E(!1),K=async()=>{var c,g;try{(await F.delete("/Enrollment",{data:{courseID:o,coderID:j.coderID}})).status===200&&(k(!1),m({title:"Đã hủy đăng ký khóa học.",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"}),L())}catch(_){m({title:"Lỗi hủy đăng ký",description:((g=(c=_.response)==null?void 0:c.data)==null?void 0:g.message)||"Có lỗi xảy ra",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})}};return e.jsx(ls,{children:e.jsxs(h,{p:6,maxW:"100%",minH:"100vh",mx:"auto",w:{lg:"calc(100% - 360px)",md:"100%"},children:[e.jsx(b,{leftIcon:e.jsx(Ye,{}),mb:2,colorScheme:"blue",variant:"ghost",onClick:()=>C("/course"),children:"Trở về trước"}),e.jsxs(B,{direction:{base:"column",md:"row"},gap:5,children:[e.jsxs(h,{flex:3,minH:570,overflowY:"auto",position:"static",children:[e.jsxs(B,{direction:{base:"column",md:"row"},gap:6,bgGradient:"linear(to-r, blue.900, blue.700)",p:8,borderRadius:"md",boxShadow:"lg",children:[e.jsx(h,{flex:3,children:d?e.jsx(re,{height:"250px",borderRadius:"md"}):e.jsx(Ve,{alt:"Course Avatar",w:"100%",h:{base:"200px",md:"250px"},borderRadius:"md",objectFit:"cover",boxShadow:"lg",src:(s==null?void 0:s.imageUrl)||"/avatarSimmmple.png"})}),e.jsx(h,{flex:3,color:"white",borderRadius:"lg",children:d?e.jsx(X,{noOfLines:3,spacing:4}):e.jsxs(h,{children:[e.jsx(t,{fontSize:"3xl",letterSpacing:1.2,fontWeight:"bold",children:s==null?void 0:s.courseName}),e.jsxs(t,{mt:2,children:[" ",e.jsx(h,{sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:Se(s==null?void 0:s.description)}})]}),e.jsxs(p,{mt:4,spacing:4,children:[e.jsxs(t,{children:["Tác giả: ",e.jsx(t,{as:"span",color:"blue.300",children:s==null?void 0:s.creatorName})]}),e.jsx(I,{as:Xe}),e.jsxs(t,{children:[(s==null?void 0:s.totalReviews)||"0"," Học viên"]}),e.jsx(I,{as:Ce,color:"yellow.400"})," ",e.jsxs(t,{children:[" ",s.rating?s.rating.toFixed(1):"0"]})]})]})}),e.jsx(h,{w:{base:"100%",md:"300px"},display:{base:"block",lg:"none"},children:e.jsxs(h,{color:"white",borderRadius:"lg",w:"full",children:[e.jsxs(B,{mt:"1",pb:3,align:"center",justify:"space-between",borderBottomWidth:2,borderBottomColor:"gray.600",children:[(s==null?void 0:s.fee)>=0&&e.jsxs(B,{alignItems:"left",direction:"column",children:[e.jsx(t,{fontSize:"4xl",fontWeight:"bold",children:(s==null?void 0:s.fee)===0?"Miễn phí":ne((s==null?void 0:s.fee)||0)}),e.jsx(t,{ml:"2",fontSize:"md",textDecoration:"line-through",color:"gray.400",children:(s==null?void 0:s.originalFee)===0?"":ne((s==null?void 0:s.originalFee)||0)})]}),(s==null?void 0:s.originalFee)>0&&e.jsxs(de,{colorScheme:"red",ml:"2",px:"2",py:"1",mb:10,fontSize:"sm",bg:"red.500",color:"white",borderRadius:"md",children:["-",(s==null?void 0:s.discountPercent)||0,"%"]})]}),e.jsxs(G,{align:"start",mt:4,spacing:3,children:[e.jsxs(p,{children:[e.jsx(I,{as:xe}),e.jsxs(t,{children:[v," chủ đề"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:ge}),e.jsxs(t,{children:[H," bài học"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:pe}),e.jsxs(t,{children:[R," bài tập"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:me}),e.jsx(t,{children:"Truy cập trọn đời"})]}),e.jsxs(p,{children:[e.jsx(I,{as:ue}),e.jsx(t,{children:"Chứng chỉ khi hoàn thành"})]})]}),x===!0&&((M=(l=(q=(O=s==null?void 0:s.topics)==null?void 0:O[0])==null?void 0:q.lessons)==null?void 0:l[0])!=null&&M.lessonID)?e.jsxs(B,{direction:"column",gap:4,children:[e.jsx(U,{to:`${z.pathname}/${s.topics[0].lessons[0].lessonID}`,children:e.jsxs(b,{colorScheme:"blue",mt:4,w:"full",fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center",_hover:{transform:"translateY(-3px)",boxShadow:"0px 4px 10px rgb(39, 87, 246)",transition:"transform 0.3s ease"},children:["Vào học ",e.jsx(I,{as:je,ml:2})]})}),e.jsx(b,{colorScheme:"red",w:"full",fontSize:"18px",onClick:N,children:"Hủy đăng ký"})]}):e.jsx(b,{colorScheme:(s==null?void 0:s.fee)===0?"green":"red",mt:4,w:"full",fontSize:"18px",onClick:a,children:(s==null?void 0:s.fee)===0?"Đăng ký miễn phí":"Mua ngay"})]})})]}),e.jsxs(Ue,{mt:6,colorScheme:"blue",bg:"white",borderRadius:"md",children:[e.jsxs(gs,{offsetTop:0,children:[e.jsx(se,{children:"Giới thiệu"}),e.jsx(se,{children:"Giáo trình"}),e.jsx(se,{children:"Đánh giá"}),e.jsx(se,{children:"Bình luận"})]}),e.jsxs(Ze,{children:[e.jsx(te,{children:d?e.jsx(X,{noOfLines:4,spacing:3}):e.jsxs(t,{mt:2,children:[" ",e.jsx(h,{px:5,py:2,sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:Se(s==null?void 0:s.overview)}})]})}),e.jsx(te,{children:d?e.jsx(X,{noOfLines:5,spacing:4}):e.jsx(fe,{spacing:0,children:Array.isArray(s==null?void 0:s.topics)&&s.topics.length>0?s.topics.map((c,g)=>e.jsx(be,{bg:"gray.100",borderRadius:"md",children:e.jsx(qe,{allowToggle:!0,children:e.jsx(Je,{border:"none",children:({isExpanded:_})=>{var Q,W;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:e.jsxs(Qe,{_expanded:{bg:"gray.200"},borderRadius:"sm",children:[e.jsxs(h,{flex:"1",textAlign:"left",borderBottomWidth:2,borderStyle:"dashed",py:2,children:[e.jsxs(t,{fontSize:"lg",children:[e.jsxs(t,{as:"span",fontWeight:"bold",children:["Chủ đề ",g+1,":"]})," ",(c==null?void 0:c.topicName)||"Không có tên"]}),e.jsxs(B,{alignItems:"center",gap:2,fontSize:"sm",children:[e.jsx(t,{as:"span",children:e.jsx(es,{})}),"Tổng số bài học: ",((Q=c==null?void 0:c.lessons)==null?void 0:Q.length)||0]})]}),_?e.jsx(ss,{boxSize:4}):e.jsx(ts,{boxSize:4})]})}),e.jsx(ns,{pb:4,children:(W=c.lessons)!=null&&W.length?e.jsx(fe,{spacing:2,children:c.lessons.map(P=>{const ee=T.isAuthenticated,V=P.lessonID||Math.random(),ie=e.jsx(be,{cursor:"pointer",_hover:{bg:"gray.300",transform:"scale(1.01)"},transition:"all .2s ease-in-out",pl:2,bg:"gray.50",borderRadius:"sm",p:2,onClick:()=>{ee||m({title:"Bạn cần đăng nhập để truy cập trang này.",status:"warning",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})},children:e.jsxs(t,{fontSize:"md",children:["📚 ",P.lessonTitle||"Không có tên bài học"]})});return x?ee?e.jsx(h,{children:e.jsx(U,{to:`${z.pathname}/${P.lessonID}`,style:({isActive:Be})=>({textDecoration:"none",color:Be?"blue.500":"inherit"}),children:ie})},V):e.jsx(h,{children:ie},V):e.jsx(h,{children:e.jsx(h,{cursor:"default",children:ie})},V)})}):e.jsx(t,{fontSize:"md",color:"gray.500",children:"Không có bài học nào."})})]})}},c==null?void 0:c.topicID)})},(c==null?void 0:c.topicID)||g)):e.jsx(t,{fontSize:"md",color:"gray.500",children:"Không có chủ đề nào."})})}),e.jsx(te,{children:d?e.jsx(X,{noOfLines:4,spacing:3}):e.jsx(hs,{courseId:o})}),e.jsx(te,{children:d?e.jsx(X,{noOfLines:4,spacing:3}):e.jsx(us,{courseId:o})})]})]})]}),e.jsx(h,{display:{base:"none",lg:"block"},position:"relative",w:"300px",children:e.jsxs(h,{bg:"blue.900",color:"white",p:4,borderRadius:"lg",w:"300px",maxH:"max-content",position:{base:"static",md:"fixed"},right:"200px",top:"135px",boxShadow:"lg",children:[e.jsxs(B,{mt:"1",pb:3,align:"center",justify:"space-between",borderBottomWidth:2,borderBottomColor:"gray.600",children:[(s==null?void 0:s.fee)>=0&&e.jsxs(B,{alignItems:"left",direction:"column",children:[e.jsx(t,{fontSize:"4xl",fontWeight:"bold",children:(s==null?void 0:s.fee)===0?"Miễn phí":ne((s==null?void 0:s.fee)||0)}),e.jsx(t,{ml:"2",fontSize:"md",textDecoration:"line-through",color:"gray.400",children:(s==null?void 0:s.originalFee)===0?"":ne((s==null?void 0:s.originalFee)||0)})]}),(s==null?void 0:s.originalFee)>0&&e.jsxs(de,{colorScheme:"red",ml:"2",px:"2",py:"1",mb:10,fontSize:"sm",bg:"red.500",color:"white",borderRadius:"md",children:["-",(s==null?void 0:s.discountPercent)||0,"%"]})]}),e.jsxs(G,{align:"start",mt:4,spacing:3,children:[e.jsxs(p,{children:[e.jsx(I,{as:xe}),e.jsxs(t,{children:[v," chủ đề"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:ge}),e.jsxs(t,{children:[H," bài học"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:pe}),e.jsxs(t,{children:[R," bài tập"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:me}),e.jsx(t,{children:"Truy cập trọn đời"})]}),e.jsxs(p,{children:[e.jsx(I,{as:ue}),e.jsx(t,{children:"Chứng chỉ khi hoàn thành"})]})]}),x===!0&&((J=(Y=(w=(S=s==null?void 0:s.topics)==null?void 0:S[0])==null?void 0:w.lessons)==null?void 0:Y[0])!=null&&J.lessonID)?e.jsxs(B,{direction:"column",gap:4,children:[e.jsx(U,{to:`${z.pathname}/${s.topics[0].lessons[0].lessonID}`,children:e.jsxs(b,{colorScheme:"blue",mt:4,w:"full",fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center",_hover:{transform:"translateY(-3px)",boxShadow:"0px 4px 10px rgb(39, 87, 246)",transition:"transform 0.3s ease"},children:["Vào học ",e.jsx(I,{as:je,ml:2})]})}),e.jsx(b,{colorScheme:"red",w:"full",fontSize:"18px",onClick:N,children:"Hủy đăng ký"})]}):e.jsx(b,{colorScheme:(s==null?void 0:s.fee)===0?"green":"red",mt:4,w:"full",fontSize:"18px",onClick:a,children:(s==null?void 0:s.fee)===0?"Đăng ký miễn phí":"Mua ngay"})]})})]}),e.jsx(Ie,{isOpen:A,leastDestructiveRef:f,onClose:y,isCentered:!0,children:e.jsx(De,{children:e.jsxs(ze,{children:[e.jsx(Re,{fontSize:"lg",fontWeight:"bold",children:"Xác nhận hủy đăng ký"}),e.jsx(Ae,{textAlign:"center",fontSize:"xl",children:"Bạn có chắc chắn muốn hủy đăng ký khóa học này? Hành động này không thể hoàn tác."}),e.jsxs(Te,{children:[e.jsx(b,{ref:f,onClick:y,children:"Hủy"}),e.jsx(b,{colorScheme:"red",onClick:()=>{y(),K()},ml:3,children:"Xác nhận"})]})]})})})]})})};export{Cs as default};
