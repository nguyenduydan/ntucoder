import{aF as N,u as R,r,j as e,z as g,a6 as T,s as y,$ as G,aG as A,y as B,aH as H,ao as M,I as c,W as C,am as W,f as S,F as d,g as h,aI as q,D as L,T as J,B as F,aJ as K,aK as O}from"./index-C3mpdEe2.js";function P(s){return N({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M149.1 64.8L138.7 96 64 96C28.7 96 0 124.7 0 160L0 416c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-256c0-35.3-28.7-64-64-64l-74.7 0L362.9 64.8C356.4 45.2 338.1 32 317.4 32L194.6 32c-20.7 0-39 13.2-45.5 32.8zM256 192a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"},child:[]}]})(s)}const $=({coderID:s,onClose:p,onUpdated:u})=>{var b;const l=R(),j=r.useRef(null),[t,x]=r.useState({}),[k,f]=r.useState(!0),[D,v]=r.useState(!1),[z,m]=r.useState(!1);r.useEffect(()=>{s&&(async()=>{f(!0);try{const n=await K({controller:"Coder",id:s});n&&x(n)}catch{l({title:"Lỗi khi tải dữ liệu.",status:"error",duration:2e3,variant:"top-accent",position:"top"})}finally{f(!1)}})()},[s]);const i=(a,n)=>{x(o=>({...o,[a]:n}))},E=async()=>{if(!t.coderName||!t.coderEmail){l({title:"Vui lòng điền đầy đủ thông tin.",status:"warning",duration:2e3,variant:"top-accent",position:"top"});return}v(!0);try{await O({controller:"Coder",id:s,data:t}),l({title:"Cập nhật thành công!",status:"success",duration:2e3,variant:"top-accent",position:"top"}),u==null||u(),p()}catch{l({title:"Lỗi khi cập nhật.",status:"error",duration:2e3,variant:"top-accent",position:"top"})}finally{v(!1)}},I=a=>{const n=a.target.files[0];if(n){const o=new FileReader;o.onloadend=()=>{x(w=>({...w,avatar:o.result,avatarFile:n})),m(!1)},o.readAsDataURL(n)}};return k?e.jsx(g,{minH:"40vh",justify:"center",alignItems:"center",children:e.jsx(T,{size:"xl"})}):e.jsxs(y,{px:6,children:[e.jsxs(g,{direction:"column",align:"center",p:5,bgGradient:"linear(to-r, purple.400, brand.200)",children:[e.jsx(G,{isLoaded:z,borderRadius:"md",size:"2xl",mb:4,children:e.jsxs(y,{position:"relative",cursor:"pointer",children:[e.jsx(A,{label:"Thay đổi avatar",hasArrow:!0,children:e.jsx(B,{src:H(t.avatar||"/avatarSimmmple.png"),alt:"Avatar",borderRadius:"full",boxSize:"150px",objectFit:"cover",onClick:()=>j.current.click(),onLoad:()=>m(!0),onError:()=>m(!0)})}),e.jsx(M,{as:P,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"white",fontSize:"2xl",pointerEvents:"none"})]})}),e.jsx(c,{ref:j,type:"file",display:"none",onChange:I})]}),e.jsx(C,{my:4}),e.jsxs(W,{columns:{base:1,md:2},spacing:5,children:[e.jsxs(S,{children:[e.jsxs(d,{mb:4,children:[e.jsx(h,{children:"Họ và tên"}),e.jsx(c,{value:t.coderName||"",onChange:a=>i("coderName",a.target.value)})]}),e.jsxs(d,{mb:4,children:[e.jsx(h,{children:"Email"}),e.jsx(c,{value:t.coderEmail||"",onChange:a=>i("coderEmail",a.target.value)})]})]}),e.jsxs(S,{children:[e.jsxs(d,{mb:4,children:[e.jsx(h,{children:"Số điện thoại"}),e.jsx(c,{value:t.phoneNumber||"",onChange:a=>i("phoneNumber",a.target.value)})]}),e.jsxs(d,{mb:4,children:[e.jsx(h,{children:"Ngày sinh"}),e.jsx(q,{selected:t.birthDay?new Date(t.birthDay):null,onChange:a=>i("birthDay",a?a.toISOString():""),dateFormat:"dd/MM/yyyy",className:"chakra-input css-bq6bms"})]})]})]}),e.jsx(C,{my:4}),e.jsx(L,{fontWeight:"bold",mb:2,align:"center",children:"Giới thiệu"}),e.jsx(J,{value:t.description||"",onChange:a=>i("description",a.target.value),maxLength:200,h:"130px",resize:"none"}),e.jsxs(L,{fontSize:"sm",color:"gray.500",textAlign:"right",children:[((b=t.description)==null?void 0:b.length)||0," / 200 ký tự"]}),e.jsxs(g,{justify:"flex-end",mt:6,mb:5,children:[e.jsx(F,{variant:"ghost",colorScheme:"red",mr:3,onClick:p,children:"Hủy"}),e.jsx(F,{colorScheme:"blue",isLoading:D,loadingText:"Đang lưu...",onClick:E,children:"Lưu"})]})]})};export{$ as default};
