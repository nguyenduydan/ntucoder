import{r as n,j as e,ar as p,e as we,bi as Ce,U as ae,B as h,H as oe,b as t,ah as G,ai as Ee,a6 as Me,F as B,i as b,D as le,o as Fe,as as U,p as I,bg as He,aq as ke,I as $e,f as ve,t as Ne,bI as We,S as Oe,a5 as re,bJ as ce,at as Ie,W as De,au as Re,Y as ze,_ as Ae,a4 as Te,aj as Pe,aa as _e,g as Ge,N as Ke,bG as V,bH as Ye,ae as he,bk as de,bK as xe,bL as ge,bM as pe,bN as me,bC as ue,bf as Xe,bh as se,bE as Ve,bF as te,L as je,v as fe,bO as Ue,bP as qe,bQ as Je,bR as Qe,bS as Ze}from"./react-vendor-jMCSND2O.js";import{b as q,a as H,i as es,m as ss,n as ts,o as be,u as ns,S as rs,s as ye,k as ne}from"./index-b-BR7AAp.js";import{cP as Se,S as is,c$ as os,d0 as as,d1 as ls}from"./vendor-BYm5b_XE.js";import"./charts-vendor-DwxpLNbD.js";import"./lodash-vendor-CBiJWk4A.js";function cs({value:r,onChange:u}){const[a,s]=n.useState(0);return e.jsx(p,{spacing:.5,children:[1,2,3,4,5].map(i=>e.jsx(we,{icon:e.jsx(Ce,{fontSize:"24px"}),variant:"ghost",color:i<=(a||r)?"yellow.400":"gray.300",onMouseEnter:()=>s(i),onMouseLeave:()=>s(0),onClick:()=>u(i),"aria-label":`Chọn ${i} sao`,size:"lg",boxSize:"40px",_hover:{transform:"scale(1.2)"}},i))})}const hs=({courseId:r})=>{const{isAuthenticated:u}=q(),[a,s]=n.useState({rating:5,content:""}),[i,d]=n.useState([]),[D,m]=n.useState(!0),[C,R]=n.useState([0,0,0,0,0]),x=ae(),[k,z]=n.useState(!1),$=k?i:i.slice(0,5),T=()=>{z(o=>!o)},j=n.useCallback(async()=>{try{const f=(await H.get(`/Review?courseId=${r}`)).data||[];d(f);const A=[0,0,0,0,0];f.forEach(E=>A[E.rating-1]++),R(A.reverse())}catch(o){x({title:"Lỗi",description:o.message,status:"error"})}finally{m(!1)}},[r,x]),L=async()=>{try{const o=await H.post(`/Review?courseId=${r}`,a);(o.status===200||o.status===201)&&(x({title:"Thành công",description:"Đánh giá đã được gửi!",status:"success",variant:"top-accent",duration:2e3,position:"top",isClosable:!0}),s({...a,content:"",rating:5})),j()}catch(o){x({title:"Thất bại",description:o.message,status:"error",variant:"top-accent",duration:2e3,position:"top",isClosable:!0})}};n.useEffect(()=>{j()},[j]);const v=i.length,F=v>0?(i.reduce((o,f)=>o+f.rating,0)/v).toFixed(1):0;return e.jsxs(h,{mx:"auto",p:4,children:[e.jsx(oe,{size:"lg",mb:4,children:"Đánh giá khóa học"}),e.jsxs(p,{spacing:6,align:"start",mb:6,children:[e.jsxs(h,{minW:"200px",children:[e.jsx(t,{fontSize:"5xl",children:F}),e.jsx(p,{children:[...Array(5)].map((o,f)=>e.jsx(Se,{boxSize:7,color:f<Math.round(F)?"yellow.400":"gray.300"},f))}),e.jsxs(t,{color:"gray.500",mt:3,children:["(",v," đánh giá)"]})]}),e.jsx(G,{align:"start",flex:1,children:[5,4,3,2,1].map((o,f)=>{const A=v?Math.round(C[f]/v*100):0;return e.jsxs(p,{w:"100%",children:[e.jsxs(t,{w:"30px",flex:"0.1",children:[o," sao"]}),e.jsx(Ee,{value:A,flex:"1",size:"sm",colorScheme:"yellow",bg:"gray.200",rounded:"md",sx:{"& > div":{backgroundColor:"yellow.400"}}}),e.jsxs(t,{w:"40px",textAlign:"right",color:"gray.400",children:[A,"%"]})]},o)})})]}),u&&e.jsxs(h,{mb:8,children:[e.jsx(oe,{size:"md",mb:3,children:"Viết đánh giá"}),e.jsx(Me,{placeholder:"Nội dung đánh giá của bạn...",value:a.content,onChange:o=>s({...a,content:o.target.value}),mb:3,resize:"none",h:"140px"}),e.jsxs(B,{justify:"flex-end",children:[e.jsx(cs,{value:a.rating,onChange:o=>s({...a,rating:o})}),e.jsx(b,{colorScheme:"blue",ml:3,onClick:L,isDisabled:a.content.length===0,children:"Gửi đánh giá"})]})]}),e.jsx(le,{mb:6}),e.jsx(oe,{size:"md",mb:4,children:"Đánh giá của người học"}),D?e.jsx(Fe,{}):$.length===0?e.jsx(t,{children:"Chưa có đánh giá nào."}):$.map(o=>e.jsxs(h,{mb:2,p:3,borderRadius:"md",children:[e.jsxs(p,{mb:1,children:[e.jsx(es,{coderID:o.coderID,size:"sm"}),e.jsxs(h,{children:[e.jsx(U,{to:`/profile/${o.coderID}`,children:e.jsx(t,{_hover:{color:"blue"},fontWeight:"bold",children:(o.coderName||"Ẩn danh").replace(/(.{3}).*(@.*)/,"$1******$2")})}),e.jsxs(p,{spacing:1,children:[[...Array(5)].map((f,A)=>e.jsx(I,{as:Se,color:A<o.rating?"yellow.400":"gray.300"},A)),e.jsx(t,{fontSize:"xs",color:"gray.500",children:ss(o.createdAt)})]})]})]}),e.jsx(t,{mt:2,children:o.content}),e.jsx(le,{mt:2})]},o.reviewID)),i.length>5&&e.jsx(b,{mt:4,variant:"outline",colorScheme:"black",_hover:{bg:"black",color:"white"},onClick:T,children:k?"Thu gọn":"Xem thêm"})]})},ds=is(h),xs={hidden:{opacity:0,y:-50},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}},normal:{opacity:1,y:0}},gs=({children:r,offsetTop:u=64,...a})=>{const s=n.useRef(null),[i,d]=n.useState(!1),[D,m]=n.useState(0),[C,R]=n.useState(0);return n.useEffect(()=>{const x=s.current;if(!x)return;const k=x.getBoundingClientRect().top+window.scrollY;m(x.offsetHeight);const z=()=>{const T=window.scrollY+u>=k;T&&!i?(d(!0),R(j=>j+1)):!T&&i&&d(!1)};return window.addEventListener("scroll",z),()=>window.removeEventListener("scroll",z)},[i,u]),e.jsxs(h,{children:[i&&e.jsx(h,{height:`${D}px`}),e.jsx(ds,{ref:s,position:i?"fixed":"static",top:i?`${u}px`:"auto",left:0,zIndex:"100",width:"100%",bg:"white",boxShadow:i?"md":"none",borderBottom:"1px solid",borderColor:"gray.200",variants:xs,initial:i?"hidden":"normal",animate:i?"visible":"normal",...a,children:e.jsx(He,{height:i?"75px":"auto",justifyContent:i?"center":"flex-start",children:r})},C)]})},ps=({coder:r,newComment:u,setNewComment:a,handleAddComment:s,...i})=>e.jsxs(p,{mt:3,align:"center",spacing:3,px:5,children:[e.jsx(ke,{size:"sm",name:(r==null?void 0:r.name)||"Bạn",src:(r==null?void 0:r.avatar)||"https://bit.ly/prosper-baba"}),e.jsxs($e,{bg:"white",children:[e.jsx(ve,{pr:"5.5rem",placeholder:"Viết bình luận...",boxShadow:"md",value:u,onChange:d=>a(d.target.value),onKeyDown:d=>d.key==="Enter"&&s(),...i}),e.jsx(Ne,{width:"3rem",children:e.jsx(we,{icon:e.jsx(We,{}),colorScheme:"green",size:"sm",onClick:s,"aria-label":"Gửi bình luận"})})]})]}),ms=5,Le=({comment:r,onReply:u,onDelete:a,globalExpand:s})=>{var E,N;const{coder:i,isAuthenticated:d}=q(),D=ae(),[m,C]=n.useState(!1),[R,x]=n.useState(""),[k,z]=n.useState(!1),[$,T]=n.useState(!1),j=n.useRef();n.useEffect(()=>{z(s)},[s]);const L=()=>T(!0),v=()=>T(!1),F=async()=>{if(R.trim()!=="")try{const y={content:R.trim(),courseID:r.courseID,parentCommentID:r.commentID},K=(i==null?void 0:i.token)||localStorage.getItem("token"),O=await H.post("/comments",y,{headers:{Authorization:`Bearer ${K}`}});u(r.commentID,{...O.data,replies:[]}),x(""),C(!1),z(!0)}catch(y){console.error("Add reply error",y),D({title:"Lỗi khi gửi bình luận",status:"error",position:"top",variant:"top-accent",duration:"1000"})}},o=()=>{C(!0),x(`@${r.coderName} `)},f=()=>{C(!1),x("")},A=async()=>{try{await H.delete(`/comments/${r.commentID}`),a(r.commentID),D({title:"Bạn đã xóa bình luận này",status:"success",position:"top",variant:"top-accent",duration:"1000"}),v()}catch(y){console.error("Delete comment error",y),D({title:"Bạn không thể xóa bình luận này",status:"error",position:"top",variant:"top-accent",duration:"1000"}),v()}};return e.jsxs(h,{children:[e.jsxs(B,{align:"flex-start",mb:2,position:"relative",children:[e.jsx(ke,{size:"sm",name:r.coderName,src:r.coderAvatar,mr:3,mt:5,zIndex:1}),e.jsxs(h,{bg:"gray.200",p:3,borderRadius:"md",w:"full",zIndex:1,children:[e.jsxs(B,{justify:"space-between",align:"center",children:[e.jsx(U,{to:`/profile/${r.coderID}`,children:e.jsx(t,{fontWeight:"bold",fontSize:"sm",children:r.coderName})}),d&&(i==null?void 0:i.coderID)===r.coderID&&e.jsx(b,{size:"xs",colorScheme:"red",variant:"ghost",onClick:L,children:"Xóa"})]}),e.jsx(t,{fontSize:"sm",mt:1,children:r.content}),e.jsxs(p,{mt:2,spacing:4,children:[e.jsx(t,{fontSize:"xs",color:"gray.500",children:ts(r.commentTime)}),e.jsx(b,{size:"xs",variant:"link",colorScheme:"blue",onClick:o,children:"Trả lời"}),((E=r.replies)==null?void 0:E.length)>0&&e.jsx(b,{size:"xs",variant:"link",colorScheme:"gray",onClick:()=>z(!k),children:k?"Ẩn trả lời":`Xem ${r.replies.length} trả lời`})]}),e.jsx(ce,{in:m,animateOpacity:!0,children:d&&e.jsx(G,{mt:2,align:"stretch",spacing:1,children:e.jsxs(p,{children:[e.jsx(ve,{placeholder:"Trả lời bình luận...",value:R,autoFocus:!0,bg:"white",onChange:y=>x(y.target.value),onKeyDown:y=>y.key==="Enter"&&F()}),e.jsx(b,{size:"sm",colorScheme:"blue",onClick:F,children:"Gửi"}),e.jsx(b,{size:"sm",variant:"outline",colorScheme:"red",onClick:f,children:"Hủy"})]})})})]})]}),e.jsx(ce,{in:k,animateOpacity:!0,children:e.jsx(h,{pl:10,position:"relative",children:(N=r.replies)==null?void 0:N.map(y=>e.jsx(Le,{comment:y,onReply:()=>{},onDelete:a,globalExpand:s},y.commentID))})}),e.jsx(Ie,{isOpen:$,leastDestructiveRef:j,onClose:v,isCentered:!0,children:e.jsx(De,{children:e.jsxs(Re,{children:[e.jsx(ze,{fontSize:"lg",fontWeight:"bold",children:"Xác nhận xóa"}),e.jsx(Ae,{children:"Bạn có chắc muốn xóa bình luận này? Hành động này không thể hoàn tác."}),e.jsxs(Te,{children:[e.jsx(b,{ref:j,onClick:v,children:"Hủy"}),e.jsx(b,{colorScheme:"red",onClick:A,ml:3,children:"Xóa"})]})]})})})]})},us=({courseId:r})=>{const u=n.useRef(null),{coder:a,isAuthenticated:s}=q(),[i,d]=n.useState([]),[D,m]=n.useState(""),[C,R]=n.useState(!1),[x,k]=n.useState(!1),[z,$]=n.useState(!0),[T,j]=n.useState(1),[L,v]=n.useState(!1),[F,o]=n.useState("CommentTime"),[f,A]=n.useState(!1),E=async(l=1,M=!1,S=ms)=>{try{l===1?R(!0):k(!0);const w=await H.get("/comments",{params:{courseId:r,page:l,pageSize:S,sortBy:F,ascending:f}}),Y=w.data.data||[],Q=w.data.totalPages||1;d(M?c=>[...c,...Y]:Y),j(l),$(l<Q)}catch(w){console.error("Load comments error",w)}finally{R(!1),k(!1)}},N=n.useCallback(()=>{if(!u.current||x||C||!z)return;const{scrollTop:l,scrollHeight:M,clientHeight:S}=u.current;M-l-S<100&&E(T+1,!0)},[T,E,z,x,C]);n.useEffect(()=>{const l=u.current;if(l)return l.addEventListener("scroll",N),()=>{l.removeEventListener("scroll",N)}},[N]),n.useEffect(()=>{r&&(L?E(1,!1,9999):E(1,!1))},[r,F,f,L]);const y=l=>{d(M=>M.filter(S=>S.commentID!==l).map(S=>({...S,replies:S.replies?S.replies.filter(w=>w.commentID!==l):[]})))},K=async()=>{if(D.trim()!==""){if(!s){alert("Bạn cần đăng nhập để bình luận");return}try{const l={content:D.trim(),courseID:r,parentCommentID:null},M=(a==null?void 0:a.token)||localStorage.getItem("token"),S=await H.post("/comments",l,{headers:{Authorization:`Bearer ${M}`}});d(w=>[{...S.data,replies:[]},...w]),m("")}catch(l){console.error("Add comment error",l),alert("Lỗi khi gửi bình luận")}}},O=(l,M)=>{d(S=>S.map(w=>w.commentID===l?{...w,replies:[...w.replies||[],M]}:w))},J=()=>{v(l=>!l)};return C?e.jsx(t,{textAlign:"center",children:"Đang tải bình luận..."}):e.jsxs(h,{w:"100%",maxW:"100%",mx:"auto",px:4,py:2,children:[!s&&e.jsx(t,{color:"red",fontStyle:"italic",children:"**Đăng nhập để có thể bình luận"}),e.jsxs(B,{justify:"space-between",align:"center",mb:4,flexWrap:"wrap",gap:2,children:[e.jsx(t,{fontSize:"lg",fontWeight:"bold",children:"Bình luận"}),e.jsxs(p,{spacing:2,children:[e.jsx(b,{colorScheme:"navy",px:4,py:2,onClick:J,maxW:"150px",whiteSpace:"normal",children:e.jsx(t,{fontSize:"12px",textAlign:"center",children:L?"Thu gọn tất cả trả lời":"Xem tất cả trả lời"})}),e.jsxs(Oe,{ms:4,size:"sm",value:f?"asc":"desc",onChange:l=>A(l.target.value==="asc"),borderRadius:"md",children:[e.jsx("option",{value:"desc",children:"Mới nhất trước"}),e.jsx("option",{value:"asc",children:"Cũ nhất trước"})]})]})]}),e.jsx(h,{height:"400px",overflowY:"auto",borderColor:"gray.200",borderRadius:"md",bg:"white",ref:u,px:4,py:2,children:e.jsxs(G,{spacing:4,align:"stretch",children:[i.map(l=>e.jsx(Le,{comment:l,onReply:O,onDelete:y,globalExpand:L},l.commentID)),x&&e.jsxs(G,{spacing:3,mt:3,children:[e.jsx(re,{height:"20px",width:"100%"}),e.jsx(re,{height:"20px",width:"90%"}),e.jsx(re,{height:"20px",width:"95%"})]})]})}),s&&e.jsx(ps,{coder:a,newComment:D,setNewComment:m,handleAddComment:K})]})},ws=()=>{var O,J,l,M,S,w,Y,Q;const{slugId:r}=Pe(),u=r?r.split("-"):[],a=u.length>0?parseInt(u.pop(),10):NaN,[s,i]=n.useState(null),[d,D]=n.useState(!0),m=ae(),C=_e(),R=Ge(),[x,k]=n.useState(!1),[z,$]=n.useState([]),T=q(),{coder:j}=q(),L=n.useCallback(async()=>{if(isNaN(a)){m({title:"Lỗi",description:"ID không hợp lệ!",status:"error",duration:3e3,isClosable:!0}),D(!1),C("/course");return}try{const c=await be({controller:"Course",id:a});if(!c||Object.keys(c).length===0){m({title:"Cảnh báo",description:"Không có dữ liệu cho khóa học này.",status:"warning",duration:3e3,isClosable:!0}),i(null);return}const g=c.topics||[],P=await Promise.all(g.map(async W=>{try{const ee=((await be({controller:"Topic",id:W.topicID})).lessons||[]).filter(X=>Number(X.status)===1);return{...W,lessons:ee}}catch(_){return console.log("Error fetching lessons:",_),{...W,lessons:[]}}})),Z=await H.get(`/Course/problem-count?courseId=${a}`);if($(Z.data),i({...c,topics:P}),j!=null&&j.coderID){const W=await H.get("/Enrollment/CheckEnrollment",{params:{courseId:a||"",coderID:j.coderID||""}});k(W.data.isEnrolled)}}catch{m({title:"Lỗi",description:"Không thể tải dữ liệu. Vui lòng thử lại!",status:"error",duration:3e3,isClosable:!0}),i(null)}finally{D(!1)}},[a,j==null?void 0:j.coderID,C,m]);n.useEffect(()=>{L()},[L]);const v=s!=null&&s.topics?s.topics.length:0,F=s!=null&&s.topics?s.topics.reduce((c,g)=>c+(g.lessons?g.lessons.length:0),0):0;ns((s==null?void 0:s.courseName)||"Khóa học");const o=async()=>{if(T.isAuthenticated===!1)m({title:"Bạn cần phải đăng nhập.",status:"warning",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"});else{const c={courseID:a};try{const g=await H.post("/Enrollment",c);g.status===200||g.status===201?(k(!0),m({title:"Đăng ký khóa học thành công",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})):m({title:"Lỗi đăng ký khóa học",description:g.data.message,status:"error",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"}),L()}catch(g){console.error("Lỗi đăng ký: ",g.response?g.response.data:g.message),m({title:g.response?g.response.data.message:g.message,status:"error",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})}}},f=n.useRef(),[A,E]=n.useState(!1),N=()=>E(!0),y=()=>E(!1),K=async()=>{var c,g;try{(await H.delete("/Enrollment",{data:{courseID:a,coderID:j.coderID}})).status===200&&(k(!1),m({title:"Đã hủy đăng ký khóa học.",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"}),L())}catch(P){m({title:"Lỗi hủy đăng ký",description:((g=(c=P.response)==null?void 0:c.data)==null?void 0:g.message)||"Có lỗi xảy ra",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})}};return e.jsx(rs,{children:e.jsxs(h,{p:6,maxW:"100%",minH:"100vh",mx:"auto",w:{lg:"calc(100% - 360px)",md:"100%"},children:[e.jsx(b,{leftIcon:e.jsx(os,{}),mb:2,colorScheme:"blue",variant:"ghost",onClick:()=>C("/course"),children:"Trở về trước"}),e.jsxs(B,{direction:{base:"column",md:"row"},gap:5,children:[e.jsxs(h,{flex:3,minH:570,overflowY:"auto",position:"static",children:[e.jsxs(B,{direction:{base:"column",md:"row"},gap:6,bgGradient:"linear(to-r, blue.900, blue.700)",p:8,borderRadius:"md",boxShadow:"lg",children:[e.jsx(h,{flex:3,children:d?e.jsx(re,{height:"250px",borderRadius:"md"}):e.jsx(Ke,{alt:"Course Avatar",w:"100%",h:{base:"200px",md:"250px"},borderRadius:"md",objectFit:"cover",boxShadow:"lg",src:(s==null?void 0:s.imageUrl)||"/avatarSimmmple.png"})}),e.jsx(h,{flex:3,color:"white",borderRadius:"lg",children:d?e.jsx(V,{noOfLines:3,spacing:4}):e.jsxs(h,{children:[e.jsx(t,{fontSize:"3xl",letterSpacing:1.2,fontWeight:"bold",children:s==null?void 0:s.courseName}),e.jsxs(t,{mt:2,children:[" ",e.jsx(h,{sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:ye(s==null?void 0:s.description)}})]}),e.jsxs(p,{mt:4,spacing:4,children:[e.jsxs(t,{children:["Tác giả: ",e.jsx(t,{as:"span",color:"blue.300",children:s==null?void 0:s.creatorName})]}),e.jsx(I,{as:Ye}),e.jsxs(t,{children:[(s==null?void 0:s.totalReviews)||"0"," Học viên"]}),e.jsx(I,{as:Ce,color:"yellow.400"})," ",e.jsxs(t,{children:[" ",s.rating?s.rating.toFixed(1):"0"]})]})]})}),e.jsx(h,{w:{base:"100%",md:"300px"},display:{base:"block",lg:"none"},children:e.jsxs(h,{color:"white",borderRadius:"lg",w:"full",children:[e.jsxs(B,{mt:"1",pb:3,align:"center",justify:"space-between",borderBottomWidth:2,borderBottomColor:"gray.600",children:[(s==null?void 0:s.fee)>=0&&e.jsxs(B,{alignItems:"left",direction:"column",children:[e.jsx(t,{fontSize:"4xl",fontWeight:"bold",children:(s==null?void 0:s.fee)===0?"Miễn phí":ne((s==null?void 0:s.fee)||0)}),e.jsx(t,{ml:"2",fontSize:"md",textDecoration:"line-through",color:"gray.400",children:(s==null?void 0:s.originalFee)===0?"":ne((s==null?void 0:s.originalFee)||0)})]}),(s==null?void 0:s.originalFee)>0&&e.jsxs(he,{colorScheme:"red",ml:"2",px:"2",py:"1",mb:10,fontSize:"sm",bg:"red.500",color:"white",borderRadius:"md",children:["-",(s==null?void 0:s.discountPercent)||0,"%"]})]}),e.jsxs(G,{align:"start",mt:4,spacing:3,children:[e.jsxs(p,{children:[e.jsx(I,{as:de}),e.jsxs(t,{children:[v," chủ đề"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:xe}),e.jsxs(t,{children:[F," bài học"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:ge}),e.jsxs(t,{children:[z," bài tập"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:pe}),e.jsx(t,{children:"Truy cập trọn đời"})]}),e.jsxs(p,{children:[e.jsx(I,{as:me}),e.jsx(t,{children:"Chứng chỉ khi hoàn thành"})]})]}),x===!0&&((M=(l=(J=(O=s==null?void 0:s.topics)==null?void 0:O[0])==null?void 0:J.lessons)==null?void 0:l[0])!=null&&M.lessonID)?e.jsxs(B,{direction:"column",gap:4,children:[e.jsx(U,{to:`${R.pathname}/${s.topics[0].lessons[0].lessonID}`,children:e.jsxs(b,{colorScheme:"blue",mt:4,w:"full",fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center",_hover:{transform:"translateY(-3px)",boxShadow:"0px 4px 10px rgb(39, 87, 246)",transition:"transform 0.3s ease"},children:["Vào học ",e.jsx(I,{as:ue,ml:2})]})}),e.jsx(b,{colorScheme:"red",w:"full",fontSize:"18px",onClick:N,children:"Hủy đăng ký"})]}):e.jsx(b,{colorScheme:(s==null?void 0:s.fee)===0?"green":"red",mt:4,w:"full",fontSize:"18px",onClick:o,children:(s==null?void 0:s.fee)===0?"Đăng ký miễn phí":"Mua ngay"})]})})]}),e.jsxs(Xe,{mt:6,colorScheme:"blue",bg:"white",borderRadius:"md",children:[e.jsxs(gs,{offsetTop:0,children:[e.jsx(se,{children:"Giới thiệu"}),e.jsx(se,{children:"Giáo trình"}),e.jsx(se,{children:"Đánh giá"}),e.jsx(se,{children:"Bình luận"})]}),e.jsxs(Ve,{children:[e.jsx(te,{children:d?e.jsx(V,{noOfLines:4,spacing:3}):e.jsxs(t,{mt:2,children:[" ",e.jsx(h,{px:5,py:2,sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:ye(s==null?void 0:s.overview)}})]})}),e.jsx(te,{children:d?e.jsx(V,{noOfLines:5,spacing:4}):e.jsx(je,{spacing:0,children:Array.isArray(s==null?void 0:s.topics)&&s.topics.length>0?s.topics.map((c,g)=>e.jsx(fe,{bg:"gray.100",borderRadius:"md",children:e.jsx(Ue,{allowToggle:!0,children:e.jsx(qe,{border:"none",children:({isExpanded:P})=>{var Z,W;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:e.jsxs(Je,{_expanded:{bg:"gray.200"},borderRadius:"sm",children:[e.jsxs(h,{flex:"1",textAlign:"left",borderBottomWidth:2,borderStyle:"dashed",py:2,children:[e.jsxs(t,{fontSize:"lg",children:[e.jsxs(t,{as:"span",fontWeight:"bold",children:["Chủ đề ",g+1,":"]})," ",(c==null?void 0:c.topicName)||"Không có tên"]}),e.jsxs(B,{alignItems:"center",gap:2,fontSize:"sm",children:[e.jsx(t,{as:"span",children:e.jsx(Qe,{})}),"Tổng số bài học: ",((Z=c==null?void 0:c.lessons)==null?void 0:Z.length)||0]})]}),P?e.jsx(as,{boxSize:4}):e.jsx(ls,{boxSize:4})]})}),e.jsx(Ze,{pb:4,children:(W=c.lessons)!=null&&W.length?e.jsx(je,{spacing:2,children:c.lessons.map(_=>{const ee=T.isAuthenticated,X=_.lessonID||Math.random(),ie=e.jsx(fe,{cursor:"pointer",_hover:{bg:"gray.300",transform:"scale(1.01)"},transition:"all .2s ease-in-out",pl:2,bg:"gray.50",borderRadius:"sm",p:2,onClick:()=>{ee||m({title:"Bạn cần đăng nhập để truy cập trang này.",status:"warning",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})},children:e.jsxs(t,{fontSize:"md",children:["📚 ",_.lessonTitle||"Không có tên bài học"]})});return x?ee?e.jsx(h,{children:e.jsx(U,{to:`${R.pathname}/${_.lessonID}`,style:({isActive:Be})=>({textDecoration:"none",color:Be?"blue.500":"inherit"}),children:ie})},X):e.jsx(h,{children:ie},X):e.jsx(h,{children:e.jsx(h,{cursor:"default",children:ie})},X)})}):e.jsx(t,{fontSize:"md",color:"gray.500",children:"Không có bài học nào."})})]})}},c==null?void 0:c.topicID)})},(c==null?void 0:c.topicID)||g)):e.jsx(t,{fontSize:"md",color:"gray.500",children:"Không có chủ đề nào."})})}),e.jsx(te,{children:d?e.jsx(V,{noOfLines:4,spacing:3}):e.jsx(hs,{courseId:a})}),e.jsx(te,{children:d?e.jsx(V,{noOfLines:4,spacing:3}):e.jsx(us,{courseId:a})})]})]})]}),e.jsx(h,{display:{base:"none",lg:"block"},position:"relative",w:"300px",children:e.jsxs(h,{bg:"blue.900",color:"white",p:4,borderRadius:"lg",w:"300px",maxH:"max-content",position:{base:"static",md:"fixed"},right:"200px",top:"135px",boxShadow:"lg",children:[e.jsxs(B,{mt:"1",pb:3,align:"center",justify:"space-between",borderBottomWidth:2,borderBottomColor:"gray.600",children:[(s==null?void 0:s.fee)>=0&&e.jsxs(B,{alignItems:"left",direction:"column",children:[e.jsx(t,{fontSize:"4xl",fontWeight:"bold",children:(s==null?void 0:s.fee)===0?"Miễn phí":ne((s==null?void 0:s.fee)||0)}),e.jsx(t,{ml:"2",fontSize:"md",textDecoration:"line-through",color:"gray.400",children:(s==null?void 0:s.originalFee)===0?"":ne((s==null?void 0:s.originalFee)||0)})]}),(s==null?void 0:s.originalFee)>0&&e.jsxs(he,{colorScheme:"red",ml:"2",px:"2",py:"1",mb:10,fontSize:"sm",bg:"red.500",color:"white",borderRadius:"md",children:["-",(s==null?void 0:s.discountPercent)||0,"%"]})]}),e.jsxs(G,{align:"start",mt:4,spacing:3,children:[e.jsxs(p,{children:[e.jsx(I,{as:de}),e.jsxs(t,{children:[v," chủ đề"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:xe}),e.jsxs(t,{children:[F," bài học"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:ge}),e.jsxs(t,{children:[z," bài tập"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:pe}),e.jsx(t,{children:"Truy cập trọn đời"})]}),e.jsxs(p,{children:[e.jsx(I,{as:me}),e.jsx(t,{children:"Chứng chỉ khi hoàn thành"})]})]}),x===!0&&((Q=(Y=(w=(S=s==null?void 0:s.topics)==null?void 0:S[0])==null?void 0:w.lessons)==null?void 0:Y[0])!=null&&Q.lessonID)?e.jsxs(B,{direction:"column",gap:4,children:[e.jsx(U,{to:`${R.pathname}/${s.topics[0].lessons[0].lessonID}`,children:e.jsxs(b,{colorScheme:"blue",mt:4,w:"full",fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center",_hover:{transform:"translateY(-3px)",boxShadow:"0px 4px 10px rgb(39, 87, 246)",transition:"transform 0.3s ease"},children:["Vào học ",e.jsx(I,{as:ue,ml:2})]})}),e.jsx(b,{colorScheme:"red",w:"full",fontSize:"18px",onClick:N,children:"Hủy đăng ký"})]}):e.jsx(b,{colorScheme:(s==null?void 0:s.fee)===0?"green":"red",mt:4,w:"full",fontSize:"18px",onClick:o,children:(s==null?void 0:s.fee)===0?"Đăng ký miễn phí":"Mua ngay"})]})})]}),e.jsx(Ie,{isOpen:A,leastDestructiveRef:f,onClose:y,isCentered:!0,children:e.jsx(De,{children:e.jsxs(Re,{children:[e.jsx(ze,{fontSize:"lg",fontWeight:"bold",children:"Xác nhận hủy đăng ký"}),e.jsx(Ae,{textAlign:"center",fontSize:"xl",children:"Bạn có chắc chắn muốn hủy đăng ký khóa học này? Hành động này không thể hoàn tác."}),e.jsxs(Te,{children:[e.jsx(b,{ref:f,onClick:y,children:"Hủy"}),e.jsx(b,{colorScheme:"red",onClick:()=>{y(),K()},ml:3,children:"Xác nhận"})]})]})})})]})})};export{ws as default};
