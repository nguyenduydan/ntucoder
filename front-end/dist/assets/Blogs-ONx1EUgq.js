import{r as s,j as t,i as f,a5 as d,s as x,D as a,U as A,z as v,X as H,Y as C,au as w,Z as K,_ as y,av as L,a6 as T,aw as N,ax as M,ay as P,az as Y}from"./index-C3mpdEe2.js";import{C as G}from"./react-apexcharts.min-DvKORd24.js";class U extends s.Component{constructor(i){super(i),this.state={chartData:[],chartOptions:{}}}componentDidMount(){this.setState({chartData:this.props.chartData,chartOptions:this.props.chartOptions})}render(){return t.jsx(G,{options:this.state.chartOptions,series:this.state.chartData,type:"bar",width:"100%",height:"100%"})}}const Z=({height:p,refreshKey:i,onFinishRefresh:r})=>{const[n,B]=s.useState([]),[u,g]=s.useState(!1),[o,m]=s.useState(null),[D,z]=s.useState(0),[l,O]=s.useState(4),[W,k]=s.useState(0),[c,E]=s.useState(!1),j=s.useCallback(async()=>{g(!0),m(null);try{const e=await f.get(`/Blog/TopViewed?count=${l}&ascingSort=${c}`),h=await f.get("/Blog");k(h.data.totalCount);const S=e.data;B(Array.isArray(S)?S:[])}catch(e){m("Không thể tải danh sách bài viết."),console.error("Lỗi khi lấy danh sách bài viết:",e)}finally{g(!1),r==null||r()}},[l,c,r]);s.useEffect(()=>{j()},[j,i]);const I=e=>{O(Number(e.target.value))},_=e=>{const h=e.target.value;E(h==="true")},b={chart:{type:"bar",toolbar:{show:!1}},xaxis:{categories:n.map(e=>d(e.title,10)),labels:{style:{fontSize:"12px"},rotate:-45,hideOverlappingLabels:!0}},dataLabels:{enabled:!0,formatter:e=>`${e.toLocaleString()}`},tooltip:{y:{formatter:e=>`${e.toLocaleString()} lượt xem`}},plotOptions:{bar:{borderRadius:4}}},$=[{name:"Lượt xem",data:n.map(e=>e.viewCount)}];return t.jsxs(x,{p:5,bg:"white",shadow:"md",borderRadius:"md",h:p||"auto",children:[t.jsxs(a,{fontSize:"xl",fontWeight:"bold",mb:4,children:["Bài viết nổi bật ",t.jsxs(a,{as:"span",fontWeight:"normal",color:"gray.600",fontSize:"md",children:["(Tổng: ",W,")"]})]}),t.jsxs(A,{variant:"soft-rounded",colorScheme:"blue",index:D,onChange:e=>z(e),children:[t.jsxs(v,{justify:"space-between",align:"center",mb:4,mx:0,children:[t.jsxs(H,{children:[t.jsx(C,{children:"Danh sách"}),t.jsx(C,{children:"Biểu đồ cột"})]}),t.jsxs(w,{maxW:"150px",value:c,onChange:_,placeholder:"Sắp xếp theo lượt xem",children:[t.jsx("option",{value:"true",children:"Tăng dần"}),t.jsx("option",{value:"false",children:"Giảm dần"})]}),t.jsxs(w,{value:l,onChange:I,maxW:"150px",placeholder:"Chọn số lượng",children:[t.jsx("option",{value:10,children:"10"}),t.jsx("option",{value:15,children:"15"}),t.jsx("option",{value:20,children:"20"})]})]}),t.jsxs(K,{children:[t.jsx(y,{p:0,maxH:"250px",overflowY:"auto",children:u?t.jsx(L,{h:"100%",children:t.jsx(T,{size:"xl"})}):o?t.jsx(a,{color:"red.500",children:o}):n.length>0?t.jsx(N,{spacing:4,children:n.map(e=>t.jsxs(M,{p:4,borderWidth:"1px",borderRadius:"md",boxShadow:"sm",_hover:{bg:"gray.50"},children:[t.jsx(a,{fontWeight:"bold",children:d(e.title,50)}),t.jsx(x,{sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:P(d(e.content,50))}}),t.jsxs(v,{mt:2,align:"center",flexWrap:"wrap",gap:2,children:[t.jsxs(a,{fontSize:"sm",color:"gray.500",children:[e.coderName||"Người viết không xác định"," |"]}),t.jsxs(a,{fontSize:"sm",color:"gray.500",children:[Y(e.blogDate)," |"]}),t.jsxs(a,{children:[e.viewCount.toLocaleString()," lượt xem"]})]})]},e.id))}):t.jsx(a,{children:"Không có bài viết nào."})}),t.jsx(y,{p:0,children:u?t.jsx(L,{h:"100%",children:t.jsx(T,{size:"xl"})}):o?t.jsx(a,{color:"red.500",children:o}):n.length===0?t.jsx(a,{children:"Không có dữ liệu để hiển thị."}):t.jsx(x,{w:"100%",h:"250px",children:t.jsx(U,{chartData:$,chartOptions:{...b,chart:{...b.chart,height:"100%"}}})})})]})]})]})};export{Z as default};
