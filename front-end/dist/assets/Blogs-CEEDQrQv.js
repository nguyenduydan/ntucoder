import{r as s,j as t,i as f,a4 as d,s as x,D as a,ak as H,x as v,al as K,am as C,aE as w,$ as y,aP as N,aQ as P,a2 as _,bE as M}from"./index-NsYg9CFQ.js";import{C as G}from"./react-apexcharts.min-Cf-y_RYm.js";import{T as Q,a as T}from"./tab-panels-BJxFZm1S.js";import{C as L}from"./center-DP7VjW8g.js";class V extends s.Component{constructor(i){super(i),this.state={chartData:[],chartOptions:{}}}componentDidMount(){this.setState({chartData:this.props.chartData,chartOptions:this.props.chartOptions})}render(){return t.jsx(G,{options:this.state.chartOptions,series:this.state.chartData,type:"bar",width:"100%",height:"100%"})}}const X=({height:p,refreshKey:i,onFinishRefresh:n})=>{const[r,B]=s.useState([]),[u,g]=s.useState(!1),[o,m]=s.useState(null),[D,z]=s.useState(0),[l,O]=s.useState(4),[W,k]=s.useState(0),[c,E]=s.useState(!1),j=s.useCallback(async()=>{g(!0),m(null);try{const e=await f.get(`/Blog/TopViewed?count=${l}&ascingSort=${c}`),h=await f.get("/Blog");k(h.data.totalCount);const S=e.data;B(Array.isArray(S)?S:[])}catch(e){m("Không thể tải danh sách bài viết."),console.error("Lỗi khi lấy danh sách bài viết:",e)}finally{g(!1),n==null||n()}},[l,c,n]);s.useEffect(()=>{j()},[j,i]);const $=e=>{O(Number(e.target.value))},I=e=>{const h=e.target.value;E(h==="true")},b={chart:{type:"bar",toolbar:{show:!1}},xaxis:{categories:r.map(e=>d(e.title,10)),labels:{style:{fontSize:"12px"},rotate:-45,hideOverlappingLabels:!0}},dataLabels:{enabled:!0,formatter:e=>`${e.toLocaleString()}`},tooltip:{y:{formatter:e=>`${e.toLocaleString()} lượt xem`}},plotOptions:{bar:{borderRadius:4}}},A=[{name:"Lượt xem",data:r.map(e=>e.viewCount)}];return t.jsxs(x,{p:5,bg:"white",shadow:"md",borderRadius:"md",h:p||"auto",children:[t.jsxs(a,{fontSize:"xl",fontWeight:"bold",mb:4,children:["Bài viết nổi bật ",t.jsxs(a,{as:"span",fontWeight:"normal",color:"gray.600",fontSize:"md",children:["(Tổng: ",W,")"]})]}),t.jsxs(H,{variant:"soft-rounded",colorScheme:"blue",index:D,onChange:e=>z(e),children:[t.jsxs(v,{justify:"space-between",align:"center",mb:4,mx:0,children:[t.jsxs(K,{children:[t.jsx(C,{children:"Danh sách"}),t.jsx(C,{children:"Biểu đồ cột"})]}),t.jsxs(w,{maxW:"150px",value:c,onChange:I,placeholder:"Sắp xếp theo lượt xem",children:[t.jsx("option",{value:"true",children:"Tăng dần"}),t.jsx("option",{value:"false",children:"Giảm dần"})]}),t.jsxs(w,{value:l,onChange:$,maxW:"150px",placeholder:"Chọn số lượng",children:[t.jsx("option",{value:10,children:"10"}),t.jsx("option",{value:15,children:"15"}),t.jsx("option",{value:20,children:"20"})]})]}),t.jsxs(Q,{children:[t.jsx(T,{p:0,maxH:"250px",overflowY:"auto",children:u?t.jsx(L,{h:"100%",children:t.jsx(y,{size:"xl"})}):o?t.jsx(a,{color:"red.500",children:o}):r.length>0?t.jsx(N,{spacing:4,children:r.map(e=>t.jsxs(P,{p:4,borderWidth:"1px",borderRadius:"md",boxShadow:"sm",_hover:{bg:"gray.50"},children:[t.jsx(a,{fontWeight:"bold",children:d(e.title,50)}),t.jsx(x,{sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:_(d(e.content,50))}}),t.jsxs(v,{mt:2,align:"center",flexWrap:"wrap",gap:2,children:[t.jsxs(a,{fontSize:"sm",color:"gray.500",children:[e.coderName||"Người viết không xác định"," |"]}),t.jsxs(a,{fontSize:"sm",color:"gray.500",children:[M(e.blogDate)," |"]}),t.jsxs(a,{children:[e.viewCount.toLocaleString()," lượt xem"]})]})]},e.id))}):t.jsx(a,{children:"Không có bài viết nào."})}),t.jsx(T,{p:0,children:u?t.jsx(L,{h:"100%",children:t.jsx(y,{size:"xl"})}):o?t.jsx(a,{color:"red.500",children:o}):r.length===0?t.jsx(a,{children:"Không có dữ liệu để hiển thị."}):t.jsx(x,{w:"100%",h:"250px",children:t.jsx(V,{chartData:A,chartOptions:{...b,chart:{...b.chart,height:"100%"}}})})})]})]})]})};export{X as default};
