import{aa as _,g as E,j as e,B as d,F as l,i as L,bT as ie,b as n,as as Q,p as z,bU as ke,D as De,aj as le,r as a,U as V,bG as Te,L as te,bO as Pe,v as se,bP as Le,bQ as ze,bR as Re,bV as Ae,bS as We,bk as ce,z as re,J as ne,E as Y,K as T,a5 as Ne,A as Ee,G as He,bf as he,bg as de,bh as W,bE as ue,bF as N,$ as ae,a0 as G,ah as Fe,S as oe,bW as Me,ax as _e,V as $e,W as Be,X as Ke,Y as Oe,_ as Ye,a4 as Ge,bX as Ue,bY as Ve,o as qe,bZ as Xe,k as U,b_ as Qe,b$ as Je,c0 as Ze,c1 as et,N as tt}from"./react-vendor-UrX0Iyen.js";import{u as st,b as ge,p as rt,s as xe,o as R,a as M,m as nt,P as at,q as ot,h as it,S as lt,N as ct}from"./index-DHxdizMM.js";import{c$ as ht,d0 as dt,aA as ut}from"./vendor-DdjKqKjT.js";import"./charts-vendor-DwxpLNbD.js";import"./lodash-vendor-CBiJWk4A.js";import"./axios-vendor-xsH4HHeE.js";import"./moment-vendor-CTDujYFw.js";const gt=({lesson:r})=>{const i=_(),y=E();return e.jsx(d,{background:"rgb(14 38 67)",h:"8vh",children:e.jsx(l,{justifyContent:"space-between",h:"100%",py:2,px:4,alignItems:"center",children:e.jsxs(l,{textColor:"white",fontSize:"xl",align:"center",children:[e.jsx(L,{leftIcon:e.jsx(ie,{}),color:"white",size:"md",variant:"link",onClick:()=>i(`${y.pathname.replace(/\/\d+$/,"")}`),_hover:{transform:"translateX(-5px)",transition:"transform 0.3s ease"}}),e.jsx(n,{fontWeight:"none",children:r.lessonTitle})]})})})};function xt({lesson:r}){st((r==null?void 0:r.lessonTitle)||"N·ªôi dung b√†i h·ªçc");const{coder:i}=ge();return e.jsxs(d,{px:4,py:5,children:[e.jsxs(l,{px:5,alignItems:"center",gap:4,justifyContent:"space-between",children:[e.jsxs(l,{flex:"1",alignItems:"center",gap:4,children:[e.jsx(rt,{size:"md",src:(i==null?void 0:i.avatar)||"",alt:"Coder Avatar",borderRadius:"full",boxSize:"50px",objectFit:"cover",loading:"lazy"}),e.jsx(Q,{to:`/profile/${i==null?void 0:i.coderID}`,children:e.jsx(n,{maxW:"200px",_hover:{color:"blue"},fontWeight:"bold",children:((i==null?void 0:i.coderName)||"·∫®n danh").replace(/(.{3}).*(@.*)/,"$1******$2")})})]}),e.jsxs(l,{alignItems:"center",children:[e.jsx(z,{as:ke,color:"red"}),e.jsx(n,{ms:1,fontWeight:"bold",fontSize:"lg",children:" 100 ƒëi·ªÉm"})]})]}),e.jsx(De,{my:4}),e.jsx(d,{sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:xe(r==null?void 0:r.lessonContent)}})]})}const mt=({onSelectLesson:r})=>{const{slugId:i}=le(),y=i?i.split("-"):[],p=y.length>0?parseInt(y.pop(),10):NaN,[u,b]=a.useState(null),[j,g]=a.useState(!0),c=V(),h=_(),S=E(),[C,I]=a.useState({}),s=async()=>{if(isNaN(p)){c({title:"L·ªói",description:"ID kh√¥ng h·ª£p l·ªá!",status:"error",duration:3e3,isClosable:!0}),h("/course");return}g(!0);try{const t=await R({controller:"Course",id:p});if(!(t!=null&&t.topics))throw new Error("Kh√¥ng c√≥ d·ªØ li·ªáu kh√≥a h·ªçc");const k=await Promise.all(t.topics.map(async f=>{try{const w=await R({controller:"Topic",id:f.topicID});return{...f,lessons:(w.lessons||[]).filter(D=>Number(D.status)===1)}}catch{return{...f,lessons:[]}}}));b({...t,topics:k});let o={};for(const f of k)(await M.get(`/Progress/lesson-summary?topicId=${f.topicID}`)).data.forEach(D=>{o[D.lessonID]={completed:D.completedProblems,total:D.totalProblems}});I(o)}catch(t){c({title:"L·ªói",description:t.message||"Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu. Vui l√≤ng th·ª≠ l·∫°i!",status:"error",duration:3e3,isClosable:!0}),b(null)}finally{g(!1)}};return a.useEffect(()=>{s()},[p,S.pathname]),e.jsx(d,{children:j?e.jsx(Te,{noOfLines:5,spacing:4}):e.jsx(te,{spacing:0,children:Array.isArray(u==null?void 0:u.topics)&&u.topics.length>0?e.jsxs(Pe,{allowToggle:!0,defaultIndex:[0],children:[" ",u.topics.map((t,k)=>e.jsx(se,{bg:"gray.100",borderRadius:"md",children:e.jsx(Le,{border:"none",children:({isExpanded:o})=>{var f,w,D,$;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:e.jsxs(ze,{_expanded:{bg:"gray.200"},borderRadius:"sm",children:[e.jsxs(d,{flex:"1",textAlign:"left",borderBottomWidth:2,borderStyle:"dashed",py:2,children:[e.jsxs(n,{fontSize:"lg",children:[e.jsxs(n,{as:"span",fontWeight:"bold",children:["Ch·ªß ƒë·ªÅ ",k+1,":"]})," ",(t==null?void 0:t.topicName)||"Kh√¥ng c√≥ t√™n"]}),e.jsxs(l,{alignItems:"center",gap:10,fontSize:"sm",children:[e.jsxs(l,{alignItems:"center",gap:1,children:[e.jsx(Re,{color:"black"}),e.jsxs(n,{children:["T·ªïng s·ªë b√†i h·ªçc: ",((f=t==null?void 0:t.lessons)==null?void 0:f.length)||0]})]}),e.jsxs(l,{alignItems:"center",gap:1,children:[e.jsx(Ae,{color:"black"}),e.jsxs(n,{children:["Ti·∫øn ƒë·ªô: ",((w=t==null?void 0:t.lessons)==null?void 0:w.length)||0]})]})]})]}),o?e.jsx(ht,{boxSize:4}):e.jsx(dt,{boxSize:4})]})}),e.jsx(We,{pb:4,children:(D=t.lessons)!=null&&D.length?e.jsx(te,{spacing:2,children:($=t.lessons)==null?void 0:$.map(v=>e.jsx(Q,{to:`${S.pathname.replace(/\/\d+$/,"")}/${v.lessonID}`,style:({isActive:q})=>({textDecoration:"none",color:q?"blue.500":"inherit"}),onClick:()=>r==null?void 0:r(v.lessonID),children:e.jsx(se,{cursor:"pointer",_hover:{bg:"gray.300",transform:"scale(1.01)"},transition:"all .2s ease-in-out",pl:2,bg:"gray.50",borderRadius:"sm",p:2,children:e.jsxs(l,{alignItems:"center",justifyContent:"space-between",gap:2,fontSize:"md",children:[e.jsxs(n,{fontSize:"md",children:["üìö ",v.lessonTitle||"Kh√¥ng c√≥ t√™n b√†i h·ªçc"," "]}),C[v.lessonID]?C[v.lessonID].completed===C[v.lessonID].total&&C[v.lessonID].total>0?e.jsx(z,{as:ce,fontSize:"lg",color:"green"}):e.jsxs(n,{as:"span",ml:2,color:"inherit",fontWeight:"bold",children:[C[v.lessonID].completed,"/",C[v.lessonID].total]}):"0/0"]})},v.lessonID||Math.random())}))}):e.jsx(n,{fontSize:"md",color:"gray.500",children:"Kh√¥ng c√≥ b√†i h·ªçc n√†o."})})]})}},t==null?void 0:t.topicID)},(t==null?void 0:t.topicID)||k))]}):e.jsx(n,{fontSize:"md",color:"gray.500",children:"Kh√¥ng c√≥ ch·ªß ƒë·ªÅ n√†o."})})})},X=[{Header:"STT"},{Header:"T√†i kho·∫£n"},{Header:"Th·ªùi gian n·ªôp"},{Header:"Ng√¥n ng·ªØ"},{Header:"Ki·ªÉm th·ª≠"},{Header:"ƒêi·ªÉm"},{Header:"Th·ªùi gian"}],pt=()=>{const r=E(),i=_(),p=new URLSearchParams(r.search).get("problemID"),[u,b]=a.useState(!1),[j,g]=a.useState([]),[c,h]=a.useState({currentPage:1,pageSize:10,totalPages:0,totalCount:0}),S=a.useCallback(async()=>{if(p){b(!0);try{const s=await M.get("/Submission/history",{params:{problemId:p,page:c.currentPage,pageSize:c.pageSize}}),{data:t,currentPage:k,pageSize:o,totalPages:f,totalCount:w}=s.data;g(t),h({currentPage:k,pageSize:o,totalPages:f,totalCount:w})}catch(s){console.error("Error fetching history",s)}finally{b(!1)}}},[p,c.currentPage,c.pageSize]);a.useEffect(()=>{S()},[S]);const C=s=>{h(t=>({...t,currentPage:s}))},I=s=>{h(t=>({...t,pageSize:s,currentPage:1}))};return e.jsxs(d,{p:4,children:[e.jsx(l,{justify:"flex-end",mb:3,children:e.jsx(L,{onClick:S,colorScheme:"blue",borderRadius:"md",size:"sm",children:"Refresh"})}),u?e.jsx(re,{variant:"striped",maxH:"450px",overflowY:"auto",children:e.jsx(ne,{children:Array.from({length:5}).map((s,t)=>e.jsx(Y,{children:X.map((k,o)=>e.jsx(T,{p:3,children:e.jsx(Ne,{height:"20px"})},o))},`skeleton-${t}`))})}):e.jsxs(re,{variant:"striped",colorScheme:"blue",children:[e.jsx(Ee,{children:e.jsx(Y,{children:X.map((s,t)=>e.jsx(He,{fontSize:"xs",textAlign:"center",maxW:"80px",p:2,children:s.Header},t))})}),e.jsx(ne,{children:j.length===0?e.jsx(Y,{children:e.jsx(T,{colSpan:X.length,textAlign:"center",fontSize:"sm",children:"Ch∆∞a c√≥ b√†i l√†m n√†o"})}):j.map((s,t)=>e.jsxs(Y,{children:[e.jsx(T,{p:2,fontSize:"sm",textAlign:"center",children:(c.currentPage-1)*c.pageSize+t+1}),e.jsx(T,{p:2,fontSize:"sm",textAlign:"center",children:e.jsx(L,{onClick:()=>i(`/profile/${s.coderID}`),variant:"link",colorScheme:"black",fontSize:"sm",fontWeight:"normal",_hover:{color:"blue.500",textDecoration:"underline"},children:s.coderName})}),e.jsx(T,{p:2,fontSize:"sm",textAlign:"center",children:nt(s.submitTime)}),e.jsx(T,{p:2,fontSize:"sm",textAlign:"center",children:s.compilerName||"---"}),e.jsx(T,{p:2,fontSize:"sm",textAlign:"center",fontWeight:"bold",color:s.testResult==="Accepted"?"green.500":/fail|wrong|error/i.test(s.testResult)?"red.500":"yellow.500",children:s.testResult||"--/--"}),e.jsx(T,{p:2,fontSize:"sm",textAlign:"center",children:s.point}),e.jsx(T,{p:2,fontSize:"sm",textAlign:"center",children:s.maxTimeDuration!=null?`${s.maxTimeDuration} ms`:"--"})]},s.submissionID||t))})]}),e.jsx(at,{currentPage:c.currentPage,totalPages:c.totalPages,pageSize:c.pageSize,totalRows:c.totalCount,onPageChange:C,onPageSizeChange:I})]})},bt=({hasRun:r,id:i,errors:y,testCaseResult:p})=>{const[u,b]=a.useState([]),[j,g]=a.useState(null);return a.useEffect(()=>{i&&(async()=>{try{const h=await R({controller:"Problem",id:i}),S=await ot({controller:"TestCase",problemid:i});(S||h)&&(g(h.timeLimit||null),b(S.data||[]))}catch(h){console.error("L·ªói khi l·∫•y d·ªØ li·ªáu test case:",h)}})()},[i]),e.jsxs(d,{maxH:"25vh",bg:"gray.900",color:"white",px:4,py:3,overflowY:"auto",children:[!r&&u.length===0&&e.jsx(n,{color:"gray.400",border:"1px solid",borderColor:"gray.600",px:3,py:2,borderRadius:"md",children:"Vui l√≤ng ch·∫°y th·ª≠ code ƒë·ªÉ xem k·∫øt qu·∫£ ƒë·∫ßy ƒë·ªß!"}),e.jsxs(he,{isLazy:!0,variant:"enclosed",colorScheme:"white",mt:3,children:[e.jsx(de,{children:u.length===0?e.jsx(W,{children:"Testcase 1"},0):u.map((c,h)=>e.jsxs(W,{children:["Testcase ",h+1]},h))}),e.jsx(ue,{children:u.length===0?e.jsx(N,{children:e.jsxs(ae,{templateColumns:"2fr 1fr",bg:"gray.700",p:4,borderRadius:"md",fontSize:"14px",children:[e.jsxs(G,{children:[e.jsxs(l,{justify:"start",children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"ƒê·∫ßu v√†o:"}),e.jsx(n,{children:'""'})]}),e.jsxs(l,{justify:"start",children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"ƒê·∫ßu ra th·ª±c t·∫ø:"}),e.jsx(n,{children:'""'})]}),e.jsxs(l,{justify:"start",children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"ƒê·∫ßu ra mong ƒë·ª£i:"}),e.jsx(n,{children:'""'})]}),e.jsxs(l,{justify:"start",children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"Gi·ªõi h·∫°n th·ªùi gian:"}),e.jsx(n,{children:'""'})]}),e.jsxs(l,{justify:"start",children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"Th·ªùi gian th·ª±c thi:"}),e.jsx(n,{children:'""'})]})]}),e.jsxs(G,{children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"Hi·ªÉn th·ªã l·ªói"}),e.jsx(n,{bg:"black",minH:"12vh",borderRadius:"md",p:2,children:y||"Kh√¥ng c√≥ l·ªói"})]})]})},0):u.map((c,h)=>e.jsx(N,{children:e.jsxs(ae,{templateColumns:"2fr 1fr",bg:"gray.700",p:4,borderRadius:"md",fontSize:"14px",children:[e.jsxs(G,{children:[e.jsxs(l,{justify:"start",children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"ƒê·∫ßu v√†o:"}),e.jsx(n,{children:c.input||'" "'})]}),e.jsxs(l,{justify:"start",children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"ƒê·∫ßu ra th·ª±c t·∫ø:"}),e.jsx(n,{children:p.actualOutput||'" "'})]}),e.jsxs(l,{justify:"start",children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"ƒê·∫ßu ra mong ƒë·ª£i:"}),e.jsx(n,{children:c.output||'" "'})]}),e.jsxs(l,{justify:"start",children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"Gi·ªõi h·∫°n th·ªùi gian:"}),e.jsxs(n,{children:[j||'" "'," ms"]})]}),e.jsxs(l,{justify:"start",children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"Th·ªùi gian th·ª±c thi:"}),e.jsxs(n,{children:[p.execTime||'" "'," ms"]})]})]}),e.jsxs(G,{children:[e.jsx(n,{fontWeight:"bold",mr:5,children:"Hi·ªÉn th·ªã l·ªói"}),e.jsx(n,{bg:"black",minH:"12vh",borderRadius:"md",p:2,children:y||"Kh√¥ng c√≥ l·ªói"})]})]})},h))})]})]})};function jt(){const r=E(),{coder:i}=ge(),{isOpen:y,onOpen:p,onClose:u}=ut(),[b,j]=a.useState({bg:"gray.100",colorScheme:"gray"}),[g,c]=a.useState({status:!1,type:""}),h=V(),S=_(),[C,I]=a.useState([]),[s,t]=a.useState("cpp"),o=new URLSearchParams(r.search).get("problemID"),[f,w]=a.useState(`#include<iostream>
using namespace std;

int main() {
    cout << "Hello C++";
    return 0;
}`),[D,$]=a.useState("vs-dark"),[v,q]=a.useState(null),[me,pe]=a.useState({input:"",actualOutput:"",expectedOutput:"",timeLimit:"",execTime:""}),[be,B]=a.useState(""),[je,H]=a.useState(""),[J,Z]=a.useState(!1),[fe,ye]=a.useState(!1);a.useEffect(()=>{(async()=>{if(o!==null)try{const m=await R({controller:"Problem",id:o}),P=(await it({controller:"Compiler",page:1,pageSize:10})).data;if(I(P),P.length>0){const K=P[0];t(K)}w(m.testCode||"")}catch(m){console.error("L·ªói khi l·∫•y d·ªØ li·ªáu b√†i t·∫≠p:",m)}})()},[o]);const ee=x=>{switch(x){case"Accepted":case"Success":B("‚úÖ Ch·∫°y th·ª≠ th√†nh c√¥ng"),H("Ch√∫c m·ª´ng! B√†i l√†m ƒë√∫ng ho·∫∑c kh√¥ng c√≥ l·ªói."),j({bg:"green.100",colorScheme:"green"}),Z(!0);break;case"Wrong Answer":H("‚ùå Sai k·∫øt qu·∫£"),j({bg:"yellow.100",colorScheme:"yellow"});break;case"Runtime Error":B("üí• Runtime Error"),H("Ch∆∞∆°ng tr√¨nh g·∫∑p l·ªói khi th·ª±c thi."),j({bg:"red.100",colorScheme:"red"});break;case"Compilation Error":B("üîß Compilation Error"),H("C√≥ l·ªói bi√™n d·ªãch. H√£y ki·ªÉm tra l·∫°i c√∫ ph√°p."),j({bg:"orange.100",colorScheme:"orange"});break;default:B("‚ö†Ô∏è Kh√¥ng x√°c ƒë·ªãnh"),H("Kh√¥ng th·ªÉ x√°c ƒë·ªãnh tr·∫°ng th√°i k·∫øt qu·∫£."),j({bg:"gray.100",colorScheme:"gray"}),Z(!1);break}},Se=async()=>{c({status:!0,type:"test"});try{const m=(await M.post("/CodeExecute/try-run",{sourceCode:f,compilerExtension:s.compilerExtension,problemId:parseInt(o)})).data;m.error?h({title:"L·ªói k·∫øt n·ªëi",status:"error",duration:2e3,isClosable:!0,variant:"left-accent",position:"top"}):(pe({input:m.input||"",actualOutput:m.output||"",expectedOutput:m.expectedOutput||"",timeLimit:m.timeLimit||"",execTime:m.timeDuration||""}),q(m.error||""),ee(m.result)),p()}catch(x){console.error("L·ªói khi g·ª≠i y√™u c·∫ßu ch·∫°y th·ª≠:",x),h({title:"L·ªói k·∫øt n·ªëi",status:"error",duration:2e3,isClosable:!0,variant:"left-accent",position:"top"})}finally{c({status:!1,type:""})}},Ce=async()=>{var x,m,A,P,K;c({status:!0,type:"submit"});try{const F={problemId:o,compilerID:s.compilerID,submissionCode:f,coderID:i.coderID},O=await M.post("/Submission/submit",F);O.status===200&&(ee(O.data.testRuns[0].result),p(),ye(!0))}catch(F){console.error("L·ªói khi g·ª≠i y√™u c·∫ßu n·ªôp b√†i:",F);const O=((A=(m=(x=F.response)==null?void 0:x.data)==null?void 0:m.errors)==null?void 0:A[0])||((K=(P=F.response)==null?void 0:P.data)==null?void 0:K.message)||"L·ªói kh√¥ng x√°c ƒë·ªãnh.";h({title:"L·ªói n·ªôp b√†i",status:"warning",variant:"solid",description:O,duration:2e3,isClosable:!0,position:"top"})}finally{c({status:!1,type:""})}},we=x=>{const m=Number(x.target.value),A=C.find(P=>P.compilerID===m);A&&t(A)},Ie=()=>{if(!o)return;const x=parseInt(o)+1,m=new URLSearchParams(r.search);m.set("problemID",x),S(`${r.pathname}?${m.toString()}`),u()},ve=x=>{$(x.target.value)};return e.jsxs(Fe,{h:"100%",spacing:0,align:"stretch",children:[e.jsx(d,{p:4,bg:"gray.900",color:"white",children:e.jsxs(l,{justifyContent:"space-between",alignItems:"center",children:[e.jsx(oe,{w:"20%",value:(s==null?void 0:s.compilerID)||"",onChange:we,bg:"transparent",color:"white",sx:{option:{color:"white",bg:"gray.900"}},isDisabled:g.status,cursor:"pointer",children:C.map(x=>e.jsx("option",{value:x.compilerID,children:x.compilerName},x.compilerID))}),e.jsxs(l,{width:"70%",justify:"end",align:"center",gap:4,children:[e.jsxs(oe,{w:"20%",value:D,onChange:ve,bg:"transparent",color:"white",sx:{option:{color:"white",bg:"gray.900"}},isDisabled:g.status,cursor:"pointer",children:[e.jsx("option",{value:"vs-dark",children:"T·ªëi"}),e.jsx("option",{value:"vs-light",children:"S√°ng"})]}),e.jsx(L,{colorScheme:"blue",borderRadius:"md",onClick:Se,isLoading:g.status&&g.type==="test",loadingText:"ƒêang ch·∫°y...",isDisabled:g.status||o===null,children:"Ch·∫°y th·ª≠"}),e.jsx(L,{leftIcon:e.jsx(Me,{}),color:J?"green":"gray.500",borderRadius:"md",onClick:Ce,isLoading:g.status&&g.type==="submit",loadingText:"ƒêang ch·∫°y...",isDisabled:!J||g.status||o===null,children:"N·ªôp b√†i"})]})]})}),e.jsx(d,{h:"100%",overflow:"hidden",overflowY:"hidden",children:e.jsxs(l,{direction:"column",h:"100%",children:[e.jsx(d,{flex:"6",overflow:"hidden",borderBottom:"1px solid #555",children:e.jsx(_e,{height:"100%",language:s!=null&&s.compilerExtension?s.compilerExtension.replace(".",""):"plaintext",theme:D,value:f,onChange:x=>w(x||""),options:{fontSize:14,minimap:{enabled:!1},readOnly:g.status}})}),e.jsx(d,{flex:"3",overflow:"hidden",bg:"gray.900",children:e.jsx(bt,{hasRun:!0,id:o,errors:v,testCaseResult:me})})]})}),e.jsxs($e,{isOpen:y,onClose:u,isCentered:!0,children:[e.jsx(Be,{}),e.jsxs(Ke,{bg:b.bg,children:[e.jsx(Oe,{textAlign:"center",children:be||""}),e.jsx(Ye,{textAlign:"center",fontSize:"lg",children:je||""}),e.jsx(Ge,{children:e.jsxs(l,{w:"100%",justify:"center",gap:2,children:[e.jsx(L,{colorScheme:b.colorScheme,onClick:u,children:"ƒê√≥ng"}),fe&&e.jsx(L,{colorScheme:"teal",onClick:Ie,children:"B√†i ti·∫øp theo"})]})})]})]})]})}const ft=({problem:r,onBack:i})=>e.jsxs(d,{px:4,py:5,children:[e.jsx(L,{leftIcon:e.jsx(ie,{}),color:"blue.500",size:"md",variant:"link",onClick:i,_hover:{transform:"translateX(-5px)",transition:"transform 0.3s ease"},mb:3,children:"Quay l·∫°i danh s√°ch b√†i t·∫≠p"}),e.jsx(d,{fontSize:"xl",fontWeight:"bold",mb:2,children:r==null?void 0:r.problemName}),e.jsx(d,{sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:xe(r==null?void 0:r.problemContent)}})]}),yt=({lessonID:r})=>{const[i,y]=a.useState(null),[p,u]=a.useState(null),b=V(),j=E(),g=_(),h=new URLSearchParams(j.search).get("problemID"),[S,C]=a.useState([]),I=a.useCallback(async()=>{try{const o=await R({controller:"Lesson",id:r});y(o.lessonProblems||[])}catch(o){console.error("L·ªói khi l·∫•y d·ªØ li·ªáu b√†i h·ªçc:",o),b({title:"L·ªói",description:"Kh√¥ng th·ªÉ t·∫£i b√†i h·ªçc.",status:"error",duration:3e3,position:"top-right",variant:"top-accent",isClosable:!0})}},[r,b]),s=a.useCallback(async()=>{if(!h){u(null);return}try{const o=await R({controller:"Problem",id:h});u(o)}catch(o){console.error("L·ªói khi l·∫•y chi ti·∫øt b√†i t·∫≠p:",o),b({title:"L·ªói",description:"Kh√¥ng th·ªÉ t·∫£i chi ti·∫øt b√†i t·∫≠p.",status:"error",duration:3e3,position:"top-right",variant:"top-accent",isClosable:!0})}},[h,b]),t=a.useCallback(async()=>{try{const f=(await M.get(`/Progress/solved-problems?lessonId=${r}`)).data.map(w=>w.problemId);C(f)}catch(o){console.error("L·ªói khi l·∫•y danh s√°ch b√†i ƒë√£ ho√†n th√†nh:",o)}},[r]);a.useEffect(()=>{isNaN(r)||(I(),t())},[r,I,t]),a.useEffect(()=>{s()},[s]);const k=()=>{g(j.pathname),s(),I(),t()};return e.jsx(d,{p:5,children:!h||!p?e.jsxs(d,{children:[e.jsx(d,{fontSize:"xl",fontWeight:"bold",mb:4,children:"Danh s√°ch b√†i t·∫≠p"}),e.jsx(d,{children:!i||i.length===0?e.jsx(d,{children:"Kh√¥ng c√≥ b√†i t·∫≠p n√†o h·∫øt nha."}):i.map((o,f)=>{const w=S.includes(o.problemID);return e.jsx(Q,{to:`${j.pathname}?problemID=${o.problemID}`,children:e.jsx(d,{p:2,borderBottom:"1px solid #eee",_hover:{bg:"gray.300",transform:"scale(1.01)"},transition:"all 0.2s",borderRadius:"md",cursor:"pointer",children:e.jsxs(l,{alignItems:"center",justifyContent:"space-between",children:[e.jsxs(l,{alignItems:"center",gap:2,children:[e.jsx(Ue,{}),e.jsxs(n,{children:[f+1,". ",o.problemName]})]}),e.jsx(z,{as:w?ce:Ve,color:w?"green.500":"gray.400",fontSize:"xl"})]})})},o.problemID)})})]}):e.jsx(ft,{problem:p,onBack:k})})};function Tt(){const{lessonId:r}=le(),i=V(),[y,p]=a.useState(null),[u,b]=a.useState(0),[j,g]=a.useState(!0),c=E(),S=new URLSearchParams(c.search).get("problemID"),C=()=>{b(0)};return a.useEffect(()=>{const I=async()=>{try{const s=await R({controller:"Lesson",id:r});s&&s.lessonTitle&&s.lessonContent?p(s):(i({title:"L·ªói khi l·∫•y d·ªØ li·ªáu b√†i h·ªçc",status:"error",duration:2e3,isClosable:!0,position:"top-right"}),console.log("Kh√¥ng c√≥ d·ªØ li·ªáu b√†i h·ªçc"))}catch{g(!1),i({title:"L·ªói khi l·∫•y d·ªØ li·ªáu b√†i h·ªçc",status:"error",duration:2e3,isClosable:!0,position:"top-right"})}finally{g(!1)}};isNaN(r)||I()},[r,i]),e.jsx(lt,{children:e.jsx(d,{h:"712px",w:"100%",display:"flex",flexDirection:"column",children:j?e.jsx(l,{justify:"center",align:"center",height:"100vh",children:e.jsx(qe,{size:"xl",color:"blue.500"})}):y?e.jsxs(d,{flex:"1",display:"flex",flexDirection:"column",overflow:"hidden",children:[e.jsx(gt,{lesson:y}),e.jsx(d,{flex:"1",overflow:"hidden",children:e.jsxs(Xe,{className:"split-container",sizes:[45,55],minSize:0,gutterSize:5,style:{height:"100%"},children:[e.jsx(d,{bg:"white",h:"100%",overflow:"hidden",children:e.jsx(he,{orientation:"vertical",h:"100%",variant:"unstyled",index:u,onChange:I=>b(I),children:e.jsxs(l,{h:"100%",w:"100%",overflow:"hidden",children:[e.jsxs(de,{bg:"blue.600",color:"white",display:"flex",flexDirection:"column",alignItems:"center",h:"100%",children:[e.jsx(U,{label:"M√¥ t·∫£",placement:"right",hasArrow:!0,children:e.jsx(W,{py:4,_selected:{bg:"blue.800"},children:e.jsx(z,{as:Qe,boxSize:5})})}),e.jsx(U,{label:"Gi√°o tr√¨nh",placement:"right",hasArrow:!0,children:e.jsx(W,{py:4,_selected:{bg:"blue.800"},children:e.jsx(z,{as:Je,boxSize:5})})}),e.jsx(U,{label:"B√†i t·∫≠p",placement:"right",hasArrow:!0,children:e.jsx(W,{py:4,_selected:{bg:"blue.800"},children:e.jsx(z,{as:Ze,boxSize:5})})}),S&&e.jsx(U,{label:"L·ªãch s·ª≠",placement:"right",hasArrow:!0,children:e.jsx(W,{py:4,_selected:{bg:"blue.800"},children:e.jsx(z,{as:et,boxSize:5})})})]}),e.jsxs(ue,{flex:"1",h:"100%",overflow:"hidden",children:[e.jsx(N,{p:0,h:"100%",overflowY:"auto",children:e.jsx(xt,{lesson:y})}),e.jsxs(N,{p:0,h:"100%",overflowY:"auto",children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",px:4,pt:2,children:"Gi√°o Tr√¨nh"}),e.jsx(mt,{onSelectLesson:C})]}),e.jsx(N,{p:0,h:"100%",overflowY:"auto",children:e.jsx(yt,{lessonID:r})}),S&&e.jsxs(N,{p:0,h:"100%",overflowY:"auto",children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",px:4,pt:2,children:"L·ªãch s·ª≠"}),e.jsx(pt,{})]})]})]})})}),e.jsx(d,{bg:"black",h:"100%",overflow:"auto",color:"white",children:e.jsx(jt,{})})]})})]}):e.jsx(l,{justify:"center",align:"center",height:"70vh",children:e.jsx(tt,{src:ct,alt:"Kh√¥ng c√≥ d·ªØ li·ªáu",h:"50%",objectFit:"fill",backgroundColor:"transparent"})})})})}export{Tt as default};
