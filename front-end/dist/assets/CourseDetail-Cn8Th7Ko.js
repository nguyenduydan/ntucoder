import{au as Ee,r as a,j as e,a7 as p,av as we,aw as Ce,E as Z,u as oe,i as F,s as h,Q as ie,D as t,aq as le,y as G,ax as Me,T as He,x as B,B as b,ay as ce,$ as Fe,ab as $e,a8 as U,Y as I,az as Ne,O as Oe,al as We,aA as Pe,aB as ke,aC as _e,I as ve,aD as Ge,aE as Ke,an as ae,aF as Ye,aG as Ie,a as De,aH as ze,c as Re,e as Le,h as Ae,m as Xe,w as Ve,aI as Ue,aJ as he,l as Ze,S as Qe,z as qe,a2 as de,ar as Je,as as se,ac as xe,aK as ge,aL as pe,aM as me,aN as ue,aO as je,aa as fe,ak as es,am as te,aP as be,aQ as ye,aR as ss}from"./index-NsYg9CFQ.js";import{C as Se,A as ts,a as ns,b as as,M as rs,c as is,d as os}from"./Minus-DST6VH5P.js";import{S as V}from"./skeleton-text-DPG-mtU0.js";import{T as ls,a as ne}from"./tab-panels-BJxFZm1S.js";const cs=Ee({d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z",displayName:"ArrowBackIcon"});function hs({value:n,onChange:u}){const[o,s]=a.useState(0);return e.jsx(p,{spacing:.5,children:[1,2,3,4,5].map(r=>e.jsx(we,{icon:e.jsx(Ce,{fontSize:"24px"}),variant:"ghost",color:r<=(o||n)?"yellow.400":"gray.300",onMouseEnter:()=>s(r),onMouseLeave:()=>s(0),onClick:()=>u(r),"aria-label":`Chọn ${r} sao`,size:"lg",boxSize:"40px",_hover:{transform:"scale(1.2)"}},r))})}const ds=({courseId:n})=>{const{isAuthenticated:u}=Z(),[o,s]=a.useState({rating:5,content:""}),[r,d]=a.useState([]),[D,m]=a.useState(!0),[C,z]=a.useState([0,0,0,0,0]),x=oe(),[k,R]=a.useState(!1),$=k?r:r.slice(0,5),A=()=>{R(i=>!i)},j=a.useCallback(async()=>{try{const f=(await F.get(`/Review?courseId=${n}`)).data||[];d(f);const L=[0,0,0,0,0];f.forEach(E=>L[E.rating-1]++),z(L.reverse())}catch(i){x({title:"Lỗi",description:i.message,status:"error"})}finally{m(!1)}},[n,x]),T=async()=>{try{const i=await F.post(`/Review?courseId=${n}`,o);(i.status===200||i.status===201)&&(x({title:"Thành công",description:"Đánh giá đã được gửi!",status:"success",variant:"top-accent",duration:2e3,position:"top",isClosable:!0}),s({...o,content:"",rating:5})),j()}catch(i){x({title:"Thất bại",description:i.message,status:"error",variant:"top-accent",duration:2e3,position:"top",isClosable:!0})}};a.useEffect(()=>{j()},[j]);const v=r.length,H=v>0?(r.reduce((i,f)=>i+f.rating,0)/v).toFixed(1):0;return e.jsxs(h,{mx:"auto",p:4,children:[e.jsx(ie,{size:"lg",mb:4,children:"Đánh giá khóa học"}),e.jsxs(p,{spacing:6,align:"start",mb:6,children:[e.jsxs(h,{minW:"200px",children:[e.jsx(t,{fontSize:"5xl",children:H}),e.jsx(p,{children:[...Array(5)].map((i,f)=>e.jsx(le,{boxSize:7,color:f<Math.round(H)?"yellow.400":"gray.300"},f))}),e.jsxs(t,{color:"gray.500",mt:3,children:["(",v," đánh giá)"]})]}),e.jsx(G,{align:"start",flex:1,children:[5,4,3,2,1].map((i,f)=>{const L=v?Math.round(C[f]/v*100):0;return e.jsxs(p,{w:"100%",children:[e.jsxs(t,{w:"30px",flex:"0.1",children:[i," sao"]}),e.jsx(Me,{value:L,flex:"1",size:"sm",colorScheme:"yellow",bg:"gray.200",rounded:"md",sx:{"& > div":{backgroundColor:"yellow.400"}}}),e.jsxs(t,{w:"40px",textAlign:"right",color:"gray.400",children:[L,"%"]})]},i)})})]}),u&&e.jsxs(h,{mb:8,children:[e.jsx(ie,{size:"md",mb:3,children:"Viết đánh giá"}),e.jsx(He,{placeholder:"Nội dung đánh giá của bạn...",value:o.content,onChange:i=>s({...o,content:i.target.value}),mb:3,resize:"none",h:"140px"}),e.jsxs(B,{justify:"flex-end",children:[e.jsx(hs,{value:o.rating,onChange:i=>s({...o,rating:i})}),e.jsx(b,{colorScheme:"blue",ml:3,onClick:T,isDisabled:o.content.length===0,children:"Gửi đánh giá"})]})]}),e.jsx(ce,{mb:6}),e.jsx(ie,{size:"md",mb:4,children:"Đánh giá của người học"}),D?e.jsx(Fe,{}):$.length===0?e.jsx(t,{children:"Chưa có đánh giá nào."}):$.map(i=>e.jsxs(h,{mb:2,p:3,borderRadius:"md",children:[e.jsxs(p,{mb:1,children:[e.jsx($e,{coderID:i.coderID,size:"sm"}),e.jsxs(h,{children:[e.jsx(U,{to:`/profile/${i.coderID}`,children:e.jsx(t,{_hover:{color:"blue"},fontWeight:"bold",children:(i.coderName||"Ẩn danh").replace(/(.{3}).*(@.*)/,"$1******$2")})}),e.jsxs(p,{spacing:1,children:[[...Array(5)].map((f,L)=>e.jsx(I,{as:le,color:L<i.rating?"yellow.400":"gray.300"},L)),e.jsx(t,{fontSize:"xs",color:"gray.500",children:Ne(i.createdAt)})]})]})]}),e.jsx(t,{mt:2,children:i.content}),e.jsx(ce,{mt:2})]},i.reviewID)),r.length>5&&e.jsx(b,{mt:4,variant:"outline",colorScheme:"black",_hover:{bg:"black",color:"white"},onClick:A,children:k?"Thu gọn":"Xem thêm"})]})},xs=Oe(h),gs={hidden:{opacity:0,y:-50},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}},normal:{opacity:1,y:0}},ps=({children:n,offsetTop:u=64,...o})=>{const s=a.useRef(null),[r,d]=a.useState(!1),[D,m]=a.useState(0),[C,z]=a.useState(0);return a.useEffect(()=>{const x=s.current;if(!x)return;const k=x.getBoundingClientRect().top+window.scrollY;m(x.offsetHeight);const R=()=>{const A=window.scrollY+u>=k;A&&!r?(d(!0),z(j=>j+1)):!A&&r&&d(!1)};return window.addEventListener("scroll",R),()=>window.removeEventListener("scroll",R)},[r,u]),e.jsxs(h,{children:[r&&e.jsx(h,{height:`${D}px`}),e.jsx(xs,{ref:s,position:r?"fixed":"static",top:r?`${u}px`:"auto",left:0,zIndex:"100",width:"100%",bg:"white",boxShadow:r?"md":"none",borderBottom:"1px solid",borderColor:"gray.200",variants:gs,initial:r?"hidden":"normal",animate:r?"visible":"normal",...o,children:e.jsx(We,{height:r?"75px":"auto",justifyContent:r?"center":"flex-start",children:n})},C)]})};function ms(n){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",strokeWidth:"2",d:"M22,3 L2,11 L20.5,19 L22,3 Z M10,20.5 L13,16 M15.5,9.5 L9,14 L9.85884537,20.0119176 C9.93680292,20.5576204 10.0751625,20.5490248 10.1651297,20.009222 L11,15 L15.5,9.5 Z"},child:[]}]})(n)}const us=({coder:n,newComment:u,setNewComment:o,handleAddComment:s,...r})=>e.jsxs(p,{mt:3,align:"center",spacing:3,px:5,children:[e.jsx(ke,{size:"sm",name:(n==null?void 0:n.name)||"Bạn",src:(n==null?void 0:n.avatar)||"https://bit.ly/prosper-baba"}),e.jsxs(_e,{bg:"white",children:[e.jsx(ve,{pr:"5.5rem",placeholder:"Viết bình luận...",boxShadow:"md",value:u,onChange:d=>o(d.target.value),onKeyDown:d=>d.key==="Enter"&&s(),...r}),e.jsx(Ge,{width:"3rem",children:e.jsx(we,{icon:e.jsx(ms,{}),colorScheme:"green",size:"sm",onClick:s,"aria-label":"Gửi bình luận"})})]})]}),js=5,Te=({comment:n,onReply:u,onDelete:o,globalExpand:s})=>{var E,N;const{coder:r,isAuthenticated:d}=Z(),D=oe(),[m,C]=a.useState(!1),[z,x]=a.useState(""),[k,R]=a.useState(!1),[$,A]=a.useState(!1),j=a.useRef();a.useEffect(()=>{R(s)},[s]);const T=()=>A(!0),v=()=>A(!1),H=async()=>{if(z.trim()!=="")try{const y={content:z.trim(),courseID:n.courseID,parentCommentID:n.commentID},K=(r==null?void 0:r.token)||localStorage.getItem("token"),W=await F.post("/comments",y,{headers:{Authorization:`Bearer ${K}`}});u(n.commentID,{...W.data,replies:[]}),x(""),C(!1),R(!0)}catch(y){console.error("Add reply error",y),D({title:"Lỗi khi gửi bình luận",status:"error",position:"top",variant:"top-accent",duration:"1000"})}},i=()=>{C(!0),x(`@${n.coderName} `)},f=()=>{C(!1),x("")},L=async()=>{try{await F.delete(`/comments/${n.commentID}`),o(n.commentID),D({title:"Bạn đã xóa bình luận này",status:"success",position:"top",variant:"top-accent",duration:"1000"}),v()}catch(y){console.error("Delete comment error",y),D({title:"Bạn không thể xóa bình luận này",status:"error",position:"top",variant:"top-accent",duration:"1000"}),v()}};return e.jsxs(h,{children:[e.jsxs(B,{align:"flex-start",mb:2,position:"relative",children:[e.jsx(ke,{size:"sm",name:n.coderName,src:n.coderAvatar,mr:3,mt:5,zIndex:1}),e.jsxs(h,{bg:"gray.200",p:3,borderRadius:"md",w:"full",zIndex:1,children:[e.jsxs(B,{justify:"space-between",align:"center",children:[e.jsx(U,{to:`/profile/${n.coderID}`,children:e.jsx(t,{fontWeight:"bold",fontSize:"sm",children:n.coderName})}),d&&(r==null?void 0:r.coderID)===n.coderID&&e.jsx(b,{size:"xs",colorScheme:"red",variant:"ghost",onClick:T,children:"Xóa"})]}),e.jsx(t,{fontSize:"sm",mt:1,children:n.content}),e.jsxs(p,{mt:2,spacing:4,children:[e.jsx(t,{fontSize:"xs",color:"gray.500",children:Ye(n.commentTime)}),e.jsx(b,{size:"xs",variant:"link",colorScheme:"blue",onClick:i,children:"Trả lời"}),((E=n.replies)==null?void 0:E.length)>0&&e.jsx(b,{size:"xs",variant:"link",colorScheme:"gray",onClick:()=>R(!k),children:k?"Ẩn trả lời":`Xem ${n.replies.length} trả lời`})]}),e.jsx(Se,{in:m,animateOpacity:!0,children:d&&e.jsx(G,{mt:2,align:"stretch",spacing:1,children:e.jsxs(p,{children:[e.jsx(ve,{placeholder:"Trả lời bình luận...",value:z,autoFocus:!0,bg:"white",onChange:y=>x(y.target.value),onKeyDown:y=>y.key==="Enter"&&H()}),e.jsx(b,{size:"sm",colorScheme:"blue",onClick:H,children:"Gửi"}),e.jsx(b,{size:"sm",variant:"outline",colorScheme:"red",onClick:f,children:"Hủy"})]})})})]})]}),e.jsx(Se,{in:k,animateOpacity:!0,children:e.jsx(h,{pl:10,position:"relative",children:(N=n.replies)==null?void 0:N.map(y=>e.jsx(Te,{comment:y,onReply:()=>{},onDelete:o,globalExpand:s},y.commentID))})}),e.jsx(Ie,{isOpen:$,leastDestructiveRef:j,onClose:v,isCentered:!0,children:e.jsx(De,{children:e.jsxs(ze,{children:[e.jsx(Re,{fontSize:"lg",fontWeight:"bold",children:"Xác nhận xóa"}),e.jsx(Le,{children:"Bạn có chắc muốn xóa bình luận này? Hành động này không thể hoàn tác."}),e.jsxs(Ae,{children:[e.jsx(b,{ref:j,onClick:v,children:"Hủy"}),e.jsx(b,{colorScheme:"red",onClick:L,ml:3,children:"Xóa"})]})]})})})]})},fs=({courseId:n})=>{const u=a.useRef(null),{coder:o,isAuthenticated:s}=Z(),[r,d]=a.useState([]),[D,m]=a.useState(""),[C,z]=a.useState(!1),[x,k]=a.useState(!1),[R,$]=a.useState(!0),[A,j]=a.useState(1),[T,v]=a.useState(!1),[H,i]=a.useState("CommentTime"),[f,L]=a.useState(!1),E=async(l=1,M=!1,S=js)=>{try{l===1?z(!0):k(!0);const w=await F.get("/comments",{params:{courseId:n,page:l,pageSize:S,sortBy:H,ascending:f}}),Y=w.data.data||[],q=w.data.totalPages||1;d(M?c=>[...c,...Y]:Y),j(l),$(l<q)}catch(w){console.error("Load comments error",w)}finally{z(!1),k(!1)}},N=a.useCallback(()=>{if(!u.current||x||C||!R)return;const{scrollTop:l,scrollHeight:M,clientHeight:S}=u.current;M-l-S<100&&E(A+1,!0)},[A,E,R,x,C]);a.useEffect(()=>{const l=u.current;if(l)return l.addEventListener("scroll",N),()=>{l.removeEventListener("scroll",N)}},[N]),a.useEffect(()=>{n&&(T?E(1,!1,9999):E(1,!1))},[n,H,f,T]);const y=l=>{d(M=>M.filter(S=>S.commentID!==l).map(S=>({...S,replies:S.replies?S.replies.filter(w=>w.commentID!==l):[]})))},K=async()=>{if(D.trim()!==""){if(!s){alert("Bạn cần đăng nhập để bình luận");return}try{const l={content:D.trim(),courseID:n,parentCommentID:null},M=(o==null?void 0:o.token)||localStorage.getItem("token"),S=await F.post("/comments",l,{headers:{Authorization:`Bearer ${M}`}});d(w=>[{...S.data,replies:[]},...w]),m("")}catch(l){console.error("Add comment error",l),alert("Lỗi khi gửi bình luận")}}},W=(l,M)=>{d(S=>S.map(w=>w.commentID===l?{...w,replies:[...w.replies||[],M]}:w))},Q=()=>{v(l=>!l)};return C?e.jsx(t,{textAlign:"center",children:"Đang tải bình luận..."}):e.jsxs(h,{w:"100%",maxW:"100%",mx:"auto",px:4,py:2,children:[!s&&e.jsx(t,{color:"red",fontStyle:"italic",children:"**Đăng nhập để có thể bình luận"}),e.jsxs(B,{justify:"space-between",align:"center",mb:4,flexWrap:"wrap",gap:2,children:[e.jsx(t,{fontSize:"lg",fontWeight:"bold",children:"Bình luận"}),e.jsxs(p,{spacing:2,children:[e.jsx(b,{colorScheme:"navy",px:4,py:2,onClick:Q,maxW:"150px",whiteSpace:"normal",children:e.jsx(t,{fontSize:"12px",textAlign:"center",children:T?"Thu gọn tất cả trả lời":"Xem tất cả trả lời"})}),e.jsxs(Ke,{ms:4,size:"sm",value:f?"asc":"desc",onChange:l=>L(l.target.value==="asc"),borderRadius:"md",children:[e.jsx("option",{value:"desc",children:"Mới nhất trước"}),e.jsx("option",{value:"asc",children:"Cũ nhất trước"})]})]})]}),e.jsx(h,{height:"400px",overflowY:"auto",borderColor:"gray.200",borderRadius:"md",bg:"white",ref:u,px:4,py:2,children:e.jsxs(G,{spacing:4,align:"stretch",children:[r.map(l=>e.jsx(Te,{comment:l,onReply:W,onDelete:y,globalExpand:T},l.commentID)),x&&e.jsxs(G,{spacing:3,mt:3,children:[e.jsx(ae,{height:"20px",width:"100%"}),e.jsx(ae,{height:"20px",width:"90%"}),e.jsx(ae,{height:"20px",width:"95%"})]})]})}),s&&e.jsx(us,{coder:o,newComment:D,setNewComment:m,handleAddComment:K})]})},Cs=()=>{var W,Q,l,M,S,w,Y,q;const{slugId:n}=Xe(),u=n?n.split("-"):[],o=u.length>0?parseInt(u.pop(),10):NaN,[s,r]=a.useState(null),[d,D]=a.useState(!0),m=oe(),C=Ve(),z=Ue(),[x,k]=a.useState(!1),[R,$]=a.useState([]),A=Z(),{coder:j}=Z(),T=a.useCallback(async()=>{if(isNaN(o)){m({title:"Lỗi",description:"ID không hợp lệ!",status:"error",duration:3e3,isClosable:!0}),D(!1),C("/course");return}try{const c=await he({controller:"Course",id:o});if(!c||Object.keys(c).length===0){m({title:"Cảnh báo",description:"Không có dữ liệu cho khóa học này.",status:"warning",duration:3e3,isClosable:!0}),r(null);return}const g=c.topics||[],P=await Promise.all(g.map(async O=>{try{const ee=((await he({controller:"Topic",id:O.topicID})).lessons||[]).filter(X=>Number(X.status)===1);return{...O,lessons:ee}}catch(_){return console.log("Error fetching lessons:",_),{...O,lessons:[]}}})),J=await F.get(`/Course/problem-count?courseId=${o}`);if($(J.data),r({...c,topics:P}),j!=null&&j.coderID){const O=await F.get("/Enrollment/CheckEnrollment",{params:{courseId:o||"",coderID:j.coderID||""}});k(O.data.isEnrolled)}}catch{m({title:"Lỗi",description:"Không thể tải dữ liệu. Vui lòng thử lại!",status:"error",duration:3e3,isClosable:!0}),r(null)}finally{D(!1)}},[o,j==null?void 0:j.coderID,C,m]);a.useEffect(()=>{T()},[T]);const v=s!=null&&s.topics?s.topics.length:0,H=s!=null&&s.topics?s.topics.reduce((c,g)=>c+(g.lessons?g.lessons.length:0),0):0;Ze((s==null?void 0:s.courseName)||"Khóa học");const i=async()=>{if(A.isAuthenticated===!1)m({title:"Bạn cần phải đăng nhập.",status:"warning",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"});else{const c={courseID:o};try{const g=await F.post("/Enrollment",c);g.status===200||g.status===201?(k(!0),m({title:"Đăng ký khóa học thành công",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})):m({title:"Lỗi đăng ký khóa học",description:g.data.message,status:"error",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"}),T()}catch(g){console.error("Lỗi đăng ký: ",g.response?g.response.data:g.message),m({title:g.response?g.response.data.message:g.message,status:"error",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})}}},f=a.useRef(),[L,E]=a.useState(!1),N=()=>E(!0),y=()=>E(!1),K=async()=>{var c,g;try{(await F.delete("/Enrollment",{data:{courseID:o,coderID:j.coderID}})).status===200&&(k(!1),m({title:"Đã hủy đăng ký khóa học.",status:"success",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"}),T())}catch(P){m({title:"Lỗi hủy đăng ký",description:((g=(c=P.response)==null?void 0:c.data)==null?void 0:g.message)||"Có lỗi xảy ra",status:"error",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})}};return e.jsx(Qe,{children:e.jsxs(h,{p:6,maxW:"100%",minH:"100vh",mx:"auto",w:{lg:"calc(100% - 360px)",md:"100%"},children:[e.jsx(b,{leftIcon:e.jsx(cs,{}),mb:2,colorScheme:"blue",variant:"ghost",onClick:()=>C("/course"),children:"Trở về trước"}),e.jsxs(B,{direction:{base:"column",md:"row"},gap:5,children:[e.jsxs(h,{flex:3,minH:570,overflowY:"auto",position:"static",children:[e.jsxs(B,{direction:{base:"column",md:"row"},gap:6,bgGradient:"linear(to-r, blue.900, blue.700)",p:8,borderRadius:"md",boxShadow:"lg",children:[e.jsx(h,{flex:3,children:d?e.jsx(ae,{height:"250px",borderRadius:"md"}):e.jsx(qe,{alt:"Course Avatar",w:"100%",h:{base:"200px",md:"250px"},borderRadius:"md",objectFit:"cover",boxShadow:"lg",src:(s==null?void 0:s.imageUrl)||"/avatarSimmmple.png"})}),e.jsx(h,{flex:3,color:"white",borderRadius:"lg",children:d?e.jsx(V,{noOfLines:3,spacing:4}):e.jsxs(h,{children:[e.jsx(t,{fontSize:"3xl",letterSpacing:1.2,fontWeight:"bold",children:s==null?void 0:s.courseName}),e.jsxs(t,{mt:2,children:[" ",e.jsx(h,{sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:de(s==null?void 0:s.description)}})]}),e.jsxs(p,{mt:4,spacing:4,children:[e.jsxs(t,{children:["Tác giả: ",e.jsx(t,{as:"span",color:"blue.300",children:s==null?void 0:s.creatorName})]}),e.jsx(I,{as:Je}),e.jsxs(t,{children:[(s==null?void 0:s.totalReviews)||"0"," Học viên"]}),e.jsx(I,{as:Ce,color:"yellow.400"})," ",e.jsxs(t,{children:[" ",s.rating?s.rating.toFixed(1):"0"]})]})]})}),e.jsx(h,{w:{base:"100%",md:"300px"},display:{base:"block",lg:"none"},children:e.jsxs(h,{color:"white",borderRadius:"lg",w:"full",children:[e.jsxs(B,{mt:"1",pb:3,align:"center",justify:"space-between",borderBottomWidth:2,borderBottomColor:"gray.600",children:[(s==null?void 0:s.fee)>=0&&e.jsxs(B,{alignItems:"left",direction:"column",children:[e.jsx(t,{fontSize:"4xl",fontWeight:"bold",children:(s==null?void 0:s.fee)===0?"Miễn phí":se((s==null?void 0:s.fee)||0)}),e.jsx(t,{ml:"2",fontSize:"md",textDecoration:"line-through",color:"gray.400",children:(s==null?void 0:s.originalFee)===0?"":se((s==null?void 0:s.originalFee)||0)})]}),(s==null?void 0:s.originalFee)>0&&e.jsxs(xe,{colorScheme:"red",ml:"2",px:"2",py:"1",mb:10,fontSize:"sm",bg:"red.500",color:"white",borderRadius:"md",children:["-",(s==null?void 0:s.discountPercent)||0,"%"]})]}),e.jsxs(G,{align:"start",mt:4,spacing:3,children:[e.jsxs(p,{children:[e.jsx(I,{as:ge}),e.jsxs(t,{children:[v," chủ đề"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:pe}),e.jsxs(t,{children:[H," bài học"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:me}),e.jsxs(t,{children:[R," bài tập"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:ue}),e.jsx(t,{children:"Truy cập trọn đời"})]}),e.jsxs(p,{children:[e.jsx(I,{as:je}),e.jsx(t,{children:"Chứng chỉ khi hoàn thành"})]})]}),x===!0&&((M=(l=(Q=(W=s==null?void 0:s.topics)==null?void 0:W[0])==null?void 0:Q.lessons)==null?void 0:l[0])!=null&&M.lessonID)?e.jsxs(B,{direction:"column",gap:4,children:[e.jsx(U,{to:`${z.pathname}/${s.topics[0].lessons[0].lessonID}`,children:e.jsxs(b,{colorScheme:"blue",mt:4,w:"full",fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center",_hover:{transform:"translateY(-3px)",boxShadow:"0px 4px 10px rgb(39, 87, 246)",transition:"transform 0.3s ease"},children:["Vào học ",e.jsx(I,{as:fe,ml:2})]})}),e.jsx(b,{colorScheme:"red",w:"full",fontSize:"18px",onClick:N,children:"Hủy đăng ký"})]}):e.jsx(b,{colorScheme:(s==null?void 0:s.fee)===0?"green":"red",mt:4,w:"full",fontSize:"18px",onClick:i,children:(s==null?void 0:s.fee)===0?"Đăng ký miễn phí":"Mua ngay"})]})})]}),e.jsxs(es,{mt:6,colorScheme:"blue",bg:"white",borderRadius:"md",children:[e.jsxs(ps,{offsetTop:0,children:[e.jsx(te,{children:"Giới thiệu"}),e.jsx(te,{children:"Giáo trình"}),e.jsx(te,{children:"Đánh giá"}),e.jsx(te,{children:"Bình luận"})]}),e.jsxs(ls,{children:[e.jsx(ne,{children:d?e.jsx(V,{noOfLines:4,spacing:3}):e.jsxs(t,{mt:2,children:[" ",e.jsx(h,{px:5,py:2,sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:de(s==null?void 0:s.overview)}})]})}),e.jsx(ne,{children:d?e.jsx(V,{noOfLines:5,spacing:4}):e.jsx(be,{spacing:0,children:Array.isArray(s==null?void 0:s.topics)&&s.topics.length>0?s.topics.map((c,g)=>e.jsx(ye,{bg:"gray.100",borderRadius:"md",children:e.jsx(ts,{allowToggle:!0,children:e.jsx(ns,{border:"none",children:({isExpanded:P})=>{var J,O;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:e.jsxs(as,{_expanded:{bg:"gray.200"},borderRadius:"sm",children:[e.jsxs(h,{flex:"1",textAlign:"left",borderBottomWidth:2,borderStyle:"dashed",py:2,children:[e.jsxs(t,{fontSize:"lg",children:[e.jsxs(t,{as:"span",fontWeight:"bold",children:["Chủ đề ",g+1,":"]})," ",(c==null?void 0:c.topicName)||"Không có tên"]}),e.jsxs(B,{alignItems:"center",gap:2,fontSize:"sm",children:[e.jsx(t,{as:"span",children:e.jsx(ss,{})}),"Tổng số bài học: ",((J=c==null?void 0:c.lessons)==null?void 0:J.length)||0]})]}),P?e.jsx(rs,{boxSize:4}):e.jsx(is,{boxSize:4})]})}),e.jsx(os,{pb:4,children:(O=c.lessons)!=null&&O.length?e.jsx(be,{spacing:2,children:c.lessons.map(_=>{const ee=A.isAuthenticated,X=_.lessonID||Math.random(),re=e.jsx(ye,{cursor:"pointer",_hover:{bg:"gray.300",transform:"scale(1.01)"},transition:"all .2s ease-in-out",pl:2,bg:"gray.50",borderRadius:"sm",p:2,onClick:()=>{ee||m({title:"Bạn cần đăng nhập để truy cập trang này.",status:"warning",duration:2e3,isClosable:!0,position:"top",variant:"top-accent"})},children:e.jsxs(t,{fontSize:"md",children:["📚 ",_.lessonTitle||"Không có tên bài học"]})});return x?ee?e.jsx(h,{children:e.jsx(U,{to:`${z.pathname}/${_.lessonID}`,style:({isActive:Be})=>({textDecoration:"none",color:Be?"blue.500":"inherit"}),children:re})},X):e.jsx(h,{children:re},X):e.jsx(h,{children:e.jsx(h,{cursor:"default",children:re})},X)})}):e.jsx(t,{fontSize:"md",color:"gray.500",children:"Không có bài học nào."})})]})}},c==null?void 0:c.topicID)})},(c==null?void 0:c.topicID)||g)):e.jsx(t,{fontSize:"md",color:"gray.500",children:"Không có chủ đề nào."})})}),e.jsx(ne,{children:d?e.jsx(V,{noOfLines:4,spacing:3}):e.jsx(ds,{courseId:o})}),e.jsx(ne,{children:d?e.jsx(V,{noOfLines:4,spacing:3}):e.jsx(fs,{courseId:o})})]})]})]}),e.jsx(h,{display:{base:"none",lg:"block"},position:"relative",w:"300px",children:e.jsxs(h,{bg:"blue.900",color:"white",p:4,borderRadius:"lg",w:"300px",maxH:"max-content",position:{base:"static",md:"fixed"},right:"200px",top:"135px",boxShadow:"lg",children:[e.jsxs(B,{mt:"1",pb:3,align:"center",justify:"space-between",borderBottomWidth:2,borderBottomColor:"gray.600",children:[(s==null?void 0:s.fee)>=0&&e.jsxs(B,{alignItems:"left",direction:"column",children:[e.jsx(t,{fontSize:"4xl",fontWeight:"bold",children:(s==null?void 0:s.fee)===0?"Miễn phí":se((s==null?void 0:s.fee)||0)}),e.jsx(t,{ml:"2",fontSize:"md",textDecoration:"line-through",color:"gray.400",children:(s==null?void 0:s.originalFee)===0?"":se((s==null?void 0:s.originalFee)||0)})]}),(s==null?void 0:s.originalFee)>0&&e.jsxs(xe,{colorScheme:"red",ml:"2",px:"2",py:"1",mb:10,fontSize:"sm",bg:"red.500",color:"white",borderRadius:"md",children:["-",(s==null?void 0:s.discountPercent)||0,"%"]})]}),e.jsxs(G,{align:"start",mt:4,spacing:3,children:[e.jsxs(p,{children:[e.jsx(I,{as:ge}),e.jsxs(t,{children:[v," chủ đề"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:pe}),e.jsxs(t,{children:[H," bài học"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:me}),e.jsxs(t,{children:[R," bài tập"]})]}),e.jsxs(p,{children:[e.jsx(I,{as:ue}),e.jsx(t,{children:"Truy cập trọn đời"})]}),e.jsxs(p,{children:[e.jsx(I,{as:je}),e.jsx(t,{children:"Chứng chỉ khi hoàn thành"})]})]}),x===!0&&((q=(Y=(w=(S=s==null?void 0:s.topics)==null?void 0:S[0])==null?void 0:w.lessons)==null?void 0:Y[0])!=null&&q.lessonID)?e.jsxs(B,{direction:"column",gap:4,children:[e.jsx(U,{to:`${z.pathname}/${s.topics[0].lessons[0].lessonID}`,children:e.jsxs(b,{colorScheme:"blue",mt:4,w:"full",fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center",_hover:{transform:"translateY(-3px)",boxShadow:"0px 4px 10px rgb(39, 87, 246)",transition:"transform 0.3s ease"},children:["Vào học ",e.jsx(I,{as:fe,ml:2})]})}),e.jsx(b,{colorScheme:"red",w:"full",fontSize:"18px",onClick:N,children:"Hủy đăng ký"})]}):e.jsx(b,{colorScheme:(s==null?void 0:s.fee)===0?"green":"red",mt:4,w:"full",fontSize:"18px",onClick:i,children:(s==null?void 0:s.fee)===0?"Đăng ký miễn phí":"Mua ngay"})]})})]}),e.jsx(Ie,{isOpen:L,leastDestructiveRef:f,onClose:y,isCentered:!0,children:e.jsx(De,{children:e.jsxs(ze,{children:[e.jsx(Re,{fontSize:"lg",fontWeight:"bold",children:"Xác nhận hủy đăng ký"}),e.jsx(Le,{textAlign:"center",fontSize:"xl",children:"Bạn có chắc chắn muốn hủy đăng ký khóa học này? Hành động này không thể hoàn tác."}),e.jsxs(Ae,{children:[e.jsx(b,{ref:f,onClick:y,children:"Hủy"}),e.jsx(b,{colorScheme:"red",onClick:()=>{y(),K()},ml:3,children:"Xác nhận"})]})]})})})]})})};export{Cs as default};
