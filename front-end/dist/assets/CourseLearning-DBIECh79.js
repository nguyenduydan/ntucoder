import{aj as E,w as N,j as e,s as r,z as I,x as l,D as p,a7 as m,aq as $,ar as A,ad as H,ax as K,a1 as M,r as i,i as R,a5 as U,ak as _,ay as q,al as B,am as f,an as o}from"./index-NsYg9CFQ.js";import{S as G}from"./index-CHzSkzam.js";import{T as V,a as w}from"./tab-panels-BJxFZm1S.js";const T=({course:s,isPlaceholder:d=!1})=>{var a;const x=E("white","navy.900"),n=N();if(d)return e.jsxs(r,{minW:{md:"20vh",base:"100%"},borderWidth:"1px",bg:x,borderRadius:"lg",overflow:"hidden",boxShadow:"md",transition:"all .2s ease-in-out",children:[e.jsx(I,{src:"/avatarSimmmple.png",alt:"no image",objectFit:"cover",h:"160px",w:"full"}),e.jsxs(r,{p:"4",children:[e.jsx(r,{bg:"gray.300",h:"20px",w:"100px",mb:"3",borderRadius:"md"}),e.jsx(r,{bg:"gray.300",h:"24px",w:"80%",mb:"2",borderRadius:"md"}),e.jsx(r,{bg:"gray.200",h:"16px",w:"50%",mb:"2",borderRadius:"md"}),e.jsx(l,{align:"center",mt:"2",children:e.jsx(r,{bg:"gray.200",h:"16px",w:"40px",borderRadius:"md"})}),e.jsxs(l,{mt:"3",align:"center",justify:"space-between",children:[e.jsx(r,{h:"20px",w:"60px",bg:"gray.300",borderRadius:"md"}),e.jsxs(l,{alignItems:"center",children:[e.jsx(r,{h:"16px",w:"50px",bg:"gray.300",borderRadius:"md",mr:"2"}),e.jsx(r,{h:"20px",w:"30px",bg:"gray.200",borderRadius:"md"})]})]})]})]});const h=()=>{setTimeout(()=>{n(`/course/${M(s.courseName)}-${s.courseID}`)},100)};return e.jsxs(r,{minW:{md:"20vh",base:"100%"},borderWidth:"1px",bg:x,_hover:{transform:"translateY(-5px)",boxShadow:"md",cursor:"pointer"},transition:"all .2s ease-in",borderRadius:"lg",overflow:"hidden",boxShadow:"md",onClick:h,children:[e.jsx(I,{src:s.imageUrl||"/avatarSimmmple.png",alt:s.title,name:s.title,objectFit:"cover",h:"160px",w:"full",loading:"lazy"}),e.jsxs(r,{px:4,py:2,children:[e.jsx(p,{fontSize:"lg",fontWeight:"bold",color:"blue",children:s.courseName}),e.jsxs(l,{align:"center",mt:"2",children:[e.jsxs(l,{flex:1,children:[e.jsx(m,{spacing:.5,children:[...Array(5)].map((v,c)=>e.jsx($,{boxSize:3,color:c<Math.round(s.rating)?"yellow.400":"gray.300"},c))}),e.jsxs(p,{ml:"1",mt:"2px",fontSize:"sm",fontWeight:"medium",children:["  ",s.rating?s.rating.toFixed(1):"0"]})]}),e.jsxs(l,{flex:1,children:[e.jsx(A,{color:"gray"}),e.jsx(p,{ml:"1",fontSize:"sm",fontWeight:"medium",children:H(s.totalReviews)})]}),e.jsxs(p,{ml:"1",fontSize:"sm",fontWeight:"medium",children:[((a=s.progress)==null?void 0:a.toFixed(0))||"0","%"]})]})]}),e.jsx(K,{value:s.progress,size:"sm",colorScheme:"green",bg:"blue.100",hasStripe:!0,w:"full",borderRadius:"md"})]})},S=({courses:s=[],slidesToShow:d=3,activeTabIndex:x})=>{const n=i.useRef(null);if(i.useEffect(()=>{n.current&&(n.current.slickGoTo(0),n.current.slickSetPosition())},[x]),s.length===0)return e.jsx(r,{textAlign:"center",fontSize:"xl",my:5,minW:"900px",children:"Không có khóa học nào."});if(s.length<=d)return e.jsx(r,{display:"flex",gap:6,px:4,flexWrap:"nowrap",overflowX:"auto",minW:"900px",children:s.map(a=>e.jsx(r,{flex:"1",maxW:"350px",children:e.jsx(T,{course:a})},a.courseID))});const h={dots:!1,infinite:!1,speed:300,slidesToShow:d,slidesToScroll:3,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]};return e.jsx(r,{mx:"auto",overflow:"hidden",width:"900px",position:"relative",minH:"200px",children:e.jsx(G,{...h,children:s.map(a=>e.jsx(r,{px:2,children:e.jsx(T,{course:a})},a.courseID))})})},ee=({coderID:s})=>{const[d,x]=i.useState([]),[n,h]=i.useState([]),[a,v]=i.useState([]),[c,W]=i.useState(!0),[j,k]=i.useState(0),C=i.useCallback(async()=>{try{const y=(await R.get(`/Enrollment/list-enroll/${s}`)).data.map(t=>t.courseID),z=(await U({controller:"Course",page:1,pageSize:100,ascending:!0,totalCount:100})).data||[],D=(await R.get("/Progress/courses",{params:{courseIds:y,coderId:s},paramsSerializer:t=>t.courseIds.map(g=>`courseIds=${g}`).join("&")+`&coderId=${t.coderId}`})).data,b=z.map(t=>{const g=D.find(F=>F.objectID===t.courseID);return{...t,progress:(g==null?void 0:g.percent)??0}}).filter(t=>y.includes(t.courseID)&&t.status===1),L=b.filter(t=>t.progress<100),P=b.filter(t=>t.progress===100);x(b),h(L),v(P)}catch(u){console.error("Lỗi fetch course:",u)}finally{W(!1)}},[s]);return i.useEffect(()=>{C()},[C]),e.jsx(r,{px:6,py:5,minH:"50vh",bg:"white",borderRadius:"md",shadow:"md",children:e.jsxs(_,{variant:"soft-rounded",colorScheme:"blue",onChange:u=>k(u),isLazy:!0,children:[e.jsxs(l,{justifyContent:"space-between",children:[e.jsxs(r,{children:[e.jsxs(p,{fontSize:"xl",color:"blue.600",fontWeight:"bold",children:["Khóa học (",n.length,")"]}),e.jsx(q,{w:"60px",h:"3px",bg:"blue.600",borderRadius:"md",mt:1})]}),e.jsxs(B,{children:[e.jsx(f,{children:"Tất cả khóa học"}),e.jsx(f,{children:"Đã đăng ký"}),e.jsx(f,{children:"Đã hoàn tất"})]})]}),e.jsxs(V,{children:[e.jsx(w,{children:c?e.jsxs(m,{gap:4,children:[e.jsx(o,{height:"200px",w:"100%"}),e.jsx(o,{height:"200px",w:"100%"}),e.jsx(o,{height:"200px",w:"100%"})]}):e.jsx(S,{courses:d,activeTabIndex:j})}),e.jsx(w,{children:c?e.jsxs(m,{gap:4,children:[e.jsx(o,{height:"200px",w:"100%"}),e.jsx(o,{height:"200px",w:"100%"}),e.jsx(o,{height:"200px",w:"100%"})]}):e.jsx(S,{courses:n,activeTabIndex:j})}),e.jsx(w,{children:c?e.jsxs(m,{gap:4,children:[e.jsx(o,{height:"200px",w:"100%"}),e.jsx(o,{height:"200px",w:"100%"}),e.jsx(o,{height:"200px",w:"100%"})]}):e.jsx(S,{courses:a,activeTabIndex:j})})]})]})})};export{ee as default};
