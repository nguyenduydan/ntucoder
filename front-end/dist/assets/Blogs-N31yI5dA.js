import{r as s,j as t,cc as H,B as d,b as a,bf as K,F as f,bg as N,bh as v,S as C,bE as _,bF as w,bA as y,o as L,L as M,v as P}from"./react-vendor-UrX0Iyen.js";import{a as T,L as x,s as G,z as V}from"./index-DHxdizMM.js";import"./charts-vendor-DwxpLNbD.js";import"./vendor-DdjKqKjT.js";import"./lodash-vendor-CBiJWk4A.js";import"./axios-vendor-xsH4HHeE.js";import"./moment-vendor-CTDujYFw.js";class Y extends s.Component{constructor(i){super(i),this.state={chartData:[],chartOptions:{}}}componentDidMount(){this.setState({chartData:this.props.chartData,chartOptions:this.props.chartOptions})}render(){return t.jsx(H,{options:this.state.chartOptions,series:this.state.chartData,type:"bar",width:"100%",height:"100%"})}}const F=({height:p,refreshKey:i,onFinishRefresh:n})=>{const[r,B]=s.useState([]),[u,g]=s.useState(!1),[o,m]=s.useState(null),[D,z]=s.useState(0),[l,O]=s.useState(4),[W,k]=s.useState(0),[c,E]=s.useState(!1),j=s.useCallback(async()=>{g(!0),m(null);try{const e=await T.get(`/Blog/TopViewed?count=${l}&ascingSort=${c}`),h=await T.get("/Blog");k(h.data.totalCount);const S=e.data;B(Array.isArray(S)?S:[])}catch(e){m("Không thể tải danh sách bài viết."),console.error("Lỗi khi lấy danh sách bài viết:",e)}finally{g(!1),n==null||n()}},[l,c,n]);s.useEffect(()=>{j()},[j,i]);const A=e=>{O(Number(e.target.value))},I=e=>{const h=e.target.value;E(h==="true")},b={chart:{type:"bar",toolbar:{show:!1}},xaxis:{categories:r.map(e=>x(e.title,10)),labels:{style:{fontSize:"12px"},rotate:-45,hideOverlappingLabels:!0}},dataLabels:{enabled:!0,formatter:e=>`${e.toLocaleString()}`},tooltip:{y:{formatter:e=>`${e.toLocaleString()} lượt xem`}},plotOptions:{bar:{borderRadius:4}}},$=[{name:"Lượt xem",data:r.map(e=>e.viewCount)}];return t.jsxs(d,{p:5,bg:"white",shadow:"md",borderRadius:"md",h:p||"auto",children:[t.jsxs(a,{fontSize:"xl",fontWeight:"bold",mb:4,children:["Bài viết nổi bật ",t.jsxs(a,{as:"span",fontWeight:"normal",color:"gray.600",fontSize:"md",children:["(Tổng: ",W,")"]})]}),t.jsxs(K,{variant:"soft-rounded",colorScheme:"blue",index:D,onChange:e=>z(e),children:[t.jsxs(f,{justify:"space-between",align:"center",mb:4,mx:0,children:[t.jsxs(N,{children:[t.jsx(v,{children:"Danh sách"}),t.jsx(v,{children:"Biểu đồ cột"})]}),t.jsxs(C,{maxW:"150px",value:c,onChange:I,placeholder:"Sắp xếp theo lượt xem",children:[t.jsx("option",{value:"true",children:"Tăng dần"}),t.jsx("option",{value:"false",children:"Giảm dần"})]}),t.jsxs(C,{value:l,onChange:A,maxW:"150px",placeholder:"Chọn số lượng",children:[t.jsx("option",{value:10,children:"10"}),t.jsx("option",{value:15,children:"15"}),t.jsx("option",{value:20,children:"20"})]})]}),t.jsxs(_,{children:[t.jsx(w,{p:0,maxH:"250px",overflowY:"auto",children:u?t.jsx(y,{h:"100%",children:t.jsx(L,{size:"xl"})}):o?t.jsx(a,{color:"red.500",children:o}):r.length>0?t.jsx(M,{spacing:4,children:r.map(e=>t.jsxs(P,{p:4,borderWidth:"1px",borderRadius:"md",boxShadow:"sm",_hover:{bg:"gray.50"},children:[t.jsx(a,{fontWeight:"bold",children:x(e.title,50)}),t.jsx(d,{sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:G(x(e.content,50))}}),t.jsxs(f,{mt:2,align:"center",flexWrap:"wrap",gap:2,children:[t.jsxs(a,{fontSize:"sm",color:"gray.500",children:[e.coderName||"Người viết không xác định"," |"]}),t.jsxs(a,{fontSize:"sm",color:"gray.500",children:[V(e.blogDate)," |"]}),t.jsxs(a,{children:[e.viewCount.toLocaleString()," lượt xem"]})]})]},e.id))}):t.jsx(a,{children:"Không có bài viết nào."})}),t.jsx(w,{p:0,children:u?t.jsx(y,{h:"100%",children:t.jsx(L,{size:"xl"})}):o?t.jsx(a,{color:"red.500",children:o}):r.length===0?t.jsx(a,{children:"Không có dữ liệu để hiển thị."}):t.jsx(d,{w:"100%",h:"250px",children:t.jsx(Y,{chartData:$,chartOptions:{...b,chart:{...b.chart,height:"100%"}}})})})]})]})]})};export{F as default};
