import{aa as Me,aW as y,w as ge,aG as ie,j as e,s as D,x as S,B as X,aX as Ue,D as f,l as et,E as Ke,aY as tt,a7 as Ee,Y as Z,aZ as rt,a_ as st,a2 as Ye,m as qe,r as m,u as Ce,aO as We,aI as nt,aH as Ne,aJ as it,aK as at,aL as ot,a$ as lt,aM as ct,aN as dt,aR as Xe,aP as J,i as ue,b0 as _e,b1 as Fe,b2 as ye,b3 as U,ao as ut,b4 as ht,b5 as gt,b6 as ft,P as mt,al as Ve,am as Qe,an as se,G as He,f as Se,b7 as pt,n as xt,y as bt,aB as Be,b8 as jt,b9 as vt,M as yt,a as St,b as zt,c as wt,e as Dt,h as Ct,a5 as It,ba as Tt,bb as kt,$ as Pt,a0 as ze,bc as Lt,bd as At,be as Et,bf as Ot,z as Rt,N as Mt}from"./index-Du5abbo3.js";import{S as Wt}from"./skeleton-text-Q3_dH2_9.js";import{M as Nt}from"./Minus-CdrENXMI.js";import{T as Ze,a as ne}from"./tab-panels-CGlQI89n.js";var W=typeof window<"u"?window:null,Oe=W===null,he=Oe?void 0:W.document,_="addEventListener",F="removeEventListener",Pe="getBoundingClientRect",de="_a",H="_b",K="_c",we="horizontal",B=function(){return!1},_t=Oe?"calc":["","-webkit-","-moz-","-o-"].filter(function(s){var r=he.createElement("div");return r.style.cssText="width:"+s+"calc(9px)",!!r.style.length}).shift()+"calc",Je=function(s){return typeof s=="string"||s instanceof String},$e=function(s){if(Je(s)){var r=he.querySelector(s);if(!r)throw new Error("Selector "+s+" did not match a DOM element");return r}return s},R=function(s,r,h){var a=s[r];return a!==void 0?a:h},De=function(s,r,h,a){if(r){if(a==="end")return 0;if(a==="center")return s/2}else if(h){if(a==="start")return 0;if(a==="center")return s/2}return s},Ft=function(s,r){var h=he.createElement("div");return h.className="gutter gutter-"+r,h},Ht=function(s,r,h){var a={};return Je(r)?a[s]=r:a[s]=_t+"("+r+"% - "+h+"px)",a},Bt=function(s,r){var h;return h={},h[s]=r+"px",h},Ge=function(s,r){if(r===void 0&&(r={}),Oe)return{};var h=s,a,l,j,x,b,o;Array.from&&(h=Array.from(h));var p=$e(h[0]),w=p.parentNode,T=getComputedStyle?getComputedStyle(w):null,A=T?T.flexDirection:null,u=R(r,"sizes")||h.map(function(){return 100/h.length}),c=R(r,"minSize",100),k=Array.isArray(c)?c:h.map(function(){return c}),g=R(r,"maxSize",1/0),C=Array.isArray(g)?g:h.map(function(){return g}),v=R(r,"expandToMin",!1),I=R(r,"gutterSize",10),N=R(r,"gutterAlign","center"),O=R(r,"snapOffset",30),ae=Array.isArray(O)?O:h.map(function(){return O}),oe=R(r,"dragInterval",1),Y=R(r,"direction",we),le=R(r,"cursor",Y===we?"col-resize":"row-resize"),ee=R(r,"gutter",Ft),fe=R(r,"elementStyle",Ht),V=R(r,"gutterStyle",Bt);Y===we?(a="width",l="clientX",j="left",x="right",b="clientWidth"):Y==="vertical"&&(a="height",l="clientY",j="top",x="bottom",b="clientHeight");function q(i,t,n,d){var E=fe(a,t,n,d);Object.keys(E).forEach(function(L){i.style[L]=E[L]})}function me(i,t,n){var d=V(a,t,n);Object.keys(d).forEach(function(E){i.style[E]=d[E]})}function te(){return o.map(function(i){return i.size})}function pe(i){return"touches"in i?i.touches[0][l]:i[l]}function ce(i){var t=o[this.a],n=o[this.b],d=t.size+n.size;t.size=i/this.size*d,n.size=d-i/this.size*d,q(t.element,t.size,this[H],t.i),q(n.element,n.size,this[K],n.i)}function Ie(i){var t,n=o[this.a],d=o[this.b];this.dragging&&(t=pe(i)-this.start+(this[H]-this.dragOffset),oe>1&&(t=Math.round(t/oe)*oe),t<=n.minSize+n.snapOffset+this[H]?t=n.minSize+this[H]:t>=this.size-(d.minSize+d.snapOffset+this[K])&&(t=this.size-(d.minSize+this[K])),t>=n.maxSize-n.snapOffset+this[H]?t=n.maxSize+this[H]:t<=this.size-(d.maxSize-d.snapOffset+this[K])&&(t=this.size-(d.maxSize+this[K])),ce.call(this,t),R(r,"onDrag",B)(te()))}function xe(){var i=o[this.a].element,t=o[this.b].element,n=i[Pe](),d=t[Pe]();this.size=n[a]+d[a]+this[H]+this[K],this.start=n[j],this.end=n[x]}function Te(i){if(!getComputedStyle)return null;var t=getComputedStyle(i);if(!t)return null;var n=i[b];return n===0?null:(Y===we?n-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight):n-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),n)}function be(i){var t=Te(w);if(t===null||k.reduce(function(L,M){return L+M},0)>t)return i;var n=0,d=[],E=i.map(function(L,M){var Q=t*L/100,je=De(I,M===0,M===i.length-1,N),ve=k[M]+je;return Q<ve?(n+=ve-Q,d.push(0),ve):(d.push(Q-ve),Q)});return n===0?i:E.map(function(L,M){var Q=L;if(n>0&&d[M]-n>0){var je=Math.min(n,d[M]-n);n-=je,Q=L-je}return Q/t*100})}function ke(){var i=this,t=o[i.a].element,n=o[i.b].element;i.dragging&&R(r,"onDragEnd",B)(te()),i.dragging=!1,W[F]("mouseup",i.stop),W[F]("touchend",i.stop),W[F]("touchcancel",i.stop),W[F]("mousemove",i.move),W[F]("touchmove",i.move),i.stop=null,i.move=null,t[F]("selectstart",B),t[F]("dragstart",B),n[F]("selectstart",B),n[F]("dragstart",B),t.style.userSelect="",t.style.webkitUserSelect="",t.style.MozUserSelect="",t.style.pointerEvents="",n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",i.gutter.style.cursor="",i.parent.style.cursor="",he.body.style.cursor=""}function P(i){if(!("button"in i&&i.button!==0)){var t=this,n=o[t.a].element,d=o[t.b].element;t.dragging||R(r,"onDragStart",B)(te()),i.preventDefault(),t.dragging=!0,t.move=Ie.bind(t),t.stop=ke.bind(t),W[_]("mouseup",t.stop),W[_]("touchend",t.stop),W[_]("touchcancel",t.stop),W[_]("mousemove",t.move),W[_]("touchmove",t.move),n[_]("selectstart",B),n[_]("dragstart",B),d[_]("selectstart",B),d[_]("dragstart",B),n.style.userSelect="none",n.style.webkitUserSelect="none",n.style.MozUserSelect="none",n.style.pointerEvents="none",d.style.userSelect="none",d.style.webkitUserSelect="none",d.style.MozUserSelect="none",d.style.pointerEvents="none",t.gutter.style.cursor=le,t.parent.style.cursor=le,he.body.style.cursor=le,xe.call(t),t.dragOffset=pe(i)-t.end}}u=be(u);var z=[];o=h.map(function(i,t){var n={element:$e(i),size:u[t],minSize:k[t],maxSize:C[t],snapOffset:ae[t],i:t},d;if(t>0&&(d={a:t-1,b:t,dragging:!1,direction:Y,parent:w},d[H]=De(I,t-1===0,!1,N),d[K]=De(I,!1,t===h.length-1,N),A==="row-reverse"||A==="column-reverse")){var E=d.a;d.a=d.b,d.b=E}if(t>0){var L=ee(t,Y,n.element);me(L,I,t),d[de]=P.bind(d),L[_]("mousedown",d[de]),L[_]("touchstart",d[de]),w.insertBefore(L,n.element),d.gutter=L}return q(n.element,n.size,De(I,t===0,t===h.length-1,N),t),t>0&&z.push(d),n});function G(i){var t=i.i===z.length,n=t?z[i.i-1]:z[i.i];xe.call(n);var d=t?n.size-i.minSize-n[K]:i.minSize+n[H];ce.call(n,d)}o.forEach(function(i){var t=i.element[Pe]()[a];t<i.minSize&&(v?G(i):i.minSize=t)});function $(i){var t=be(i);t.forEach(function(n,d){if(d>0){var E=z[d-1],L=o[E.a],M=o[E.b];L.size=t[d-1],M.size=n,q(L.element,L.size,E[H],L.i),q(M.element,M.size,E[K],M.i)}})}function re(i,t){z.forEach(function(n){if(t!==!0?n.parent.removeChild(n.gutter):(n.gutter[F]("mousedown",n[de]),n.gutter[F]("touchstart",n[de])),i!==!0){var d=fe(a,n.a.size,n[H]);Object.keys(d).forEach(function(E){o[n.a].element.style[E]="",o[n.b].element.style[E]=""})}})}return{setSizes:$,getSizes:te,collapse:function(t){G(o[t])},destroy:re,parent:w,pairs:z}};function Le(s,r){var h={};for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&r.indexOf(a)===-1&&(h[a]=s[a]);return h}var Re=function(s){function r(){s.apply(this,arguments)}return s&&(r.__proto__=s),r.prototype=Object.create(s&&s.prototype),r.prototype.constructor=r,r.prototype.componentDidMount=function(){var a=this.props;a.children;var l=a.gutter,j=Le(a,["children","gutter"]),x=j;x.gutter=function(b,o){var p;return l?p=l(b,o):(p=document.createElement("div"),p.className="gutter gutter-"+o),p.__isSplitGutter=!0,p},this.split=Ge(this.parent.children,x)},r.prototype.componentDidUpdate=function(a){var l=this,j=this.props;j.children;var x=j.minSize,b=j.sizes,o=j.collapsed,p=Le(j,["children","minSize","sizes","collapsed"]),w=p,T=a.minSize,A=a.sizes,u=a.collapsed,c=["maxSize","expandToMin","gutterSize","gutterAlign","snapOffset","dragInterval","direction","cursor"],k=c.map(function(v){return l.props[v]!==a[v]}).reduce(function(v,I){return v||I},!1);if(Array.isArray(x)&&Array.isArray(T)){var g=!1;x.forEach(function(v,I){g=g||v!==T[I]}),k=k||g}else Array.isArray(x)||Array.isArray(T)?k=!0:k=k||x!==T;if(k)w.minSize=x,w.sizes=b||this.split.getSizes(),this.split.destroy(!0,!0),w.gutter=function(v,I,N){return N.previousSibling},this.split=Ge(Array.from(this.parent.children).filter(function(v){return!v.__isSplitGutter}),w);else if(b){var C=!1;b.forEach(function(v,I){C=C||v!==A[I]}),C&&this.split.setSizes(this.props.sizes)}Number.isInteger(o)&&(o!==u||k)&&this.split.collapse(o)},r.prototype.componentWillUnmount=function(){this.split.destroy(),delete this.split},r.prototype.render=function(){var a=this,l=this.props;l.sizes,l.minSize,l.maxSize,l.expandToMin,l.gutterSize,l.gutterAlign,l.snapOffset,l.dragInterval,l.direction,l.cursor,l.gutter,l.elementStyle,l.gutterStyle,l.onDrag,l.onDragStart,l.onDragEnd,l.collapsed;var j=l.children,x=Le(l,["sizes","minSize","maxSize","expandToMin","gutterSize","gutterAlign","snapOffset","dragInterval","direction","cursor","gutter","elementStyle","gutterStyle","onDrag","onDragStart","onDragEnd","collapsed","children"]),b=x;return Me.createElement("div",Object.assign({},{ref:function(o){a.parent=o}},b),j)},r}(Me.Component);Re.propTypes={sizes:y.arrayOf(y.number),minSize:y.oneOfType([y.number,y.arrayOf(y.number)]),maxSize:y.oneOfType([y.number,y.arrayOf(y.number)]),expandToMin:y.bool,gutterSize:y.number,gutterAlign:y.string,snapOffset:y.oneOfType([y.number,y.arrayOf(y.number)]),dragInterval:y.number,direction:y.string,cursor:y.string,gutter:y.func,elementStyle:y.func,gutterStyle:y.func,onDrag:y.func,onDragStart:y.func,onDragEnd:y.func,collapsed:y.number,children:y.arrayOf(y.element)};Re.defaultProps={sizes:void 0,minSize:void 0,maxSize:void 0,expandToMin:void 0,gutterSize:void 0,gutterAlign:void 0,snapOffset:void 0,dragInterval:void 0,direction:void 0,cursor:void 0,gutter:void 0,elementStyle:void 0,gutterStyle:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0,collapsed:void 0,children:void 0};const $t=({lesson:s})=>{const r=ge(),h=ie();return e.jsx(D,{bgGradient:"linear(to-r,rgb(8, 84, 156),rgb(10, 35, 75),rgb(1, 2, 40))",h:"8vh",children:e.jsx(S,{justifyContent:"space-between",h:"100%",py:2,px:4,alignItems:"center",children:e.jsxs(S,{textColor:"white",fontSize:"xl",align:"center",children:[e.jsx(X,{leftIcon:e.jsx(Ue,{}),color:"white",size:"md",variant:"link",onClick:()=>r(`${h.pathname.replace(/\/\d+$/,"")}`),_hover:{transform:"translateX(-5px)",transition:"transform 0.3s ease"}}),e.jsx(f,{fontWeight:"none",children:s.lessonTitle})]})})})};function Gt({lesson:s}){et((s==null?void 0:s.lessonTitle)||"Nội dung bài học");const{coder:r}=Ke();return e.jsxs(D,{px:4,py:5,children:[e.jsxs(S,{px:5,alignItems:"center",gap:4,justifyContent:"space-between",children:[e.jsxs(S,{flex:"1",alignItems:"center",gap:4,children:[e.jsx(tt,{size:"md",src:(r==null?void 0:r.avatar)||"",alt:"Coder Avatar",borderRadius:"full",boxSize:"50px",objectFit:"cover",loading:"lazy"}),e.jsx(Ee,{to:`/profile/${r==null?void 0:r.coderID}`,children:e.jsx(f,{maxW:"200px",_hover:{color:"blue"},fontWeight:"bold",children:((r==null?void 0:r.coderName)||"Ẩn danh").replace(/(.{3}).*(@.*)/,"$1******$2")})})]}),e.jsxs(S,{alignItems:"center",children:[e.jsx(Z,{as:rt,color:"red"}),e.jsx(f,{ms:1,fontWeight:"bold",fontSize:"lg",children:" 100 điểm"})]})]}),e.jsx(st,{my:4}),e.jsx(D,{sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:Ye(s==null?void 0:s.lessonContent)}})]})}const Ut=({onSelectLesson:s})=>{const{slugId:r}=qe(),h=r?r.split("-"):[],a=h.length>0?parseInt(h.pop(),10):NaN,[l,j]=m.useState(null),[x,b]=m.useState(!0),o=Ce(),p=ge(),w=ie(),[T,A]=m.useState({}),u=async()=>{if(isNaN(a)){o({title:"Lỗi",description:"ID không hợp lệ!",status:"error",duration:3e3,isClosable:!0}),p("/course");return}b(!0);try{const c=await J({controller:"Course",id:a});if(!(c!=null&&c.topics))throw new Error("Không có dữ liệu khóa học");const k=await Promise.all(c.topics.map(async C=>{try{const v=await J({controller:"Topic",id:C.topicID});return{...C,lessons:(v.lessons||[]).filter(I=>Number(I.status)===1)}}catch{return{...C,lessons:[]}}}));j({...c,topics:k});let g={};for(const C of k)(await ue.get(`/Progress/lesson-summary?topicId=${C.topicID}`)).data.forEach(I=>{g[I.lessonID]={completed:I.completedProblems,total:I.totalProblems}});A(g)}catch(c){o({title:"Lỗi",description:c.message||"Không thể tải dữ liệu. Vui lòng thử lại!",status:"error",duration:3e3,isClosable:!0}),j(null)}finally{b(!1)}};return m.useEffect(()=>{u()},[a,w.pathname]),e.jsx(D,{children:x?e.jsx(Wt,{noOfLines:5,spacing:4}):e.jsx(We,{spacing:0,children:Array.isArray(l==null?void 0:l.topics)&&l.topics.length>0?e.jsxs(nt,{allowToggle:!0,defaultIndex:[0],children:[" ",l.topics.map((c,k)=>e.jsx(Ne,{bg:"gray.100",borderRadius:"md",children:e.jsx(it,{border:"none",children:({isExpanded:g})=>{var C,v,I,N;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:e.jsxs(at,{_expanded:{bg:"gray.200"},borderRadius:"sm",children:[e.jsxs(D,{flex:"1",textAlign:"left",borderBottomWidth:2,borderStyle:"dashed",py:2,children:[e.jsxs(f,{fontSize:"lg",children:[e.jsxs(f,{as:"span",fontWeight:"bold",children:["Chủ đề ",k+1,":"]})," ",(c==null?void 0:c.topicName)||"Không có tên"]}),e.jsxs(S,{alignItems:"center",gap:10,fontSize:"sm",children:[e.jsxs(S,{alignItems:"center",gap:1,children:[e.jsx(ot,{color:"black"}),e.jsxs(f,{children:["Tổng số bài học: ",((C=c==null?void 0:c.lessons)==null?void 0:C.length)||0]})]}),e.jsxs(S,{alignItems:"center",gap:1,children:[e.jsx(lt,{color:"black"}),e.jsxs(f,{children:["Tiến độ: ",((v=c==null?void 0:c.lessons)==null?void 0:v.length)||0]})]})]})]}),g?e.jsx(Nt,{boxSize:4}):e.jsx(ct,{boxSize:4})]})}),e.jsx(dt,{pb:4,children:(I=c.lessons)!=null&&I.length?e.jsx(We,{spacing:2,children:(N=c.lessons)==null?void 0:N.map(O=>e.jsx(Ee,{to:`${w.pathname.replace(/\/\d+$/,"")}/${O.lessonID}`,style:({isActive:ae})=>({textDecoration:"none",color:ae?"blue.500":"inherit"}),onClick:()=>s==null?void 0:s(O.lessonID),children:e.jsx(Ne,{cursor:"pointer",_hover:{bg:"gray.300",transform:"scale(1.01)"},transition:"all .2s ease-in-out",pl:2,bg:"gray.50",borderRadius:"sm",p:2,children:e.jsxs(S,{alignItems:"center",justifyContent:"space-between",gap:2,fontSize:"md",children:[e.jsxs(f,{fontSize:"md",children:["📚 ",O.lessonTitle||"Không có tên bài học"," "]}),T[O.lessonID]?T[O.lessonID].completed===T[O.lessonID].total&&T[O.lessonID].total>0?e.jsx(Z,{as:Xe,fontSize:"lg",color:"green"}):e.jsxs(f,{as:"span",ml:2,color:"inherit",fontWeight:"bold",children:[T[O.lessonID].completed,"/",T[O.lessonID].total]}):"0/0"]})},O.lessonID||Math.random())}))}):e.jsx(f,{fontSize:"md",color:"gray.500",children:"Không có bài học nào."})})]})}},c==null?void 0:c.topicID)},(c==null?void 0:c.topicID)||k))]}):e.jsx(f,{fontSize:"md",color:"gray.500",children:"Không có chủ đề nào."})})})},Ae=[{Header:"STT"},{Header:"Tài khoản"},{Header:"Thời gian nộp"},{Header:"Ngôn ngữ"},{Header:"Kiểm thử"},{Header:"Điểm"},{Header:"Thời gian"}],Kt=()=>{const s=ie(),r=ge(),a=new URLSearchParams(s.search).get("problemID"),[l,j]=m.useState(!1),[x,b]=m.useState([]),[o,p]=m.useState({currentPage:1,pageSize:10,totalPages:0,totalCount:0}),w=m.useCallback(async()=>{if(a){j(!0);try{const u=await ue.get("/Submission/history",{params:{problemId:a,page:o.currentPage,pageSize:o.pageSize}}),{data:c,currentPage:k,pageSize:g,totalPages:C,totalCount:v}=u.data;b(c),p({currentPage:k,pageSize:g,totalPages:C,totalCount:v})}catch(u){console.error("Error fetching history",u)}finally{j(!1)}}},[a,o.currentPage,o.pageSize]);m.useEffect(()=>{w()},[w]);const T=u=>{p(c=>({...c,currentPage:u}))},A=u=>{p(c=>({...c,pageSize:u,currentPage:1}))};return e.jsxs(D,{p:4,children:[e.jsx(S,{justify:"flex-end",mb:3,children:e.jsx(X,{onClick:w,colorScheme:"blue",borderRadius:"md",size:"sm",children:"Refresh"})}),l?e.jsx(_e,{variant:"striped",maxH:"450px",overflowY:"auto",children:e.jsx(Fe,{children:Array.from({length:5}).map((u,c)=>e.jsx(ye,{children:Ae.map((k,g)=>e.jsx(U,{p:3,children:e.jsx(ut,{height:"20px"})},g))},`skeleton-${c}`))})}):e.jsxs(_e,{variant:"striped",colorScheme:"blue",children:[e.jsx(ht,{children:e.jsx(ye,{children:Ae.map((u,c)=>e.jsx(gt,{fontSize:"xs",textAlign:"center",maxW:"80px",p:2,children:u.Header},c))})}),e.jsx(Fe,{children:x.length===0?e.jsx(ye,{children:e.jsx(U,{colSpan:Ae.length,textAlign:"center",fontSize:"sm",children:"Chưa có bài làm nào"})}):x.map((u,c)=>e.jsxs(ye,{children:[e.jsx(U,{p:2,fontSize:"sm",textAlign:"center",children:(o.currentPage-1)*o.pageSize+c+1}),e.jsx(U,{p:2,fontSize:"sm",textAlign:"center",children:e.jsx(X,{onClick:()=>r(`/profile/${u.coderID}`),variant:"link",colorScheme:"black",fontSize:"sm",fontWeight:"normal",_hover:{color:"blue.500",textDecoration:"underline"},children:u.coderName})}),e.jsx(U,{p:2,fontSize:"sm",textAlign:"center",children:ft(u.submitTime)}),e.jsx(U,{p:2,fontSize:"sm",textAlign:"center",children:u.compilerName||"---"}),e.jsx(U,{p:2,fontSize:"sm",textAlign:"center",fontWeight:"bold",color:u.testResult==="Accepted"?"green.500":/fail|wrong|error/i.test(u.testResult)?"red.500":"yellow.500",children:u.testResult||"--/--"}),e.jsx(U,{p:2,fontSize:"sm",textAlign:"center",children:u.point}),e.jsx(U,{p:2,fontSize:"sm",textAlign:"center",children:u.maxTimeDuration!=null?`${u.maxTimeDuration} ms`:"--"})]},u.submissionID||c))})]}),e.jsx(mt,{currentPage:o.currentPage,totalPages:o.totalPages,pageSize:o.pageSize,totalRows:o.totalCount,onPageChange:T,onPageSizeChange:A})]})},Yt=({hasRun:s,id:r,errors:h,testCaseResult:a})=>{const[l,j]=m.useState([]),[x,b]=m.useState(null);return m.useEffect(()=>{r&&(async()=>{try{const p=await J({controller:"Problem",id:r}),w=await pt({controller:"TestCase",problemid:r});(w||p)&&(b(p.timeLimit||null),j(w.data||[]))}catch(p){console.error("Lỗi khi lấy dữ liệu test case:",p)}})()},[r]),e.jsxs(D,{maxH:"25vh",bg:"gray.900",color:"white",px:4,py:3,overflowY:"auto",children:[!s&&l.length===0&&e.jsx(f,{color:"gray.400",border:"1px solid",borderColor:"gray.600",px:3,py:2,borderRadius:"md",children:"Vui lòng chạy thử code để xem kết quả đầy đủ!"}),e.jsxs(Ve,{isLazy:!0,variant:"enclosed",colorScheme:"white",mt:3,children:[e.jsx(Qe,{children:l.length===0?e.jsx(se,{children:"Testcase 1"},0):l.map((o,p)=>e.jsxs(se,{children:["Testcase ",p+1]},p))}),e.jsx(Ze,{children:l.length===0?e.jsx(ne,{children:e.jsxs(He,{templateColumns:"2fr 1fr",bg:"gray.700",p:4,borderRadius:"md",fontSize:"14px",children:[e.jsxs(Se,{children:[e.jsxs(S,{justify:"start",children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Đầu vào:"}),e.jsx(f,{children:'""'})]}),e.jsxs(S,{justify:"start",children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Đầu ra thực tế:"}),e.jsx(f,{children:'""'})]}),e.jsxs(S,{justify:"start",children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Đầu ra mong đợi:"}),e.jsx(f,{children:'""'})]}),e.jsxs(S,{justify:"start",children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Giới hạn thời gian:"}),e.jsx(f,{children:'""'})]}),e.jsxs(S,{justify:"start",children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Thời gian thực thi:"}),e.jsx(f,{children:'""'})]})]}),e.jsxs(Se,{children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Hiển thị lỗi"}),e.jsx(f,{bg:"black",minH:"12vh",borderRadius:"md",p:2,children:h||"Không có lỗi"})]})]})},0):l.map((o,p)=>e.jsx(ne,{children:e.jsxs(He,{templateColumns:"2fr 1fr",bg:"gray.700",p:4,borderRadius:"md",fontSize:"14px",children:[e.jsxs(Se,{children:[e.jsxs(S,{justify:"start",children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Đầu vào:"}),e.jsx(f,{children:o.input||'" "'})]}),e.jsxs(S,{justify:"start",children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Đầu ra thực tế:"}),e.jsx(f,{children:a.actualOutput||'" "'})]}),e.jsxs(S,{justify:"start",children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Đầu ra mong đợi:"}),e.jsx(f,{children:o.output||'" "'})]}),e.jsxs(S,{justify:"start",children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Giới hạn thời gian:"}),e.jsxs(f,{children:[x||'" "'," ms"]})]}),e.jsxs(S,{justify:"start",children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Thời gian thực thi:"}),e.jsxs(f,{children:[a.execTime||'" "'," ms"]})]})]}),e.jsxs(Se,{children:[e.jsx(f,{fontWeight:"bold",mr:5,children:"Hiển thị lỗi"}),e.jsx(f,{bg:"black",minH:"12vh",borderRadius:"md",p:2,children:h||"Không có lỗi"})]})]})},p))})]})]})};function qt(){const s=ie(),{coder:r}=Ke(),{isOpen:h,onOpen:a,onClose:l}=xt(),[j,x]=m.useState({bg:"gray.100",colorScheme:"gray"}),[b,o]=m.useState({status:!1,type:""}),p=Ce(),w=ge(),[T,A]=m.useState([]),[u,c]=m.useState("cpp"),g=new URLSearchParams(s.search).get("problemID"),[C,v]=m.useState(`#include<iostream>
using namespace std;

int main() {
    cout << "Hello C++";
    return 0;
}`),[I,N]=m.useState("vs-dark"),[O,ae]=m.useState(null),[oe,Y]=m.useState({input:"",actualOutput:"",expectedOutput:"",timeLimit:"",execTime:""}),[le,ee]=m.useState(""),[fe,V]=m.useState(""),[q,me]=m.useState(!1),[te,pe]=m.useState(!1);m.useEffect(()=>{(async()=>{if(g!==null)try{const z=await J({controller:"Problem",id:g}),$=(await It({controller:"Compiler",page:1,pageSize:10})).data;if(A($),$.length>0){const re=$[0];c(re)}v(z.testCode||"")}catch(z){console.error("Lỗi khi lấy dữ liệu bài tập:",z)}})()},[g]);const ce=P=>{switch(P){case"Accepted":case"Success":ee("✅ Chạy thử thành công"),V("Chúc mừng! Bài làm đúng hoặc không có lỗi."),x({bg:"green.100",colorScheme:"green"}),me(!0);break;case"Wrong Answer":V("❌ Sai kết quả"),x({bg:"yellow.100",colorScheme:"yellow"});break;case"Runtime Error":ee("💥 Runtime Error"),V("Chương trình gặp lỗi khi thực thi."),x({bg:"red.100",colorScheme:"red"});break;case"Compilation Error":ee("🔧 Compilation Error"),V("Có lỗi biên dịch. Hãy kiểm tra lại cú pháp."),x({bg:"orange.100",colorScheme:"orange"});break;default:ee("⚠️ Không xác định"),V("Không thể xác định trạng thái kết quả."),x({bg:"gray.100",colorScheme:"gray"}),me(!1);break}},Ie=async()=>{o({status:!0,type:"test"});try{const z=(await ue.post("/CodeExecute/try-run",{sourceCode:C,compilerExtension:u.compilerExtension,problemId:parseInt(g)})).data;z.error?p({title:"Lỗi kết nối",status:"error",duration:2e3,isClosable:!0,variant:"left-accent",position:"top"}):(Y({input:z.input||"",actualOutput:z.output||"",expectedOutput:z.expectedOutput||"",timeLimit:z.timeLimit||"",execTime:z.timeDuration||""}),ae(z.error||""),ce(z.result)),a()}catch(P){console.error("Lỗi khi gửi yêu cầu chạy thử:",P),p({title:"Lỗi kết nối",status:"error",duration:2e3,isClosable:!0,variant:"left-accent",position:"top"})}finally{o({status:!1,type:""})}},xe=async()=>{var P,z,G,$,re;o({status:!0,type:"submit"});try{const i={problemId:g,compilerID:u.compilerID,submissionCode:C,coderID:r.coderID},t=await ue.post("/Submission/submit",i);t.status===200&&(ce(t.data.testRuns[0].result),a(),pe(!0))}catch(i){console.error("Lỗi khi gửi yêu cầu nộp bài:",i);const t=((G=(z=(P=i.response)==null?void 0:P.data)==null?void 0:z.errors)==null?void 0:G[0])||((re=($=i.response)==null?void 0:$.data)==null?void 0:re.message)||"Lỗi không xác định.";p({title:"Lỗi nộp bài",status:"warning",variant:"solid",description:t,duration:2e3,isClosable:!0,position:"top"})}finally{o({status:!1,type:""})}},Te=P=>{const z=Number(P.target.value),G=T.find($=>$.compilerID===z);G&&c(G)},be=()=>{if(!g)return;const P=parseInt(g)+1,z=new URLSearchParams(s.search);z.set("problemID",P),w(`${s.pathname}?${z.toString()}`),l()},ke=P=>{N(P.target.value)};return e.jsxs(bt,{h:"100%",spacing:0,align:"stretch",children:[e.jsx(D,{p:4,bg:"gray.900",color:"white",children:e.jsxs(S,{justifyContent:"space-between",alignItems:"center",children:[e.jsx(Be,{w:"20%",value:(u==null?void 0:u.compilerID)||"",onChange:Te,bg:"transparent",color:"white",sx:{option:{color:"white",bg:"gray.900"}},isDisabled:b.status,cursor:"pointer",children:T.map(P=>e.jsx("option",{value:P.compilerID,children:P.compilerName},P.compilerID))}),e.jsxs(S,{width:"70%",justify:"end",align:"center",gap:4,children:[e.jsxs(Be,{w:"20%",value:I,onChange:ke,bg:"transparent",color:"white",sx:{option:{color:"white",bg:"gray.900"}},isDisabled:b.status,cursor:"pointer",children:[e.jsx("option",{value:"vs-dark",children:"Tối"}),e.jsx("option",{value:"vs-light",children:"Sáng"})]}),e.jsx(X,{colorScheme:"blue",borderRadius:"md",onClick:Ie,isLoading:b.status&&b.type==="test",loadingText:"Đang chạy...",isDisabled:b.status||g===null,children:"Chạy thử"}),e.jsx(X,{leftIcon:e.jsx(jt,{}),color:q?"green":"gray.500",borderRadius:"md",onClick:xe,isLoading:b.status&&b.type==="submit",loadingText:"Đang chạy...",isDisabled:!q||b.status||g===null,children:"Nộp bài"})]})]})}),e.jsx(D,{h:"100%",overflow:"hidden",overflowY:"hidden",children:e.jsxs(S,{direction:"column",h:"100%",children:[e.jsx(D,{flex:"6",overflow:"hidden",borderBottom:"1px solid #555",children:e.jsx(vt,{height:"100%",language:u!=null&&u.compilerExtension?u.compilerExtension.replace(".",""):"plaintext",theme:I,value:C,onChange:P=>v(P||""),options:{fontSize:14,minimap:{enabled:!1},readOnly:b.status}})}),e.jsx(D,{flex:"3",overflow:"hidden",bg:"gray.900",children:e.jsx(Yt,{hasRun:!0,id:g,errors:O,testCaseResult:oe})})]})}),e.jsxs(yt,{isOpen:h,onClose:l,isCentered:!0,children:[e.jsx(St,{}),e.jsxs(zt,{bg:j.bg,children:[e.jsx(wt,{textAlign:"center",children:le||""}),e.jsx(Dt,{textAlign:"center",fontSize:"lg",children:fe||""}),e.jsx(Ct,{children:e.jsxs(S,{w:"100%",justify:"center",gap:2,children:[e.jsx(X,{colorScheme:j.colorScheme,onClick:l,children:"Đóng"}),te&&e.jsx(X,{colorScheme:"teal",onClick:be,children:"Bài tiếp theo"})]})})]})]})]})}const Xt=({problem:s,onBack:r})=>e.jsxs(D,{px:4,py:5,children:[e.jsx(X,{leftIcon:e.jsx(Ue,{}),color:"blue.500",size:"md",variant:"link",onClick:r,_hover:{transform:"translateX(-5px)",transition:"transform 0.3s ease"},mb:3,children:"Quay lại danh sách bài tập"}),e.jsx(D,{fontSize:"xl",fontWeight:"bold",mb:2,children:s==null?void 0:s.problemName}),e.jsx(D,{sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:Ye(s==null?void 0:s.problemContent)}})]}),Vt=({lessonID:s})=>{const[r,h]=m.useState(null),[a,l]=m.useState(null),j=Ce(),x=ie(),b=ge(),p=new URLSearchParams(x.search).get("problemID"),[w,T]=m.useState([]),A=m.useCallback(async()=>{try{const g=await J({controller:"Lesson",id:s});h(g.lessonProblems||[])}catch(g){console.error("Lỗi khi lấy dữ liệu bài học:",g),j({title:"Lỗi",description:"Không thể tải bài học.",status:"error",duration:3e3,position:"top-right",variant:"top-accent",isClosable:!0})}},[s,j]),u=m.useCallback(async()=>{if(!p){l(null);return}try{const g=await J({controller:"Problem",id:p});l(g)}catch(g){console.error("Lỗi khi lấy chi tiết bài tập:",g),j({title:"Lỗi",description:"Không thể tải chi tiết bài tập.",status:"error",duration:3e3,position:"top-right",variant:"top-accent",isClosable:!0})}},[p,j]),c=m.useCallback(async()=>{try{const C=(await ue.get(`/Progress/solved-problems?lessonId=${s}`)).data.map(v=>v.problemId);T(C)}catch(g){console.error("Lỗi khi lấy danh sách bài đã hoàn thành:",g)}},[s]);m.useEffect(()=>{isNaN(s)||(A(),c())},[s,A,c]),m.useEffect(()=>{u()},[u]);const k=()=>{b(x.pathname),u(),A(),c()};return e.jsx(D,{p:5,children:!p||!a?e.jsxs(D,{children:[e.jsx(D,{fontSize:"xl",fontWeight:"bold",mb:4,children:"Danh sách bài tập"}),e.jsx(D,{children:!r||r.length===0?e.jsx(D,{children:"Không có bài tập nào hết nha."}):r.map((g,C)=>{const v=w.includes(g.problemID);return e.jsx(Ee,{to:`${x.pathname}?problemID=${g.problemID}`,children:e.jsx(D,{p:2,borderBottom:"1px solid #eee",_hover:{bg:"gray.300",transform:"scale(1.01)"},transition:"all 0.2s",borderRadius:"md",cursor:"pointer",children:e.jsxs(S,{alignItems:"center",justifyContent:"space-between",children:[e.jsxs(S,{alignItems:"center",gap:2,children:[e.jsx(Tt,{}),e.jsxs(f,{children:[C+1,". ",g.problemName]})]}),e.jsx(Z,{as:v?Xe:kt,color:v?"green.500":"gray.400",fontSize:"xl"})]})})},g.problemID)})})]}):e.jsx(Xt,{problem:a,onBack:k})})};function tr(){const{lessonId:s}=qe(),r=Ce(),[h,a]=m.useState(null),[l,j]=m.useState(0),[x,b]=m.useState(!0),o=ie(),w=new URLSearchParams(o.search).get("problemID"),T=()=>{j(0)};return m.useEffect(()=>{const A=async()=>{try{const u=await J({controller:"Lesson",id:s});u&&u.lessonTitle&&u.lessonContent?a(u):(r({title:"Lỗi khi lấy dữ liệu bài học",status:"error",duration:2e3,isClosable:!0,position:"top-right"}),console.log("Không có dữ liệu bài học"))}catch{b(!1),r({title:"Lỗi khi lấy dữ liệu bài học",status:"error",duration:2e3,isClosable:!0,position:"top-right"})}finally{b(!1)}};isNaN(s)||A()},[s,r]),e.jsx(D,{h:"712px",w:"100%",display:"flex",flexDirection:"column",children:x?e.jsx(S,{justify:"center",align:"center",height:"100vh",children:e.jsx(Pt,{size:"xl",color:"blue.500"})}):h?e.jsxs(D,{flex:"1",display:"flex",flexDirection:"column",overflow:"hidden",children:[e.jsx($t,{lesson:h}),e.jsx(D,{flex:"1",overflow:"hidden",children:e.jsxs(Re,{className:"split-container",sizes:[45,55],minSize:0,gutterSize:5,style:{height:"100%"},children:[e.jsx(D,{bg:"white",h:"100%",overflow:"hidden",children:e.jsx(Ve,{orientation:"vertical",h:"100%",variant:"unstyled",index:l,onChange:A=>j(A),children:e.jsxs(S,{h:"100%",w:"100%",overflow:"hidden",children:[e.jsxs(Qe,{bgGradient:"linear(to-b,rgb(8, 84, 156),purple.800)",color:"white",display:"flex",flexDirection:"column",alignItems:"center",h:"100%",children:[e.jsx(ze,{label:"Mô tả",placement:"right",hasArrow:!0,children:e.jsx(se,{py:4,_selected:{bg:"blue.800"},children:e.jsx(Z,{as:Lt,boxSize:5})})}),e.jsx(ze,{label:"Giáo trình",placement:"right",hasArrow:!0,children:e.jsx(se,{py:4,_selected:{bg:"blue.800"},children:e.jsx(Z,{as:At,boxSize:5})})}),e.jsx(ze,{label:"Bài tập",placement:"right",hasArrow:!0,children:e.jsx(se,{py:4,_selected:{bg:"blue.800"},children:e.jsx(Z,{as:Et,boxSize:5})})}),w&&e.jsx(ze,{label:"Lịch sử",placement:"right",hasArrow:!0,children:e.jsx(se,{py:4,_selected:{bg:"blue.800"},children:e.jsx(Z,{as:Ot,boxSize:5})})})]}),e.jsxs(Ze,{flex:"1",h:"100%",overflow:"hidden",children:[e.jsx(ne,{p:0,h:"100%",overflowY:"auto",children:e.jsx(Gt,{lesson:h})}),e.jsxs(ne,{p:0,h:"100%",overflowY:"auto",children:[e.jsx(f,{fontWeight:"bold",fontSize:"lg",px:4,pt:2,children:"Giáo Trình"}),e.jsx(Ut,{onSelectLesson:T})]}),e.jsx(ne,{p:0,h:"100%",overflowY:"auto",children:e.jsx(Vt,{lessonID:s})}),w&&e.jsxs(ne,{p:0,h:"100%",overflowY:"auto",children:[e.jsx(f,{fontWeight:"bold",fontSize:"lg",px:4,pt:2,children:"Lịch sử"}),e.jsx(Kt,{})]})]})]})})}),e.jsx(D,{bg:"black",h:"100%",overflow:"auto",color:"white",children:e.jsx(qt,{})})]})})]}):e.jsx(S,{justify:"center",align:"center",height:"70vh",children:e.jsx(Rt,{src:Mt,alt:"Không có dữ liệu",h:"50%",objectFit:"fill",backgroundColor:"transparent"})})})}export{tr as default};
