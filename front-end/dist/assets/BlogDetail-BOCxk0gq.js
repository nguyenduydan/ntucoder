import{m as B,w as D,u as C,r as n,i as d,l as k,j as e,K as z,B as j,bA as N,x as s,s as i,Q as p,ab as T,ac as R,$ as f,D as l,aa as H,ay as K,z as L,a2 as v,L as W,a3 as $,a1 as A}from"./index-DZ5M9zvS.js";import{I as F}from"./InfoBlog-NUP5iAKJ.js";const M=()=>{const{slugId:g}=B(),r=D(),c=C(),h=g?g.split("-"):[],o=h.length>0?parseInt(h.pop(),10):NaN,[t,w]=n.useState(null),[m,S]=n.useState([]),[x,u]=n.useState(!0),b=n.useCallback(async()=>{if(isNaN(o)){c({title:"Lỗi",description:"ID không hợp lệ!",status:"error",duration:3e3,isClosable:!0}),r("/blog");return}u(!0);try{const a=await d.get(`/Blog/${o}`);w(a.data);const y=(await d.get("/Blog")).data.data.filter(I=>I.blogID!==o).slice(0,10);S(y),await d.post(`/Blog/${o}/view`)}catch(a){c({title:"Lỗi khi tải blog",description:a.message||"Không thể tải dữ liệu",status:"error",duration:3e3,isClosable:!0,variant:"top-accent",position:"top"})}finally{u(!1)}},[o,r,c]);return n.useEffect(()=>{b()},[b]),k((t==null?void 0:t.title)||""),e.jsxs(z,{maxW:"8xl",mx:"auto",minH:"85vh",mt:8,children:[e.jsx(j,{leftIcon:e.jsx(N,{}),mb:2,mt:3,colorScheme:"blue",variant:"ghost",onClick:()=>r(-1),children:"Trở về trước"}),e.jsxs(s,{maxW:"200vh",gap:8,px:4,mb:8,children:[e.jsxs(i,{flex:"2",bg:"white",p:6,borderRadius:"md",boxShadow:"md",children:[e.jsxs(s,{align:"center",mb:4,justify:"space-between",flexWrap:"wrap",gap:4,alignItems:"center",children:[e.jsx(p,{mb:4,children:(t==null?void 0:t.title)||"Tiêu đề bài viết"}),e.jsxs(T,{fontSize:"md",colorScheme:"blue",mb:4,children:[R((t==null?void 0:t.viewCount)||"0")," lượt xem"]})]}),x?e.jsx(s,{justify:"center",align:"center",height:"80vh",children:e.jsx(f,{})}):t?e.jsxs(e.Fragment,{children:[e.jsxs(s,{align:"center",mb:5,children:[e.jsx(H,{coderID:t.coderID||t.CoderID,size:"sm",mr:3}),e.jsxs(i,{children:[e.jsx(l,{fontWeight:"bold",fontSize:"lg",children:t.coderName||t.CoderName||t.author||"Người dùng"}),e.jsx(l,{fontSize:"sm",color:"gray.500",children:K(t.blogDate||t.BlogDate)})]})]}),e.jsx(s,{justify:"center",align:"center",children:e.jsx(L,{size:"md",name:t.title||t.Title||"Không có ảnh",src:t.imageBlogUrl||"./avatarSimmmple.png",w:"70%",maxH:"50vh",objectFit:"cover",alt:t.title||t.Title||"Không có ảnh",borderRadius:"md",loading:"lazy",mb:4,fallbackSrc:"./avatarSimmmple.png"})}),e.jsx(i,{px:5,sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:v(t.content)}})]}):e.jsx(l,{children:"Không tìm thấy bài viết"})]}),e.jsxs(i,{flex:"0.8",bg:"gray.50",p:6,borderRadius:"md",boxShadow:"sm",maxHeight:"80vh",display:"flex",flexDirection:"column",children:[e.jsxs(s,{align:"center",justify:"space-between",mb:4,py:2,children:[e.jsx(p,{size:"md",children:"Bài viết khác"}),e.jsx(j,{colorScheme:"blue",variant:"link",size:"sm",onClick:()=>r("/blogs"),children:"Xem tất cả"})]}),e.jsx(i,{overflowY:"auto",children:e.jsx(W,{spacing:4,children:x?e.jsx(s,{justify:"center",align:"center",height:"80vh",children:e.jsx(f,{})}):m.length===0?e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Không có bài viết khác"}):m.map(a=>e.jsxs(i,{p:3,borderRadius:"md",bg:"white",boxShadow:"sm",cursor:"pointer",_hover:{bg:"blue.50"},onClick:()=>r(`/blogs/${A(a.title)}-${a.blogID}`),children:[e.jsx(l,{fontWeight:"bold",mb:1,children:a.title}),e.jsxs(l,{fontSize:"sm",color:"gray.600",children:[v(a.content).replace(/<[^>]*>/g,"").slice(0,100),"..."]}),e.jsx(F,{id:a.coderID||a.CoderID,coderName:a.coderName,date:a.blogDate,view:$(a.viewCount||a.ViewCount)})]},a.blogID))})})]})]})]})};export{M as default};
