import{U as z,r,j as e,F as p,o as I,B as y,a5 as T,k as A,N as B,p as G,cf as H,f as c,D as S,ay as M,a0 as C,a1 as d,a2 as h,al as q,b as L,a6 as O,i as k}from"./react-vendor-jMCSND2O.js";import{B as P,o as V,D as W}from"./index-b-BR7AAp.js";import"./charts-vendor-DwxpLNbD.js";import"./vendor-BYm5b_XE.js";import"./lodash-vendor-CBiJWk4A.js";const Y=({coderID:o,onClose:g,onUpdated:u})=>{var b;const l=z(),f=r.useRef(null),[a,m]=r.useState({}),[D,j]=r.useState(!0),[F,v]=r.useState(!1),[E,x]=r.useState(!1);r.useEffect(()=>{o&&(async()=>{j(!0);try{const s=await V({controller:"Coder",id:o});s&&m(s)}catch{l({title:"Lỗi khi tải dữ liệu.",status:"error",duration:2e3,variant:"top-accent",position:"top"})}finally{j(!1)}})()},[o]);const n=(t,s)=>{m(i=>({...i,[t]:s}))},N=async()=>{if(!a.coderName||!a.coderEmail){l({title:"Vui lòng điền đầy đủ thông tin.",status:"warning",duration:2e3,variant:"top-accent",position:"top"});return}v(!0);try{await W({controller:"Coder",id:o,data:a}),l({title:"Cập nhật thành công!",status:"success",duration:2e3,variant:"top-accent",position:"top"}),u==null||u(),g()}catch{l({title:"Lỗi khi cập nhật.",status:"error",duration:2e3,variant:"top-accent",position:"top"})}finally{v(!1)}},w=t=>{const s=t.target.files[0];if(s){const i=new FileReader;i.onloadend=()=>{m(R=>({...R,avatar:i.result,avatarFile:s})),x(!1)},i.readAsDataURL(s)}};return D?e.jsx(p,{minH:"40vh",justify:"center",alignItems:"center",children:e.jsx(I,{size:"xl"})}):e.jsxs(y,{px:6,children:[e.jsxs(p,{direction:"column",align:"center",p:5,bgGradient:"linear(to-r, purple.400, brand.200)",children:[e.jsx(T,{isLoaded:E,borderRadius:"md",size:"2xl",mb:4,children:e.jsxs(y,{position:"relative",cursor:"pointer",children:[e.jsx(A,{label:"Thay đổi avatar",hasArrow:!0,children:e.jsx(B,{src:P(a.avatar||"/avatarSimmmple.png"),alt:"Avatar",borderRadius:"full",boxSize:"150px",objectFit:"cover",onClick:()=>f.current.click(),onLoad:()=>x(!0),onError:()=>x(!0)})}),e.jsx(G,{as:H,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"white",fontSize:"2xl",pointerEvents:"none"})]})}),e.jsx(c,{ref:f,type:"file",display:"none",onChange:w})]}),e.jsx(S,{my:4}),e.jsxs(M,{columns:{base:1,md:2},spacing:5,children:[e.jsxs(C,{children:[e.jsxs(d,{mb:4,children:[e.jsx(h,{children:"Họ và tên"}),e.jsx(c,{value:a.coderName||"",onChange:t=>n("coderName",t.target.value)})]}),e.jsxs(d,{mb:4,children:[e.jsx(h,{children:"Email"}),e.jsx(c,{value:a.coderEmail||"",onChange:t=>n("coderEmail",t.target.value)})]})]}),e.jsxs(C,{children:[e.jsxs(d,{mb:4,children:[e.jsx(h,{children:"Số điện thoại"}),e.jsx(c,{value:a.phoneNumber||"",onChange:t=>n("phoneNumber",t.target.value)})]}),e.jsxs(d,{mb:4,children:[e.jsx(h,{children:"Ngày sinh"}),e.jsx(q,{selected:a.birthDay?new Date(a.birthDay):null,onChange:t=>n("birthDay",t?t.toISOString():""),dateFormat:"dd/MM/yyyy",className:"chakra-input css-bq6bms"})]})]})]}),e.jsx(S,{my:4}),e.jsx(L,{fontWeight:"bold",mb:2,align:"center",children:"Giới thiệu"}),e.jsx(O,{value:a.description||"",onChange:t=>n("description",t.target.value),maxLength:200,h:"130px",resize:"none"}),e.jsxs(L,{fontSize:"sm",color:"gray.500",textAlign:"right",children:[((b=a.description)==null?void 0:b.length)||0," / 200 ký tự"]}),e.jsxs(p,{justify:"flex-end",mt:6,mb:5,children:[e.jsx(k,{variant:"ghost",colorScheme:"red",mr:3,onClick:g,children:"Hủy"}),e.jsx(k,{colorScheme:"blue",isLoading:F,loadingText:"Đang lưu...",onClick:N,children:"Lưu"})]})]})};export{Y as default};
