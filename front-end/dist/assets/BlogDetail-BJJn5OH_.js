import{aj as B,aa as C,U as D,r as n,j as e,C as k,i as b,bp as N,F as a,B as i,H as j,ae as z,o as f,b as r,N as T,aN as R}from"./react-vendor-B0lTxKSL.js";import{a as d,u as H,S as F,j as K,i as L,m as W,s as v,f as $,t as A}from"./index-CfmnNlTN.js";import{I as E}from"./InfoBlog-DC1ndQBO.js";import"./charts-vendor-DwxpLNbD.js";import"./vendor-C1WdaeOg.js";import"./lodash-vendor-CBiJWk4A.js";import"./axios-vendor-xsH4HHeE.js";import"./moment-vendor-CTDujYFw.js";const J=()=>{const{slugId:g}=B(),o=C(),c=D(),h=g?g.split("-"):[],l=h.length>0?parseInt(h.pop(),10):NaN,[t,S]=n.useState(null),[m,w]=n.useState([]),[x,u]=n.useState(!0),p=n.useCallback(async()=>{if(isNaN(l)){c({title:"Lỗi",description:"ID không hợp lệ!",status:"error",duration:3e3,isClosable:!0}),o("/blog");return}u(!0);try{const s=await d.get(`/Blog/${l}`);S(s.data);const I=(await d.get("/Blog")).data.data.filter(y=>y.blogID!==l).slice(0,10);w(I),await d.post(`/Blog/${l}/view`)}catch(s){c({title:"Lỗi khi tải blog",description:s.message||"Không thể tải dữ liệu",status:"error",duration:3e3,isClosable:!0,variant:"top-accent",position:"top"})}finally{u(!1)}},[l,o,c]);return n.useEffect(()=>{p()},[p]),H((t==null?void 0:t.title)||""),e.jsx(F,{children:e.jsxs(k,{maxW:"8xl",mx:"auto",minH:"85vh",mt:8,children:[e.jsx(b,{leftIcon:e.jsx(N,{}),mb:2,mt:3,colorScheme:"blue",variant:"ghost",onClick:()=>o(-1),children:"Trở về trước"}),e.jsxs(a,{maxW:"200vh",gap:8,px:4,mb:8,children:[e.jsxs(i,{flex:"2",bg:"white",p:6,borderRadius:"md",boxShadow:"md",children:[e.jsxs(a,{align:"center",mb:4,justify:"space-between",flexWrap:"wrap",gap:4,alignItems:"center",children:[e.jsx(j,{mb:4,children:(t==null?void 0:t.title)||"Tiêu đề bài viết"}),e.jsxs(z,{fontSize:"md",colorScheme:"blue",mb:4,children:[K((t==null?void 0:t.viewCount)||"0")," lượt xem"]})]}),x?e.jsx(a,{justify:"center",align:"center",height:"80vh",children:e.jsx(f,{})}):t?e.jsxs(e.Fragment,{children:[e.jsxs(a,{align:"center",mb:5,children:[e.jsx(L,{coderID:t.coderID||t.CoderID,size:"sm",mr:3}),e.jsxs(i,{children:[e.jsx(r,{fontWeight:"bold",fontSize:"lg",children:t.coderName||t.CoderName||t.author||"Người dùng"}),e.jsx(r,{fontSize:"sm",color:"gray.500",children:W(t.blogDate||t.BlogDate)})]})]}),e.jsx(a,{justify:"center",align:"center",children:e.jsx(T,{size:"md",name:t.title||t.Title||"Không có ảnh",src:t.imageBlogUrl||"./avatarSimmmple.png",w:"70%",maxH:"50vh",objectFit:"cover",alt:t.title||t.Title||"Không có ảnh",borderRadius:"md",loading:"lazy",mb:4,fallbackSrc:"./avatarSimmmple.png"})}),e.jsx(i,{px:5,sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:v(t.content)}})]}):e.jsx(r,{children:"Không tìm thấy bài viết"})]}),e.jsxs(i,{flex:"0.8",bg:"gray.50",p:6,borderRadius:"md",boxShadow:"sm",maxHeight:"80vh",display:"flex",flexDirection:"column",children:[e.jsxs(a,{align:"center",justify:"space-between",mb:4,py:2,children:[e.jsx(j,{size:"md",children:"Bài viết khác"}),e.jsx(b,{colorScheme:"blue",variant:"link",size:"sm",onClick:()=>o("/blogs"),children:"Xem tất cả"})]}),e.jsx(i,{overflowY:"auto",children:e.jsx(R,{spacing:4,children:x?e.jsx(a,{justify:"center",align:"center",height:"80vh",children:e.jsx(f,{})}):m.length===0?e.jsx(r,{fontSize:"sm",color:"gray.600",children:"Không có bài viết khác"}):m.map(s=>e.jsxs(i,{p:3,borderRadius:"md",bg:"white",boxShadow:"sm",cursor:"pointer",_hover:{bg:"blue.50"},onClick:()=>o(`/blogs/${A(s.title)}-${s.blogID}`),children:[e.jsx(r,{fontWeight:"bold",mb:1,children:s.title}),e.jsxs(r,{fontSize:"sm",color:"gray.600",children:[v(s.content).replace(/<[^>]*>/g,"").slice(0,100),"..."]}),e.jsx(E,{id:s.coderID||s.CoderID,coderName:s.coderName,date:s.blogDate,view:$(s.viewCount||s.ViewCount)})]},s.blogID))})})]})]})]})})};export{J as default};
