import{m as B,w as D,u as C,r as n,i as d,l as k,j as e,S as z,K as N,B as j,bA as T,x as a,s as i,Q as p,ac as R,ad as H,$ as f,D as l,ab as K,az as L,z as W,a2 as v,L as $,a3 as A,a1 as F}from"./index-NsYg9CFQ.js";import{I as E}from"./InfoBlog-CD9UQmFr.js";const P=()=>{const{slugId:g}=B(),r=D(),c=C(),h=g?g.split("-"):[],o=h.length>0?parseInt(h.pop(),10):NaN,[t,w]=n.useState(null),[m,S]=n.useState([]),[x,u]=n.useState(!0),b=n.useCallback(async()=>{if(isNaN(o)){c({title:"Lỗi",description:"ID không hợp lệ!",status:"error",duration:3e3,isClosable:!0}),r("/blog");return}u(!0);try{const s=await d.get(`/Blog/${o}`);w(s.data);const I=(await d.get("/Blog")).data.data.filter(y=>y.blogID!==o).slice(0,10);S(I),await d.post(`/Blog/${o}/view`)}catch(s){c({title:"Lỗi khi tải blog",description:s.message||"Không thể tải dữ liệu",status:"error",duration:3e3,isClosable:!0,variant:"top-accent",position:"top"})}finally{u(!1)}},[o,r,c]);return n.useEffect(()=>{b()},[b]),k((t==null?void 0:t.title)||""),e.jsx(z,{children:e.jsxs(N,{maxW:"8xl",mx:"auto",minH:"85vh",mt:8,children:[e.jsx(j,{leftIcon:e.jsx(T,{}),mb:2,mt:3,colorScheme:"blue",variant:"ghost",onClick:()=>r(-1),children:"Trở về trước"}),e.jsxs(a,{maxW:"200vh",gap:8,px:4,mb:8,children:[e.jsxs(i,{flex:"2",bg:"white",p:6,borderRadius:"md",boxShadow:"md",children:[e.jsxs(a,{align:"center",mb:4,justify:"space-between",flexWrap:"wrap",gap:4,alignItems:"center",children:[e.jsx(p,{mb:4,children:(t==null?void 0:t.title)||"Tiêu đề bài viết"}),e.jsxs(R,{fontSize:"md",colorScheme:"blue",mb:4,children:[H((t==null?void 0:t.viewCount)||"0")," lượt xem"]})]}),x?e.jsx(a,{justify:"center",align:"center",height:"80vh",children:e.jsx(f,{})}):t?e.jsxs(e.Fragment,{children:[e.jsxs(a,{align:"center",mb:5,children:[e.jsx(K,{coderID:t.coderID||t.CoderID,size:"sm",mr:3}),e.jsxs(i,{children:[e.jsx(l,{fontWeight:"bold",fontSize:"lg",children:t.coderName||t.CoderName||t.author||"Người dùng"}),e.jsx(l,{fontSize:"sm",color:"gray.500",children:L(t.blogDate||t.BlogDate)})]})]}),e.jsx(a,{justify:"center",align:"center",children:e.jsx(W,{size:"md",name:t.title||t.Title||"Không có ảnh",src:t.imageBlogUrl||"./avatarSimmmple.png",w:"70%",maxH:"50vh",objectFit:"cover",alt:t.title||t.Title||"Không có ảnh",borderRadius:"md",loading:"lazy",mb:4,fallbackSrc:"./avatarSimmmple.png"})}),e.jsx(i,{px:5,sx:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:v(t.content)}})]}):e.jsx(l,{children:"Không tìm thấy bài viết"})]}),e.jsxs(i,{flex:"0.8",bg:"gray.50",p:6,borderRadius:"md",boxShadow:"sm",maxHeight:"80vh",display:"flex",flexDirection:"column",children:[e.jsxs(a,{align:"center",justify:"space-between",mb:4,py:2,children:[e.jsx(p,{size:"md",children:"Bài viết khác"}),e.jsx(j,{colorScheme:"blue",variant:"link",size:"sm",onClick:()=>r("/blogs"),children:"Xem tất cả"})]}),e.jsx(i,{overflowY:"auto",children:e.jsx($,{spacing:4,children:x?e.jsx(a,{justify:"center",align:"center",height:"80vh",children:e.jsx(f,{})}):m.length===0?e.jsx(l,{fontSize:"sm",color:"gray.600",children:"Không có bài viết khác"}):m.map(s=>e.jsxs(i,{p:3,borderRadius:"md",bg:"white",boxShadow:"sm",cursor:"pointer",_hover:{bg:"blue.50"},onClick:()=>r(`/blogs/${F(s.title)}-${s.blogID}`),children:[e.jsx(l,{fontWeight:"bold",mb:1,children:s.title}),e.jsxs(l,{fontSize:"sm",color:"gray.600",children:[v(s.content).replace(/<[^>]*>/g,"").slice(0,100),"..."]}),e.jsx(E,{id:s.coderID||s.CoderID,coderName:s.coderName,date:s.blogDate,view:A(s.viewCount||s.ViewCount)})]},s.blogID))})})]})]})]})})};export{P as default};
